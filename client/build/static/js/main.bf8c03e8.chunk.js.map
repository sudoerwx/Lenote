{"version":3,"sources":["registerServiceWorker.js","actions/editor.js","actions/user.js","reducers/user.js","actions/shareLink.js","reducers/index.js","reducers/editor.js","reducers/renderMarkdown.js","actions/renderMarkdown.js","reducers/shareLink.js","icons/arrow-down.svg","icons/burger.svg","icons/toolbar/title.svg","icons/toolbar/bold.svg","icons/toolbar/italic.svg","icons/toolbar/quote.svg","icons/toolbar/code.svg","icons/toolbar/table.svg","icons/toolbar/link.svg","icons/toolbar/img.svg","icons/toolbar/divider.svg","icons/toolbar/ul.svg","icons/toolbar/ol.svg","components/Toolbar/ButtonList.js","components/Toolbar/DialogStyle.js","components/Toolbar/Buttons.js","components/common/Avatar.js","components/common/Menu.js","components/common/Modal.js","components/common/TextInput.js","config/constants.js","components/Toolbar/ShareLinkModal.js","components/hooks/useMatchMobile.js","components/Toolbar/Toolbar.js","components/FileList/CreateFileModal.js","icons/delete.svg","components/FileList/FileList.js","components/Sidebar/Sidebar.js","vendor/Markdown.Converter.js","vendor/Markdown.Editor.js","vendor/modifiedGfm.js","components/Editor/Editor.js","icons/visibility-on.svg","icons/visibility-off.svg","components/Paper/Paper.js","components/App/App.js","components/RootRouter/RootRouter.js","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","catch","error","receiveUserData","data","type","logoutSuccess","createFileSuccess","name","nameHash","deleteFileSuccess","initialState","ownFiles","secondFiles","receiveShareLink","combineReducers","editor","arguments","length","undefined","codeMirror","action","renderMarkdown","user","Object","objectSpread","currentFile","concat","toConsumableArray","filter","_ref","shareLink","_extends","assign","target","i","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","arrow_down_ref2","react_default","a","createElement","d","fill","arrow_down_ref3","arrow_down_SvgArrowDown","svgRef","props","width","height","viewBox","ref","ForwardRef","forwardRef","__webpack_require__","p","burger_extends","burger_objectWithoutProperties","burger_objectWithoutPropertiesLoose","burger_ref2","burger_ref3","burger_SvgBurger","burger_ForwardRef","title_extends","title_objectWithoutProperties","title_objectWithoutPropertiesLoose","title_ref2","title_SvgTitle","title_ForwardRef","bold_extends","bold_objectWithoutProperties","bold_objectWithoutPropertiesLoose","bold_ref2","bold_SvgBold","bold_ForwardRef","italic_extends","italic_objectWithoutProperties","italic_objectWithoutPropertiesLoose","italic_ref2","italic_SvgItalic","italic_ForwardRef","quote_extends","quote_objectWithoutProperties","quote_objectWithoutPropertiesLoose","quote_ref2","quote_SvgQuote","quote_ForwardRef","code_extends","code_objectWithoutProperties","code_objectWithoutPropertiesLoose","code_ref2","code_SvgCode","code_ForwardRef","table_extends","table_objectWithoutProperties","table_objectWithoutPropertiesLoose","table_ref2","table_SvgTable","table_ForwardRef","link_extends","link_objectWithoutProperties","link_objectWithoutPropertiesLoose","link_ref2","link_SvgLink","link_ForwardRef","img_extends","img_objectWithoutProperties","img_objectWithoutPropertiesLoose","img_ref2","img_SvgImg","img_ForwardRef","divider_extends","divider_objectWithoutProperties","divider_objectWithoutPropertiesLoose","divider_ref2","divider_ref3","divider_ref4","divider_ref5","divider_SvgDivider","divider_ForwardRef","ul_extends","ul_objectWithoutProperties","ul_objectWithoutPropertiesLoose","ul_ref2","ul_SvgUl","ul_ForwardRef","ol_extends","ol_objectWithoutProperties","ol_objectWithoutPropertiesLoose","ol_ref2","ol_SvgOl","ol_ForwardRef","ButtonList","Icon","TitleIcon","title","method","BoldIcon","ItalicIcon","QuoteIcon","CodeIcon","TableIcon","LinkIcon","ImgIcon","DividerIcon","UlIcon","OlIcon","createGlobalStyle","_templateObject","StyledButtons","styled","div","Buttons_templateObject","connect","_ref3","dark","Fragment","map","_ref2","index","onClick","doClick","DialogStyle","img","Avatar_templateObject","Container","Menu_templateObject","OptionsWrapper","_templateObject2","visible","OpenMenu","Menu","children","_ref$ContainerTag","ContainerTag","_ref$OptionsContainer","OptionsContainer","_ref$onChange","onChange","_ref$onOpen","onOpen","clickAwayRef","useRef","createRef","_useState","useState","_useState2","slicedToArray","isMenuOpen","setMenuOpen","open","find","child","options","hideOnClickAway","event","useEffect","addEventListener","removeEventListener","e","stopPropagation","React","Children","option","cloneElement","value","ModalWrapper","Modal_templateObject","css","Modal_templateObject2","ModalContent","_templateObject3","Modal","onClose","createPortal","document","body","useModal","toggleVisibility","Input","input","TextInput_templateObject","invalid","TextInput_templateObject2","ErrorMessage","TextInput_templateObject3","TextInput","rest","objectWithoutProperties","baseApiUrl","Title","h2","ShareLinkModal_templateObject","LinkInput","ShareLinkModal_templateObject2","mapDispatchToProps","getShareLink","asyncToGenerator","regenerator_default","mark","_callee","dispatch","wrap","_context","prev","next","fetch","sent","t0","t1","json","t2","t3","t4","dir","stop","_x","withRouter","params","common_Modal","placeholder","link","useMatchMobile","_useContext","useContext","IsMobileContext","_useContext2","isMobile","setMobile","handleResize","matches","matchMedia","Button","Toolbar_templateObject","StyledToolbar","Toolbar_templateObject2","BottomToolbar","Toolbar_templateObject3","Wrapper","_templateObject4","Group","_templateObject5","BurgerButton","BurgerIcon","_templateObject6","LoginButton","_templateObject7","UserName","_templateObject8","Avatar","MenuButtonsContainer","_templateObject9","MenuButton","_templateObject10","logout","history","_callee2","_context2","push","_x2","toggleMobileSidebar","_useModal","_useModal2","shareLinkVisible","hideShareLink","showShareLink","download","useCallback","filename","text","getValue","setAttribute","encodeURIComponent","style","display","appendChild","click","removeChild","file","prevState","common_Menu","Toolbar_Buttons","secondName","photoURI","src","href","Toolbar_ShareLinkModal","CreateFileModal_templateObject","ButtonsContainer","CreateFileModal_templateObject2","CreateFileModal_templateObject3","disabled","CreateFileModal_templateObject4","CreateFileModal","submit","fileName","setFileName","_useState3","_useState4","touched","setTouched","handleNameChange","newFileName","CreateFileModal_Title","common_TextInput","CreateFileModal_Button","delete_extends","delete_objectWithoutProperties","delete_objectWithoutPropertiesLoose","delete_ref2","delete_ref3","delete_SvgDelete","delete_ForwardRef","Item","FileList_templateObject","hl","NewFileButton","FileList_templateObject2","Text","FileList_templateObject3","createFile","_callee3","_context3","_x3","deleteFile","_ref4","_callee4","_context4","abrupt","warn","_x4","_ref10","createFileVisible","hideCreateFile","showCreateFile","_ref5","_ref6","_ref7","_ref8","FileList_CreateFileModal","some","_ref9","Markdown","StyledSidebar","Sidebar_templateObject","mobileSidebarOpen","Number","components_FileList_FileList","exports","identity","x","returnFalse","HookCollection","SaveHash","chain","hookname","func","original","Error","args","Array","slice","set","addNoop","addFalse","get","Converter","setOptions","optionsParam","g_urls","g_titles","g_html_blocks","g_list_level","pluginHooks","hooks","_HashHTMLBlocks","replace","hashElement","wholeMatch","m1","blockText","makeHtml","_Detab","preConversion","charCodeToReplace","parseInt","String","fromCharCode","_UnescapeSpecialChars","_RunBlockGamut","m2","m3","m4","m5","toLowerCase","_EncodeAmpsAndAngles","_StripLinkDefinitions","postNormalization","postConversion","blockGamutHookCallback","t","doNotUnhash","bq","pre","_DoBlockQuotes","codeblock","nextChar","_EncodeCode","_Outdent","_DoCodeBlocks","_DoLists","_RunSpanGamut","matchFound","h_level","_DoHeaders","preBlockGamut","grafs","split","grafsOut","markerRe","end","str","test","foundAny","id","join","_FormParagraphs","postBlockGamut","autoLinkRegex","handleTrailingParens","wholematch","plainLinkText","_DoAutoLinks","writeAnchorTag","_DoAnchors","writeImageTag","_DoImages","escapeCharacters_callback","_EncodeBackslashEscapes","tag","escapeCharacters","charAt","_EscapeSpecialCharsWithinTagAttributes","c","_DoCodeSpans","preSpanGamut","_DoItalicsAndBold","postSpanGamut","m6","m7","whole_match","link_text","link_id","url","search","result","_problemUrlChars","offset","charCodeAt","toString","encodeProblemUrlChars","attributeEncode","alt_text","isInsideParagraphlessListItem","whole_list","list","list_type","_ProcessListItems","runup","_listItemMarkers","ol","ul","list_str","marker","re","RegExp","last_item_had_a_double_newline","item","ends_with_double_newline","endCharRegex","lookbehind","protocol","parens","level","tail","trailingParens","lastChar","substr","v","spaces","skew","charsToEscape","afterBackslash","regexString","regex","util","position","ui","doc","nav","SETTINGS","uaSniffed","isIE","userAgent","isIE_5or6","isOpera","isMac","platform","defaultsStrings","bold","boldexample","italic","italicexample","linkdescription","linkdialog","quote","quoteexample","code","codeexample","image","imagedescription","imagedialog","olist","ulist","litem","heading","headingexample","hr","table","undo","redo","help","keyStrokes","win","mac","Chunks","PanelCollection","postfix","cm","buttonBar","getElementById","preview","TextareaState","panels","isInitialState","stateObj","inputArea","init","before","getRange","CodeMirror","Pos","getCursor","selection","getSelection","after","posFromIndex","MAX_VALUE","setInputAreaSelectionStartEnd","scrollTop","setInputAreaSelection","setSelection","start","scroll","focus","restore","startIndex","startIndexMax","endIndex","endIndexMax","beforeMaxOffset","afterMaxOffset","replaceRange","substring","getChunks","chunk","startTag","endTag","setChunks","PreviewManager","converter","previewRefreshCallback","previewWrapper","timeout","elapsedTime","oldInputText","getDocScrollTop","innerHeight","pageYOffset","documentElement","makePreviewHtml","prevTime","Date","getTime","currTime","pushPreviewHtml","applyTimeout","clearTimeout","delay","setTimeout","refresh","requiresRefresh","processingTime","previewSetter","isFirstTimeFilled","ieSafePreviewSet","parent","parentNode","sibling","nextSibling","innerHTML","insertBefore","nonSuckyBrowserPreviewSet","emptyTop","getTop","previewSet","panel","scrollHeight","clientHeight","setPanelScrollTops","fullTop","scrollBy","on","UIManager","undoManager","previewManager","commandManager","helpOptions","getString","getKey","getStringAndKey","identifier","inputBox","buttons","setUndoRedoButtonStates","setupButton","done","undone","that","buttonRow","className","xPosition","makeButton","XShift","textOp","button","left","buttonImage","makeSpacer","num","spacer","bindCommand","postProcessing","doLinkOrImage","doList","execute","manager","helpButton","helpButtonImage","isHelp","right","onclick","handler","makeSpritedButtonRow","linkOrImage","setCommandMode","chunks","fixupInputArea","isEnabled","getElementsByTagName","backgroundPosition","onmouseover","onmouseout","onmousedown","activeElement","ieCachedRange","createRange","ieCachedScrollTop","identifierList","eKeys","addKeyMap","addKeyCmd","setButtonState","CommandManager","Editor","markdownConverter","idPostfix","strings","getConverter","run","uiManager","onPreviewRefresh","refreshPreview","findTags","startRegex","endRegex","chunkObj","extendRegExp","trimWhitespace","remove","beforeReplacer","afterReplacer","s","skipLines","nLinesBefore","nLinesAfter","findExtraNewlines","regexText","replacementText","$1","isVisible","elem","getComputedStyle","getPropertyValue","currentStyle","addEvent","listener","attachEvent","removeEvent","detachEvent","fixEolChars","post","flags","pattern","flagsPart","isInner","offsetTop","offsetParent","getHeight","offsetHeight","getWidth","offsetWidth","scrollWidth","getPageSize","innerWidth","scrollMaxY","clientWidth","Math","max","createBackground","background","top","zIndex","opacity","pageSize","scrollLeft","prompt","defaultInputText","callback","fileChangeCallback","fileType","dialog","fileInput","fileInputLabel","checkEscape","charCode","keyCode","close","isCancel","padding","maxWidth","question","form","onsubmit","margin","cssFloat","textAlign","marginLeft","marginRight","accept","files","htmlFor","innerText","okButton","cancelButton","createDialog","commandProto","prefixes","unwrap","txt","len","line","marked","doBold","doBorI","doItalic","nStars","insertText","starsBefore","exec","starsAfter","prevStars","min","whitespace","markup","stripLinkDefs","defsToAdd","totalMatch","newlines","addLinkDef","linkDef","refNumber","defs","addDefNumber","def","getLink","inner","afterInner","refOut","isImage","linkEnteredCallback","querypart","decodeURIComponent","encodeURI","trim","insertImageDialog","textInput","formData","FormData","append","mode","r","slug","insertLinkDialog","doAutoindent","fakeSelection","doBlockquote","doCode","newlinesBefore","newlinesAfter","blankLine","leftOver","lines","inChain","good","replaceBlanksInTags","useBracket","replacement","markdown","postBlockquoteCreation","blanks","hasTextBefore","nLinesBack","nLinesForward","isNumberedList","nextItemsRegex","bullet","getItemPrefix","prefix","getPrefixedItem","itemText","_","hasDigits","nLinesUp","nLinesDown","doHeading","headerLevel","lastMatch","headerLevelToCreate","headerChar","doHorizontalRule","doTable","urlRE","defineMode","config","modeConfig","codeDepth","gfmOverlay","startState","codeBlock","ateSpace","copyState","token","stream","combineTokens","skipToEnd","sol","peek","pos","eatWhile","difference","eatSpace","gitHubSpice","string","markdownConfig","taskLists","strikethrough","emoji","attr","overlayMode","getMode","defineMIME","FakeButtonsElement","Editor_templateObject","UserList","Editor_templateObject2","setCmInstance","editorRef","userListRef","useLayoutEffect","pagedownConverter","PagedownConverter","pagedownEditor","PagedownEditor","fromTextArea","current","highlightFormatting","maxBlockquoteDepth","fencedCodeBlockHighlighting","shared","lineWrapping","setValue","toTextArea","stopWatch","ShareDB","types","otText","sharews","WebSocket","sharedoc","Connection","ed","chg","stindex","indexFromPos","from","delta","removed","addedText","submitOp","err","stPos","edPos","hdPos","edindex","prefixed","socket","emit","subscribe","setCursor","op","mine","delCt","addName","photoURL","userslist","usericon","classList","add","color","idToColor","styleTag","hexToRgbaStyle","querySelector","anchorMap","setAnchor","anchor","forEach","m","clear","emptyClass","markText","removeId","total","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","return","hex","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","g","b","io","transports","clearAll","once","anchors","names","destroy","disconnect","visibility_on_extends","visibility_on_objectWithoutProperties","visibility_on_objectWithoutPropertiesLoose","visibility_on_ref2","visibility_on_ref3","visibility_on_SvgVisibilityOn","visibility_on_ForwardRef","visibility_off_extends","visibility_off_objectWithoutProperties","visibility_off_objectWithoutPropertiesLoose","visibility_off_ref2","visibility_off_ref3","visibility_off_SvgVisibilityOff","visibility_off_ForwardRef","Paper_templateObject","StyledPaper","Paper_templateObject2","VisibilityWrapper","Paper_templateObject3","MarkdownRenderWrapper","Paper_templateObject4","RenderButton","Paper_templateObject5","toggleRenderMarkdown","Paper_Wrapper","components_Editor_Editor","react_markdown_default","GlobalStyle","App_templateObject","createContext","requestUserData","mobileState","Provider","components_Toolbar_Toolbar","components_Sidebar_Sidebar","components_Paper_Paper","BrowserRouter","Switch","Route","path","component","App","Redirect","to","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","rootReducer","applyMiddleware","thunkMiddleware","render","es","components_RootRouter_RootRouter","URL","process","origin","response","status","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.bf8c03e8.chunk.js","sourcesContent":["// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export const SET_CM_INSTANCE = 'SET_CM_INSTANCE'\n\nexport const setCmInstance = ({ codeMirror, doClick }) => ({\n\ttype: SET_CM_INSTANCE,\n\teditor: {\n\t\tcodeMirror,\n\t\tdoClick,\n\t},\n})\n","export const RECEIVE_USER_DATA = 'RECEIVE_USER_DATA'\nexport const LOGOUT = 'LOGOUT'\nexport const CREATE_FILE_SUCCESS = 'CREATE_FILE_SUCCESS'\nexport const DELETE_FILE_SUCCESS = 'DELETE_FILE_SUCCESS'\n\nexport const requestUserData = () => async dispatch => {\n\ttry {\n\t\tconst data = await fetch('/user')\n\t\tdispatch(receiveUserData(await data.json()))\n\t} catch (err) {\n\t\tconsole.warn(err)\n\t}\n}\n\nexport const receiveUserData = data => ({\n\ttype: RECEIVE_USER_DATA,\n\tdata,\n})\n\nexport const logout = history => async dispatch => {\n\tawait fetch('/auth/logout')\n\tdispatch(logoutSuccess())\n\thistory.push('/')\n}\n\nexport const logoutSuccess = () => ({\n\ttype: LOGOUT,\n})\n\nexport const createFile = name => async dispatch => {\n\tconst data = await fetch(`/file/${name}`, { method: 'POST' })\n\tdispatch(createFileSuccess(name, await data.text()))\n}\n\nexport const createFileSuccess = (name, nameHash) => ({\n\ttype: CREATE_FILE_SUCCESS,\n\tdata: {\n\t\tname,\n\t\tnameHash,\n\t},\n})\n\nexport const deleteFile = nameHash => async dispatch => {\n\ttry {\n\t\tawait fetch(`/file/${nameHash}`, { method: 'DELETE' })\n\t\treturn dispatch(deleteFileSuccess(nameHash))\n\t} catch (err) {\n\t\tconsole.warn(err)\n\t}\n}\n\nexport const deleteFileSuccess = nameHash => ({\n\ttype: DELETE_FILE_SUCCESS,\n\tnameHash,\n})\n","import { RECEIVE_USER_DATA, LOGOUT, CREATE_FILE_SUCCESS, DELETE_FILE_SUCCESS } from '../actions/user'\n\nconst initialState = {\n\townFiles: [],\n\tsecondFiles: [],\n}\n\nexport default (state = initialState, action) => {\n\tswitch (action.type) {\n\t\tcase RECEIVE_USER_DATA:\n\t\t\treturn { ...action.data, currentFile: action.data.ownFiles[0] }\n\t\tcase LOGOUT:\n\t\t\treturn initialState\n\t\tcase CREATE_FILE_SUCCESS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\townFiles: [...state.ownFiles, action.data],\n\t\t\t}\n\t\tcase DELETE_FILE_SUCCESS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\townFiles: state.ownFiles.filter(({ nameHash }) => nameHash !== action.nameHash),\n\t\t\t}\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","export const RECEIVE_SHARE_LINK = 'RECEIVE_SHARE_LINK'\n\nexport const getShareLink = nameHash => async dispatch => {\n\ttry {\n\t\tconst data = await fetch(`/link/${nameHash}`)\n\n\t\tdispatch(receiveShareLink(await data.json()))\n\t} catch (err) {\n\t\tconsole.dir(err)\n\t}\n}\n\nconst receiveShareLink = data => ({\n\ttype: RECEIVE_SHARE_LINK,\n\tdata,\n})\n","import { combineReducers } from 'redux'\nimport editor from './editor'\nimport renderMarkdown from './renderMarkdown'\nimport user from './user'\nimport shareLink from './shareLink'\n\nexport default combineReducers({\n\teditor,\n\trenderMarkdown,\n\tuser,\n\tshareLink,\n})\n","import { SET_CM_INSTANCE } from '../actions/editor'\n\nexport default (state = { codeMirror: {} }, action) => {\n\tswitch (action.type) {\n\t\tcase SET_CM_INSTANCE:\n\t\t\treturn action.editor\n\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","import { TOGGLE_RENDER_MARKDOWN } from '../actions/renderMarkdown'\n\nexport default (state = false, action) => {\n\tswitch (action.type) {\n\t\tcase TOGGLE_RENDER_MARKDOWN:\n\t\t\treturn !state\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","export const TOGGLE_RENDER_MARKDOWN = 'TOGGLE_RENDER_MARKDOWN'\n\nexport const toggleRenderMarkdown = () => ({\n\ttype: TOGGLE_RENDER_MARKDOWN,\n})\n","import { RECEIVE_SHARE_LINK } from '../actions/shareLink'\n\nexport default (state = {}, action) => {\n\tswitch (action.type) {\n\t\tcase RECEIVE_SHARE_LINK:\n\t\t\treturn action.data\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M11 0L12 1L6 7V5L11 0Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1 0L-1.90735e-06 1L6 7V5L1 0Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgArrowDown = function SvgArrowDown(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 7,\n    viewBox: \"0 0 12 7\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgArrowDown, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/arrow-down.b1b39921.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"\n});\n\nvar SvgBurger = function SvgBurger(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgBurger, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/burger.c275e518.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0V3H5.5V15H8.5V3H14V0H0Z\"\n});\n\nvar SvgTitle = function SvgTitle(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 14,\n    height: 15,\n    viewBox: \"0 0 14 15\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgTitle, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/title.2e07aade.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M8.6 6.79C9.57 6.12 10.25 5.02 10.25 4C10.25 1.74 8.5 0 6.25 0H0V14H7.04C9.13 14 10.75 12.3 10.75 10.21C10.75 8.69 9.89 7.39 8.6 6.79ZM3 2.5H6C6.83 2.5 7.5 3.17 7.5 4C7.5 4.83 6.83 5.5 6 5.5H3V2.5ZM6.5 11.5H3V8.5H6.5C7.33 8.5 8 9.17 8 10C8 10.83 7.33 11.5 6.5 11.5Z\"\n});\n\nvar SvgBold = function SvgBold(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 11,\n    height: 14,\n    viewBox: \"0 0 11 14\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgBold, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/bold.f8b8ed46.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M4 0V3H6.21L2.79 11H0V14H8V11H5.79L9.21 3H12V0H4Z\"\n});\n\nvar SvgItalic = function SvgItalic(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 14,\n    viewBox: \"0 0 12 14\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgItalic, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/italic.7fa19bc7.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1 10H4L6 6V0H0V6H3L1 10ZM9 10H12L14 6V0H8V6H11L9 10Z\"\n});\n\nvar SvgQuote = function SvgQuote(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 14,\n    height: 10,\n    viewBox: \"0 0 14 10\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgQuote, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/quote.6319b83b.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M7.4 10.6L2.8 6L7.4 1.4L6 0L0 6L6 12L7.4 10.6ZM12.6 10.6L17.2 6L12.6 1.4L14 0L20 6L14 12L12.6 10.6Z\"\n});\n\nvar SvgCode = function SvgCode(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 12,\n    viewBox: \"0 0 20 12\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgCode, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/code.9a62a51f.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 18H2V16H0V18ZM4 18H6V16H4V18ZM2 4H0V6H2V4ZM0 14H2V12H0V14ZM6 0H4V2H6V0ZM2 0H0V2H2V0ZM14 0H12V2H14V0ZM16 6H18V4H16V6ZM16 0V2H18V0H16ZM12 18H14V16H12V18ZM10 0H8V8H0V10H8V18H10V10H18V8H10V0ZM16 18H18V16H16V18ZM16 14H18V12H16V14Z\"\n});\n\nvar SvgTable = function SvgTable(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgTable, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/table.0985368b.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1.9 5C1.9 3.29 3.29 1.9 5 1.9H9V0H5C2.24 0 0 2.24 0 5C0 7.76 2.24 10 5 10H9V8.1H5C3.29 8.1 1.9 6.71 1.9 5ZM6 6H14V4H6V6ZM15 0H11V1.9H15C16.71 1.9 18.1 3.29 18.1 5C18.1 6.71 16.71 8.1 15 8.1H11V10H15C17.76 10 20 7.76 20 5C20 2.24 17.76 0 15 0Z\"\n});\n\nvar SvgLink = function SvgLink(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 10,\n    viewBox: \"0 0 20 10\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgLink, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/link.296bc724.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M18 16V2C18 0.9 17.1 0 16 0H2C0.9 0 0 0.9 0 2V16C0 17.1 0.9 18 2 18H16C17.1 18 18 17.1 18 16ZM5.5 10.5L8 13.51L11.5 9L16 15H2L5.5 10.5Z\"\n});\n\nvar SvgImg = function SvgImg(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgImg, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/img.6020ea6d.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M2 13.5H4.5V12H2V13.5ZM2 16H7.5V14.5H2V16ZM4.5 0H2V1.5H4.5V0ZM15 0H6.5V1.5H15V0ZM9.5 16H14V14.5H9.5V16ZM0 9H18V7H0V9Z\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M2 2.5H7.5V4H2V2.5Z\"\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M6 12H15.5V13.5H6V12Z\"\n});\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M9.5 2.5H15.5V4H9.5V2.5Z\"\n});\n\nvar SvgDivider = function SvgDivider(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2, _ref3, _ref4, _ref5);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgDivider, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/divider.3f7181c6.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M2 6.5C1.17 6.5 0.5 7.17 0.5 8C0.5 8.83 1.17 9.5 2 9.5C2.83 9.5 3.5 8.83 3.5 8C3.5 7.17 2.83 6.5 2 6.5ZM2 0.5C1.17 0.5 0.5 1.17 0.5 2C0.5 2.83 1.17 3.5 2 3.5C2.83 3.5 3.5 2.83 3.5 2C3.5 1.17 2.83 0.5 2 0.5ZM2 12.5C1.17 12.5 0.5 13.18 0.5 14C0.5 14.82 1.18 15.5 2 15.5C2.82 15.5 3.5 14.82 3.5 14C3.5 13.18 2.83 12.5 2 12.5ZM5 15H19V13H5V15ZM5 9H19V7H5V9ZM5 1V3H19V1H5Z\"\n});\n\nvar SvgUl = function SvgUl(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgUl, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/ul.67cb0351.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 13H2V13.5H1V14.5H2V15H0V16H3V12H0V13ZM1 4H2V0H0V1H1V4ZM0 7H1.8L0 9.1V10H3V9H1.2L3 6.9V6H0V7ZM5 1V3H19V1H5ZM5 15H19V13H5V15ZM5 9H19V7H5V9Z\"\n});\n\nvar SvgOl = function SvgOl(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgOl, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/ol.1bdd9112.svg\";\nexport { ForwardRef as ReactComponent };","import { ReactComponent as TitleIcon } from '../../icons/toolbar/title.svg'\nimport { ReactComponent as BoldIcon } from '../../icons/toolbar/bold.svg'\nimport { ReactComponent as ItalicIcon } from '../../icons/toolbar/italic.svg'\nimport { ReactComponent as QuoteIcon } from '../../icons/toolbar/quote.svg'\nimport { ReactComponent as CodeIcon } from '../../icons/toolbar/code.svg'\nimport { ReactComponent as TableIcon } from '../../icons/toolbar/table.svg'\nimport { ReactComponent as LinkIcon } from '../../icons/toolbar/link.svg'\nimport { ReactComponent as ImgIcon } from '../../icons/toolbar/img.svg'\nimport { ReactComponent as DividerIcon } from '../../icons/toolbar/divider.svg'\nimport { ReactComponent as UlIcon } from '../../icons/toolbar/ul.svg'\nimport { ReactComponent as OlIcon } from '../../icons/toolbar/ol.svg'\n\nexport default [\n\t{ Icon: TitleIcon, title: 'Heading', method: 'heading' },\n    { Icon: BoldIcon, title: 'Bold', method: 'bold' },\n    { Icon: ItalicIcon, title: 'Italic', method: 'italic' },\n    { Icon: QuoteIcon, title: 'Blockquote', method: 'quote' },\n    { Icon: CodeIcon, title: 'Code', method: 'code' },\n    { Icon: TableIcon, title: 'Table', method: 'table' },\n    { Icon: LinkIcon, title: 'Link', method: 'link' },\n    { Icon: ImgIcon, title: 'Image', method: 'image' },\n    { Icon: DividerIcon , title: 'Divider', method: 'hr'},\n    { Icon: UlIcon, title: 'Unordered list', method: 'ulist' },\n    { Icon: OlIcon, title: 'Ordered list', method: 'olist' },\n]\n","import { createGlobalStyle } from 'styled-components'\n\nexport default createGlobalStyle`\n    .wmd-prompt-background {\n        background-color: rgba(0, 0, 0, 0.15);\n    }\n    .wmd-prompt-dialog {\n        padding: 20px;\n        width: 400px;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        background-color: white;\n        box-shadow: 4px 2px 5px rgba(0, 0, 0, 0.15);\n        border-radius: 5px;\n        font-family: Roboto;\n        p:first-of-type {\n            padding-bottom: 20px;\n            b {\n                font-size: 1.5em;\n                font-weight: 300;\n            }\n        }\n        input[type=\"text\"] {\n            border: none;\n            border-bottom: 1px solid var(--c-lightgrey-text);\n            transition: border-bottom-color 0.3s;\n            outline: 0;\n            padding: 10px;\n            margin-bottom: 15px;\n            font-size: 16px;\n            &:focus {\n                border-bottom-color: var(--c-blue-hl);\n            }\n        }\n        input[type=\"button\"] {\n            padding: 8px;\n            margin-left: 5px;\n            border-radius: 5px;\n            border: 0;\n            outline: 0;\n            text-transform: uppercase;\n            font-size: 13px;\n            cursor: pointer;\n            background-color: transparent;\n            transition: background-color 0.2s,color 0.2s;\n            &:hover {\n                background-color: rgba(0, 0, 0, 0.05)\n            }\n        }\n        input[type=\"file\"] {\n            position: absolute;\n            width: 0;\n            height: 0;\n            overflow: hidden;\n        }\n        label.file-input {\n            display: block;\n            padding: 8px;\n            margin: 0 0 15px 30px;\n            width: fit-content;\n            border-radius: 5px;\n            font-size: 16px;\n            cursor: pointer;\n            background-color: rgba(0, 0, 0, 0.02);\n            transition: background-color 0.2s,color 0.2s;\n            &:hover {\n                background-color: rgba(0, 0, 0, 0.1);\n                color: black;\n            }\n        }\n    }\n`\n","import React from 'react'\nimport styled from 'styled-components'\nimport { connect } from 'react-redux'\n\nimport ButtonList from './ButtonList'\nimport DialogStyle from './DialogStyle'\n\nconst StyledButtons = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tflex-wrap: wrap;\n\tjustify-content: center;\n\tsvg {\n\t\tmargin: 15px;\n\t\tcursor: pointer;\n\t}\n`\n\nconst Buttons = ({ editor, dark }) => (\n\t<>\n\t\t<StyledButtons>\n\t\t\t{ButtonList.map(({ Icon, method }, index) => (\n\t\t\t\t<Icon\n\t\t\t\t\tkey={index}\n\t\t\t\t\tonClick={() => editor.doClick(method)}\n\t\t\t\t\tfill={`var(--c-${dark ? 'dark' : 'light'}grey-text)`}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</StyledButtons>\n\t\t<DialogStyle />\n\t</>\n)\n\nexport default connect(({ editor }) => ({ editor }))(Buttons)\n","import styled from 'styled-components'\n\nexport default styled.img`\n\twidth: 35px;\n\theight: 35px;\n\tborder-radius: 50%;\n`\n","import React, { useState, useEffect, useRef, createRef } from 'react'\nimport styled from 'styled-components'\n\nconst Container = styled.div`\n\tposition: relative;\n`\n\nconst OptionsWrapper = styled.div`\n\tposition: absolute;\n\ttop: 100%;\n\tdisplay: ${props => (props.visible ? 'block' : 'none')};\n`\n\nexport const OpenMenu = () => null\n\nconst Menu = ({\n\tchildren,\n\tContainerTag = Container,\n\tOptionsContainer = 'div',\n\tonChange = () => {},\n\tonOpen = () => {},\n}) => {\n\tconst clickAwayRef = useRef(createRef())\n\tconst [isMenuOpen, setMenuOpen] = useState(false)\n\n\tconst toggleMenu = e => {\n\t\te.stopPropagation()\n\t\tif (isMenuOpen) {\n\t\t\tsetMenuOpen(false)\n\t\t} else {\n\t\t\tonOpen()\n\t\t\tsetMenuOpen(true)\n\t\t}\n\t}\n\tconst open = children.find(child => child.type === OpenMenu)\n\tconst options = children.filter(child => child.props && child.type !== OpenMenu)\n\n\tconst hideOnClickAway = event => {\n\t\tsetMenuOpen(false)\n\t}\n\n\tuseEffect(() => {\n\t\twindow.addEventListener('click', hideOnClickAway)\n\t\treturn () => window.removeEventListener('click', hideOnClickAway)\n\t}, [])\n\n\treturn (\n\t\t<ContainerTag onClick={toggleMenu} ref={clickAwayRef}>\n\t\t\t{open && open.props.children}\n\t\t\t<OptionsWrapper visible={isMenuOpen}>\n\t\t\t\t<OptionsContainer onClick={e => e.stopPropagation()}>\n\t\t\t\t\t{options &&\n\t\t\t\t\t\tReact.Children.map(options, option =>\n\t\t\t\t\t\t\tReact.cloneElement(option, {\n\t\t\t\t\t\t\t\tonClick: e => onChange(option.props.value, e),\n\t\t\t\t\t\t\t\t...option.props,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)}\n\t\t\t\t</OptionsContainer>\n\t\t\t</OptionsWrapper>\n\t\t</ContainerTag>\n\t)\n}\n\nexport default Menu\n","import React, { useState } from 'react'\nimport { createPortal } from 'react-dom'\nimport styled, { css } from 'styled-components'\n\nconst ModalWrapper = styled.div`\n\tposition: absolute;\n\twidth: 100%;\n\theight: 100vh;\n\ttop: 0;\n\tleft: 0;\n\tbackground-color: rgba(0, 0, 0, 0.15);\n\tz-index: 4;\n\topacity: 1;\n\tpointer-events: auto;\n\ttransition: opacity 0.3s;\n\t${props =>\n\t\t!props.visible &&\n\t\tcss`\n\t\t\topacity: 0;\n\t\t\tpointer-events: none;\n\t\t`};\n`\n\nconst ModalContent = styled.div`\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\tbackground-color: white;\n\tborder-radius: 5px;\n\tpadding: 20px;\n\tbox-shadow: 4px 2px 5px rgba(0, 0, 0, 0.15);\n\tmax-width: calc(100% - 70px);\n    width: 500px;\n`\n\nconst Modal = ({ visible, onClose, children }) =>\n\tcreatePortal(\n\t\t<ModalWrapper onClick={onClose} visible={visible}>\n\t\t\t<ModalContent onClick={e => e.stopPropagation()}>{children}</ModalContent>\n\t\t</ModalWrapper>,\n\t\tdocument.body\n\t)\n\nexport default Modal\n\nexport const useModal = () => {\n\tconst [visible, toggleVisibility] = useState(false)\n\n\tconst hideModal = () => toggleVisibility(false)\n\tconst showModal = () => toggleVisibility(true)\n\n\treturn [visible, hideModal, showModal]\n}\n","import React from 'react'\nimport styled, { css } from 'styled-components'\n\nconst Input = styled.input`\n\tborder: none;\n\tborder-bottom: 1px solid var(--c-lightgrey-text);\n\ttransition: border-bottom-color 0.3s;\n\toutline: 0;\n\tpadding: 10px;\n\tmargin-bottom: 15px;\n\tfont-size: 16px;\n\t&:focus {\n\t\tborder-bottom-color: var(--c-blue-hl);\n\t}\n\t${props =>\n\t\tprops.invalid &&\n\t\tcss`\n\t\t\tborder-bottom-color: red !important;\n\t\t`};\n`\n\nconst ErrorMessage = styled.div`\n\tcolor: red;\n\tfont-size: 14px;\n`\n\nconst TextInput = ({ error, value, onChange, ...rest }) => (\n\t<>\n\t\t<Input\n\t\t\ttype=\"text\"\n\t\t\tvalue={value}\n\t\t\tinvalid={error && Boolean(error(value))}\n\t\t\tonChange={e => onChange && onChange(e.target.value)}\n\t\t\t{...rest}\n\t\t/>\n\t\t<ErrorMessage>{error && error(value)}</ErrorMessage>\n\t</>\n)\n\nexport default TextInput\n","export const baseApiUrl =\n\tprocess.env.NODE_ENV === 'development' ? process.env.REACT_APP_API_BASE_URL : window.location.hostname\n\nexport const mobileMediaQuery = '(max-width: 1160px)'\n","import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport styled from 'styled-components'\nimport Modal from '../common/Modal'\nimport TextInput from '../common/TextInput'\nimport { getShareLink } from '../../actions/shareLink'\nimport { baseApiUrl } from '../../config/constants'\n\nconst Title = styled.h2`\n\tfont-weight: 300;\n`\n\nconst LinkInput = styled(TextInput)`\n\tmargin-top: 15px;\n\twidth: calc(100% - 20px);\n`\n\nconst ShareLinkModal = ({\n\tvisible,\n\tonClose,\n\tgetShareLink,\n\tshareLink,\n\tmatch: {\n\t\tparams: { nameHash },\n\t},\n}) => {\n\tuseEffect(\n\t\t() => {\n\t\t\tif (visible) {\n\t\t\t\tgetShareLink(nameHash)\n\t\t\t}\n\t\t},\n\t\t[visible, nameHash]\n\t)\n\n\treturn (\n\t\t<Modal visible={visible} onClose={onClose}>\n\t\t\t<Title>Send this link to your friends to share a file with them</Title>\n\t\t\t<LinkInput\n\t\t\t\tplaceholder=\"Generating a link for you\"\n\t\t\t\tvalue={shareLink.link ? `${baseApiUrl}/share/${shareLink.link}` : ''}\n\t\t\t\tonChange={() => {}}\n\t\t\t/>\n\t\t</Modal>\n\t)\n}\n\nconst mapStateToProps = ({ shareLink }) => ({ shareLink })\n\nconst mapDispatchToProps = { getShareLink }\n\nexport default withRouter(\n\tconnect(\n\t\tmapStateToProps,\n\t\tmapDispatchToProps\n\t)(ShareLinkModal)\n)\n","import { useContext, useEffect } from 'react'\nimport { mobileMediaQuery } from '../../config/constants'\nimport { IsMobileContext } from '../App/App'\n\nconst useMatchMobile = () => {\n\tconst [isMobile, setMobile] = useContext(IsMobileContext)\n\n\tuseEffect(() => {\n\t\tconst handleResize = () => {\n\t\t\tconst { matches } = matchMedia(mobileMediaQuery)\n\t\t\tif (matches !== isMobile) {\n\t\t\t\tsetMobile(matches)\n\t\t\t}\n\t\t}\n\n\t\twindow.addEventListener('resize', handleResize)\n\t\treturn () => window.removeEventListener('resize', handleResize)\n\t})\n\n\treturn isMobile\n}\n\nexport default useMatchMobile\n","import React, { useCallback } from 'react'\nimport { createPortal } from 'react-dom'\nimport { connect } from 'react-redux'\nimport styled from 'styled-components'\nimport { withRouter } from 'react-router-dom'\nimport { ReactComponent as ArrowDownIcon } from '../../icons/arrow-down.svg'\nimport { ReactComponent as BurgerIcon } from '../../icons/burger.svg'\nimport Buttons from './Buttons'\nimport Avatar from '../common/Avatar'\nimport Menu, { OpenMenu } from '../common/Menu'\nimport { useModal } from '../common/Modal'\nimport ShareLinkModal from './ShareLinkModal'\nimport { logout } from '../../actions/user'\nimport useMatchMobile from '../hooks/useMatchMobile'\nimport { baseApiUrl } from '../../config/constants'\n\nconst Button = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tcursor: pointer;\n`\n\nconst StyledToolbar = styled.div`\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n\tbackground-color: var(--c-darkgrey-bg);\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 2;\n`\n\nconst BottomToolbar = styled.div`\n\tposition: fixed;\n\tbottom: 0;\n\twidth: 100%;\n\tbackground-color: var(--c-lightgrey-bg);\n\tz-index: 2;\n`\n\nconst Wrapper = styled.div`\n\twidth: 100%;\n\tmax-width: var(--container-width);\n\theight: 60px;\n\tdisplay: flex;\n\tjustify-content: space-between;\n`\n\nconst Group = styled.div`\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\talign-items: center;\n\tcolor: var(--c-lightgrey-text);\n\tfont-weight: 200;\n\t&:nth-of-type(3n - 1) {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t}\n\t&:nth-of-type(3n) {\n\t\tdisplay: flex;\n\t\tjustify-content: flex-end;\n\t}\n\tsvg {\n\t\tmargin-left: 15px;\n\t}\n`\n\nconst BurgerButton = styled(BurgerIcon)`\n\tmargin: 0 15px 0 0 !important;\n`\n\nconst LoginButton = styled.a`\n\tfont-weight: 500;\n\tcolor: var(--c-blue-hl);\n\ttext-decoration: none;\n`\n\nconst UserName = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tcursor: pointer;\n\theight: 100%;\n\t${Avatar} {\n\t\tmargin-left: 10px;\n\t}\n`\n\nconst MenuButtonsContainer = styled.div`\n\tmargin-top: 10px;\n\twidth: 200px;\n\tright: 0;\n\tbox-shadow: 4px 2px 2px rgba(0, 0, 0, 0.2);\n\tbackground-color: white;\n\tcolor: var(--c-darkgrey-text);\n`\n\nconst MenuButton = styled.div`\n\tdisplay: flex;\n\tpadding: 15px 20px;\n\tcursor: pointer;\n`\n\nconst Toolbar = ({ user, codeMirror, logout, toggleMobileSidebar, match, history }) => {\n\tconst [shareLinkVisible, hideShareLink, showShareLink] = useModal()\n\tconst isMobile = useMatchMobile()\n\tconst download = useCallback(\n\t\t(filename, codeMirror) => () => {\n\t\t\tconst a = document.createElement('a')\n\t\t\tconst text = codeMirror.getValue()\n\t\t\ta.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text))\n\t\t\ta.setAttribute('download', `${filename}.md`)\n\t\t\ta.style.display = 'none'\n\t\t\tdocument.body.appendChild(a)\n\t\t\ta.click()\n\t\t\tdocument.body.removeChild(a)\n\t\t},\n\t\t[]\n\t)\n\n\tconst currentFile =\n\t\t[...user.ownFiles, ...user.secondFiles].find(file => file.nameHash === match.params.nameHash) || {}\n\n\treturn (\n\t\t<StyledToolbar>\n\t\t\t<Wrapper>\n\t\t\t\t<Group>\n\t\t\t\t\t{isMobile && (\n\t\t\t\t\t\t<BurgerButton\n\t\t\t\t\t\t\tfill=\"var(--c-lightgrey-text)\"\n\t\t\t\t\t\t\tonClick={() => toggleMobileSidebar(prevState => !prevState)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<Menu OptionsContainer={MenuButtonsContainer}>\n\t\t\t\t\t\t<OpenMenu>\n\t\t\t\t\t\t\t<Button>\n\t\t\t\t\t\t\t\t{currentFile.name}\n\t\t\t\t\t\t\t\t<ArrowDownIcon />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</OpenMenu>\n\t\t\t\t\t\t<MenuButton onClick={showShareLink}>Get shareable link</MenuButton>\n\t\t\t\t\t\t<MenuButton onClick={download(currentFile.name, codeMirror)}>Export as .md</MenuButton>\n\t\t\t\t\t</Menu>\n\t\t\t\t</Group>\n\t\t\t\t{isMobile ? (\n\t\t\t\t\tcreatePortal(\n\t\t\t\t\t\t<BottomToolbar>\n\t\t\t\t\t\t\t<Buttons dark />\n\t\t\t\t\t\t</BottomToolbar>,\n\t\t\t\t\t\tdocument.body\n\t\t\t\t\t)\n\t\t\t\t) : (\n\t\t\t\t\t<Group>\n\t\t\t\t\t\t<Buttons />\n\t\t\t\t\t</Group>\n\t\t\t\t)}\n\t\t\t\t<Group>\n\t\t\t\t\t{user.name ? (\n\t\t\t\t\t\t<Menu OptionsContainer={MenuButtonsContainer}>\n\t\t\t\t\t\t\t<OpenMenu>\n\t\t\t\t\t\t\t\t<UserName>\n\t\t\t\t\t\t\t\t\t{user.name} {user.secondName}\n\t\t\t\t\t\t\t\t\t{user.photoURI && <Avatar src={user.photoURI} />}\n\t\t\t\t\t\t\t\t</UserName>\n\t\t\t\t\t\t\t</OpenMenu>\n\t\t\t\t\t\t\t<MenuButton onClick={() => logout(history)}>Logout</MenuButton>\n\t\t\t\t\t\t</Menu>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<LoginButton href={`http://${baseApiUrl}/auth/google`}>Login</LoginButton>\n\t\t\t\t\t)}\n\t\t\t\t</Group>\n\t\t\t</Wrapper>\n\t\t\t<ShareLinkModal visible={shareLinkVisible} onClose={hideShareLink} />\n\t\t</StyledToolbar>\n\t)\n}\n\nconst mapStateToProps = ({ user, editor: { codeMirror } }) => ({ user, codeMirror })\n\nconst mapDispatchToProps = { logout }\n\nexport default withRouter(\n\tconnect(\n\t\tmapStateToProps,\n\t\tmapDispatchToProps\n\t)(Toolbar)\n)\n","import React, { useState, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport Modal from '../common/Modal'\nimport TextInput from '../common/TextInput'\n\nconst Title = styled.h2`\n\tfont-weight: 300;\n`\nconst ButtonsContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: flex-end;\n`\n\nconst Button = styled.div`\n\tpadding: 8px;\n\tmargin-left: 5px;\n\tborder-radius: 5px;\n\ttext-transform: uppercase;\n\tfont-size: 13px;\n\tcursor: pointer;\n\tbackground-color: transparent;\n\ttransition: background-color 0.2s, color 0.2s;\n\t&:hover {\n\t\tbackground-color: rgba(0, 0, 0, 0.05);\n\t}\n\t${props =>\n\t\tprops.disabled &&\n\t\tcss`\n\t\t\tcolor: var(--c-lightgrey-text);\n\t\t\tpointer-events: none;\n\t\t`};\n`\n\nconst CreateFileModal = ({ visible, onClose, error, submit }) => {\n\tconst [fileName, setFileName] = useState('')\n\tconst [touched, setTouched] = useState(false)\n\n\tconst handleNameChange = useCallback(\n\t\tnewFileName => {\n\t\t\tif (!touched) setTouched(true)\n\t\t\tsetFileName(newFileName)\n\t\t},\n\t\t[touched]\n\t)\n\n\treturn (\n\t\t<Modal visible={visible} onClose={onClose}>\n\t\t\t<Title>Enter new file name</Title>\n\t\t\t<TextInput value={fileName} onChange={handleNameChange} error={touched && error} />\n\t\t\t<ButtonsContainer>\n\t\t\t\t<Button onClick={onClose}>Cancel</Button>\n\t\t\t\t<Button disabled={Boolean(error(fileName))} onClick={() => submit(fileName).then(onClose)}>\n\t\t\t\t\tCreate\n\t\t\t\t</Button>\n\t\t\t</ButtonsContainer>\n\t\t</Modal>\n\t)\n}\n\nexport default CreateFileModal\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0V0z\"\n});\n\nvar SvgDelete = function SvgDelete(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgDelete, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/delete.30e9677a.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport styled from 'styled-components'\nimport { createFile, deleteFile } from '../../actions/user'\nimport { useModal } from '../common/Modal'\nimport CreateFileModal from './CreateFileModal'\nimport { ReactComponent as DeleteIcon } from '../../icons/delete.svg'\n\nconst Item = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n\ttext-decoration: none;\n\tbackground-color: ${({ hl }) => (hl ? 'var(--c-white-hl)' : 'transparent')};\n\tborder-left: ${({ hl }) => (hl ? '4px' : 0)} solid var(--c-blue-hl);\n\tpadding: 8px;\n\tpadding-left: ${({ hl }) => (hl ? '17px' : '21px')};\n\tfont-weight: 200;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\tcolor: var(--c-darkgrey-text);\n\tcursor: pointer;\n\ttransition: color 0.3s;\n\t&:hover {\n\t\tcolor: black;\n\t\tsvg {\n\t\t\tfill: var(--c-red-hl);\n\t\t\tpointer-events: auto;\n\t\t}\n\t}\n\tsvg {\n\t\tfill: transparent;\n\t\tpointer-events: none;\n\t\ttransition: fill 0.3s 0.1s;\n\t}\n`\n\nconst NewFileButton = styled(Item)`\n\tdisplay: block;\n\tmargin-top: 10px;\n\t&::before {\n\t\tcontent: '+';\n\t\tfont-size: 1.3rem;\n\t\tfont-weight: 400;\n\t\topacity: 0.7;\n\t\tvertical-align: middle;\n\t\tmargin-left: -10px;\n\t\tmargin-right: 10px;\n\t}\n`\n\nconst Text = styled.p`\n\tmargin: 50px 0 3px 21px;\n\tfont-weight: 500;\n\tfont-size: 0.9rem;\n\ttext-transform: uppercase;\n\tcolor: var(--c-grey-text);\n`\n\nconst FileList = ({ user, createFile, deleteFile, match, history }) => {\n\tconst [createFileVisible, hideCreateFile, showCreateFile] = useModal()\n\n\tconst currentFile =\n\t\t[...user.ownFiles, ...user.secondFiles].find(file => file.nameHash === match.params.nameHash) || {}\n\treturn (\n\t\t<>\n\t\t\t{!!user.ownFiles.length && (\n\t\t\t\t<>\n\t\t\t\t\t<Text>Own files</Text>\n\t\t\t\t\t{user.ownFiles.map(({ name, nameHash }) => (\n\t\t\t\t\t\t<Item\n\t\t\t\t\t\t\tkey={nameHash}\n\t\t\t\t\t\t\thl={nameHash === currentFile.nameHash}\n\t\t\t\t\t\t\tonClick={() => history.push(`/${nameHash}`)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t\t<DeleteIcon\n\t\t\t\t\t\t\t\tonClick={async e => {\n\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\tawait deleteFile(nameHash)\n\t\t\t\t\t\t\t\t\thistory.push('/')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Item>\n\t\t\t\t\t))}\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{!!user.secondFiles.length && (\n\t\t\t\t<>\n\t\t\t\t\t<Text>Other's files</Text>\n\t\t\t\t\t{user.secondFiles.map(({ name, nameHash }) => (\n\t\t\t\t\t\t<Item\n\t\t\t\t\t\t\tkey={nameHash}\n\t\t\t\t\t\t\thl={nameHash === currentFile.nameHash}\n\t\t\t\t\t\t\tonClick={() => history.push(`/${nameHash}`)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t\t<DeleteIcon\n\t\t\t\t\t\t\t\tonClick={async e => {\n\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\tawait deleteFile(nameHash)\n\t\t\t\t\t\t\t\t\thistory.push('/')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Item>\n\t\t\t\t\t))}\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t<NewFileButton onClick={showCreateFile}>Add a new file</NewFileButton>\n\t\t\t<CreateFileModal\n\t\t\t\tvisible={createFileVisible}\n\t\t\t\tonClose={hideCreateFile}\n\t\t\t\terror={newFileName => {\n\t\t\t\t\tif (!newFileName.length) {\n\t\t\t\t\t\treturn 'Enter file name'\n\t\t\t\t\t}\n\t\t\t\t\tif (user.ownFiles.some(({ name }) => name === newFileName)) {\n\t\t\t\t\t\treturn 'File with this name already exists'\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tsubmit={createFile}\n\t\t\t/>\n\t\t</>\n\t)\n}\n\nconst mapStateToProps = ({ user }) => ({ user })\n\nconst mapDispatchToProps = { createFile, deleteFile }\n\nexport default withRouter(\n\tconnect(\n\t\tmapStateToProps,\n\t\tmapDispatchToProps\n\t)(FileList)\n)\n","import React from 'react'\nimport { withRouter } from 'react-router-dom'\nimport styled from 'styled-components'\nimport FileList from '../FileList/FileList'\n\nconst StyledSidebar = styled.div`\n\tpadding-top: 40px;\n\twidth: calc((var(--max-width) - var(--container-width)) / 2);\n\tmax-height: calc(100vh - 100px);\n\toverflow-y: auto;\n\tposition: fixed;\n\tmargin-left: 50%;\n\tleft: calc((var(--max-width) / -2));\n\t@media (max-width: 1160px) {\n\t\twidth: 100%;\n\t\tmax-height: calc(100vh - 200px);\n\t\topacity: ${({ mobileSidebarOpen }) => Number(mobileSidebarOpen)};\n\t\ttransform: translateX(${({ mobileSidebarOpen }) => (mobileSidebarOpen ? 0 : -100)}%);\n\t\ttransition: transform 0.5s, opacity 0.3s;\n\t}\n`\n\nconst Sidebar = ({ mobileSidebarOpen }) => (\n\t<StyledSidebar mobileSidebarOpen={mobileSidebarOpen}>\n\t\t<FileList />\n\t</StyledSidebar>\n)\n\nexport default withRouter(Sidebar)\n","/* eslint-disable */\n\nvar Markdown;\n\nif (typeof exports === \"object\" && typeof require === \"function\") // we're in a CommonJS (e.g. Node.js) module\n    Markdown = exports;\nelse\n    Markdown = {};\n    \n// The following text is included for historical reasons, but should\n// be taken with a pinch of salt; it's not all true anymore.\n\n//\n// Wherever possible, Showdown is a straight, line-by-line port\n// of the Perl version of Markdown.\n//\n// This is not a normal parser design; it's basically just a\n// series of string substitutions.  It's hard to read and\n// maintain this way,  but keeping Showdown close to the original\n// design makes it easier to port new features.\n//\n// More importantly, Showdown behaves like markdown.pl in most\n// edge cases.  So web applications can do client-side preview\n// in Javascript, and then build identical HTML on the server.\n//\n// This port needs the new RegExp functionality of ECMA 262,\n// 3rd Edition (i.e. Javascript 1.5).  Most modern web browsers\n// should do fine.  Even with the new regular expression features,\n// We do a lot of work to emulate Perl's regex functionality.\n// The tricky changes in this file mostly have the \"attacklab:\"\n// label.  Major or self-explanatory changes don't.\n//\n// Smart diff tools like Araxis Merge will be able to match up\n// this file with markdown.pl in a useful way.  A little tweaking\n// helps: in a copy of markdown.pl, replace \"#\" with \"//\" and\n// replace \"$text\" with \"text\".  Be sure to ignore whitespace\n// and line endings.\n//\n\n\n//\n// Usage:\n//\n//   var text = \"Markdown *rocks*.\";\n//\n//   var converter = new Markdown.Converter();\n//   var html = converter.makeHtml(text);\n//\n//   alert(html);\n//\n// Note: move the sample code to the bottom of this\n// file before uncommenting it.\n//\n\n(function () {\n\n    function identity(x) { return x; }\n    function returnFalse(x) { return false; }\n\n    function HookCollection() { }\n\n    HookCollection.prototype = {\n\n        chain: function (hookname, func) {\n            var original = this[hookname];\n            if (!original)\n                throw new Error(\"unknown hook \" + hookname);\n\n            if (original === identity)\n                this[hookname] = func;\n            else\n                this[hookname] = function (text) {\n                    var args = Array.prototype.slice.call(arguments, 0);\n                    args[0] = original.apply(null, args);\n                    return func.apply(null, args);\n                };\n        },\n        set: function (hookname, func) {\n            if (!this[hookname])\n                throw new Error(\"unknown hook \" + hookname);\n            this[hookname] = func;\n        },\n        addNoop: function (hookname) {\n            this[hookname] = identity;\n        },\n        addFalse: function (hookname) {\n            this[hookname] = returnFalse;\n        }\n    };\n\n    Markdown.HookCollection = HookCollection;\n\n    // g_urls and g_titles allow arbitrary user-entered strings as keys. This\n    // caused an exception (and hence stopped the rendering) when the user entered\n    // e.g. [push] or [__proto__]. Adding a prefix to the actual key prevents this\n    // (since no builtin property starts with \"s_\"). See\n    // http://meta.stackoverflow.com/questions/64655/strange-wmd-bug\n    // (granted, switching from Array() to Object() alone would have left only __proto__\n    // to be a problem)\n    function SaveHash() { }\n    SaveHash.prototype = {\n        set: function (key, value) {\n            this[\"s_\" + key] = value;\n        },\n        get: function (key) {\n            return this[\"s_\" + key];\n        }\n    };\n\n    Markdown.Converter = function () {\n        var options = {};\n        this.setOptions = function(optionsParam) {\n            options = optionsParam;\n        };\n        \n        var pluginHooks = this.hooks = new HookCollection();\n        \n        // given a URL that was encountered by itself (without markup), should return the link text that's to be given to this link\n        pluginHooks.addNoop(\"plainLinkText\");\n        \n        // called with the orignal text as given to makeHtml. The result of this plugin hook is the actual markdown source that will be cooked\n        pluginHooks.addNoop(\"preConversion\");\n        \n        // called with the text once all normalizations have been completed (tabs to spaces, line endings, etc.), but before any conversions have\n        pluginHooks.addNoop(\"postNormalization\");\n        \n        // Called with the text before / after creating block elements like code blocks and lists. Note that this is called recursively\n        // with inner content, e.g. it's called with the full text, and then only with the content of a blockquote. The inner\n        // call will receive outdented text.\n        pluginHooks.addNoop(\"preBlockGamut\");\n        pluginHooks.addNoop(\"postBlockGamut\");\n        \n        // called with the text of a single block element before / after the span-level conversions (bold, code spans, etc.) have been made\n        pluginHooks.addNoop(\"preSpanGamut\");\n        pluginHooks.addNoop(\"postSpanGamut\");\n        \n        // called with the final cooked HTML code. The result of this plugin hook is the actual output of makeHtml\n        pluginHooks.addNoop(\"postConversion\");\n\n        //\n        // Private state of the converter instance:\n        //\n\n        // Global hashes, used by various utility routines\n        var g_urls;\n        var g_titles;\n        var g_html_blocks;\n\n        // Used to track when we're inside an ordered or unordered list\n        // (see _ProcessListItems() for details):\n        var g_list_level;\n\n        this.makeHtml = function (text) {\n\n            //\n            // Main function. The order in which other subs are called here is\n            // essential. Link and image substitutions need to happen before\n            // _EscapeSpecialCharsWithinTagAttributes(), so that any *'s or _'s in the <a>\n            // and <img> tags get encoded.\n            //\n\n            // This will only happen if makeHtml on the same converter instance is called from a plugin hook.\n            // Don't do that.\n            if (g_urls)\n                throw new Error(\"Recursive call to converter.makeHtml\");\n        \n            // Create the private state objects.\n            g_urls = new SaveHash();\n            g_titles = new SaveHash();\n            g_html_blocks = [];\n            g_list_level = 0;\n\n            text = pluginHooks.preConversion(text);\n\n            // attacklab: Replace ~ with ~T\n            // This lets us use tilde as an escape char to avoid md5 hashes\n            // The choice of character is arbitray; anything that isn't\n            // magic in Markdown will work.\n            text = text.replace(/~/g, \"~T\");\n\n            // attacklab: Replace $ with ~D\n            // RegExp interprets $ as a special character\n            // when it's in a replacement string\n            text = text.replace(/\\$/g, \"~D\");\n\n            // Standardize line endings\n            text = text.replace(/\\r\\n/g, \"\\n\"); // DOS to Unix\n            text = text.replace(/\\r/g, \"\\n\"); // Mac to Unix\n\n            // Make sure text begins and ends with a couple of newlines:\n            text = \"\\n\\n\" + text + \"\\n\\n\";\n\n            // Convert all tabs to spaces.\n            text = _Detab(text);\n\n            // Strip any lines consisting only of spaces and tabs.\n            // This makes subsequent regexen easier to write, because we can\n            // match consecutive blank lines with /\\n+/ instead of something\n            // contorted like /[ \\t]*\\n+/ .\n            text = text.replace(/^[ \\t]+$/mg, \"\");\n            \n            text = pluginHooks.postNormalization(text);\n\n            // Turn block-level HTML blocks into hash entries\n            text = _HashHTMLBlocks(text);\n\n            // Strip link definitions, store in hashes.\n            text = _StripLinkDefinitions(text);\n\n            text = _RunBlockGamut(text);\n\n            text = _UnescapeSpecialChars(text);\n\n            // attacklab: Restore dollar signs\n            text = text.replace(/~D/g, \"$$\");\n\n            // attacklab: Restore tildes\n            text = text.replace(/~T/g, \"~\");\n\n            text = pluginHooks.postConversion(text);\n\n            g_html_blocks = g_titles = g_urls = null;\n\n            return text;\n        };\n\n        function _StripLinkDefinitions(text) {\n            //\n            // Strips link definitions from text, stores the URLs and titles in\n            // hash references.\n            //\n\n            // Link defs are in the form: ^[id]: url \"optional title\"\n\n            /*\n            text = text.replace(/\n                ^[ ]{0,3}\\[(.+)\\]:  // id = $1  attacklab: g_tab_width - 1\n                [ \\t]*\n                \\n?                 // maybe *one* newline\n                [ \\t]*\n                <?(\\S+?)>?          // url = $2\n                (?=\\s|$)            // lookahead for whitespace instead of the lookbehind removed below\n                [ \\t]*\n                \\n?                 // maybe one newline\n                [ \\t]*\n                (                   // (potential) title = $3\n                    (\\n*)           // any lines skipped = $4 attacklab: lookbehind removed\n                    [ \\t]+\n                    [\"(]\n                    (.+?)           // title = $5\n                    [\")]\n                    [ \\t]*\n                )?                  // title is optional\n                (?:\\n+|$)\n            /gm, function(){...});\n            */\n\n            text = text.replace(/^[ ]{0,3}\\[(.+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?(?=\\s|$)[ \\t]*\\n?[ \\t]*((\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+)/gm,\n                function (wholeMatch, m1, m2, m3, m4, m5) {\n                    m1 = m1.toLowerCase();\n                    g_urls.set(m1, _EncodeAmpsAndAngles(m2));  // Link IDs are case-insensitive\n                    if (m4) {\n                        // Oops, found blank lines, so it's not a title.\n                        // Put back the parenthetical statement we stole.\n                        return m3;\n                    } else if (m5) {\n                        g_titles.set(m1, m5.replace(/\"/g, \"&quot;\"));\n                    }\n\n                    // Completely remove the definition from the text\n                    return \"\";\n                }\n            );\n\n            return text;\n        }\n\n        function _HashHTMLBlocks(text) {\n\n            // Hashify HTML blocks:\n            // We only want to do this for block-level HTML tags, such as headers,\n            // lists, and tables. That's because we still want to wrap <p>s around\n            // \"paragraphs\" that are wrapped in non-block-level tags, such as anchors,\n            // phrase emphasis, and spans. The list of tags we're looking for is\n            // hard-coded:\n            var block_tags_a = \"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del\"\n            var block_tags_b = \"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math\"\n\n            // First, look for nested blocks, e.g.:\n            //   <div>\n            //     <div>\n            //     tags for inner block must be indented.\n            //     </div>\n            //   </div>\n            //\n            // The outermost tags must start at the left margin for this to match, and\n            // the inner nested divs must be indented.\n            // We need to do this before the next, more liberal match, because the next\n            // match will start at the first `<div>` and stop at the first `</div>`.\n\n            // attacklab: This regex can be expensive when it fails.\n\n            /*\n            text = text.replace(/\n                (                       // save in $1\n                    ^                   // start of line  (with /m)\n                    <($block_tags_a)    // start tag = $2\n                    \\b                  // word break\n                                        // attacklab: hack around khtml/pcre bug...\n                    [^\\r]*?\\n           // any number of lines, minimally matching\n                    </\\2>               // the matching end tag\n                    [ \\t]*              // trailing spaces/tabs\n                    (?=\\n+)             // followed by a newline\n                )                       // attacklab: there are sentinel newlines at end of document\n            /gm,function(){...}};\n            */\n            text = text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\\b[^\\r]*?\\n<\\/\\2>[ \\t]*(?=\\n+))/gm, hashElement);\n\n            //\n            // Now match more liberally, simply from `\\n<tag>` to `</tag>\\n`\n            //\n\n            /*\n            text = text.replace(/\n                (                       // save in $1\n                    ^                   // start of line  (with /m)\n                    <($block_tags_b)    // start tag = $2\n                    \\b                  // word break\n                                        // attacklab: hack around khtml/pcre bug...\n                    [^\\r]*?             // any number of lines, minimally matching\n                    .*</\\2>             // the matching end tag\n                    [ \\t]*              // trailing spaces/tabs\n                    (?=\\n+)             // followed by a newline\n                )                       // attacklab: there are sentinel newlines at end of document\n            /gm,function(){...}};\n            */\n            text = text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\\b[^\\r]*?.*<\\/\\2>[ \\t]*(?=\\n+)\\n)/gm, hashElement);\n\n            // Special case just for <hr />. It was easier to make a special case than\n            // to make the other regex more complicated.  \n\n            /*\n            text = text.replace(/\n                \\n                  // Starting after a blank line\n                [ ]{0,3}\n                (                   // save in $1\n                    (<(hr)          // start tag = $2\n                        \\b          // word break\n                        ([^<>])*?\n                    \\/?>)           // the matching end tag\n                    [ \\t]*\n                    (?=\\n{2,})      // followed by a blank line\n                )\n            /g,hashElement);\n            */\n            text = text.replace(/\\n[ ]{0,3}((<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g, hashElement);\n\n            // Special case for standalone HTML comments:\n\n            /*\n            text = text.replace(/\n                \\n\\n                                            // Starting after a blank line\n                [ ]{0,3}                                        // attacklab: g_tab_width - 1\n                (                                               // save in $1\n                    <!\n                    (--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)   // see http://www.w3.org/TR/html-markup/syntax.html#comments and http://meta.stackoverflow.com/q/95256\n                    >\n                    [ \\t]*\n                    (?=\\n{2,})                                  // followed by a blank line\n                )\n            /g,hashElement);\n            */\n            text = text.replace(/\\n\\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \\t]*(?=\\n{2,}))/g, hashElement);\n\n            // PHP and ASP-style processor instructions (<?...?> and <%...%>)\n\n            /*\n            text = text.replace(/\n                (?:\n                    \\n\\n            // Starting after a blank line\n                )\n                (                   // save in $1\n                    [ ]{0,3}        // attacklab: g_tab_width - 1\n                    (?:\n                        <([?%])     // $2\n                        [^\\r]*?\n                        \\2>\n                    )\n                    [ \\t]*\n                    (?=\\n{2,})      // followed by a blank line\n                )\n            /g,hashElement);\n            */\n            text = text.replace(/(?:\\n\\n)([ ]{0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g, hashElement);\n\n            return text;\n        }\n\n        function hashElement(wholeMatch, m1) {\n            var blockText = m1;\n\n            // Undo double lines\n            blockText = blockText.replace(/^\\n+/, \"\");\n\n            // strip trailing blank lines\n            blockText = blockText.replace(/\\n+$/g, \"\");\n\n            // Replace the element text with a marker (\"~KxK\" where x is its key)\n            blockText = \"\\n\\n~K\" + (g_html_blocks.push(blockText) - 1) + \"K\\n\\n\";\n\n            return blockText;\n        }\n        \n        var blockGamutHookCallback = function (t) { return _RunBlockGamut(t); }\n\n        function _RunBlockGamut(text, doNotUnhash) {\n            //\n            // These are all the transformations that form block-level\n            // tags like paragraphs, headers, and list items.\n            //\n            \n            text = pluginHooks.preBlockGamut(text, blockGamutHookCallback);\n            \n            text = _DoHeaders(text);\n\n            // Do Horizontal Rules:\n            var replacement = \"<hr />\\n\";\n            text = text.replace(/^[ ]{0,2}([ ]?\\*[ ]?){3,}[ \\t]*$/gm, replacement);\n            text = text.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \\t]*$/gm, replacement);\n            text = text.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \\t]*$/gm, replacement);\n\n            text = _DoLists(text);\n            text = _DoCodeBlocks(text);\n            text = _DoBlockQuotes(text);\n            \n            text = pluginHooks.postBlockGamut(text, blockGamutHookCallback);\n\n            // We already ran _HashHTMLBlocks() before, in Markdown(), but that\n            // was to escape raw HTML in the original Markdown source. This time,\n            // we're escaping the markup we've just created, so that we don't wrap\n            // <p> tags around block-level tags.\n            text = _HashHTMLBlocks(text);\n            text = _FormParagraphs(text, doNotUnhash);\n\n            return text;\n        }\n\n        function _RunSpanGamut(text) {\n            //\n            // These are all the transformations that occur *within* block-level\n            // tags like paragraphs, headers, and list items.\n            //\n\n            text = pluginHooks.preSpanGamut(text);\n            \n            text = _DoCodeSpans(text);\n            text = _EscapeSpecialCharsWithinTagAttributes(text);\n            text = _EncodeBackslashEscapes(text);\n\n            // Process anchor and image tags. Images must come first,\n            // because ![foo][f] looks like an anchor.\n            text = _DoImages(text);\n            text = _DoAnchors(text);\n\n            // Make links out of things like `<http://example.com/>`\n            // Must come after _DoAnchors(), because you can use < and >\n            // delimiters in inline links like [this](<url>).\n            text = _DoAutoLinks(text);\n            \n            text = text.replace(/~P/g, \"://\"); // put in place to prevent autolinking; reset now\n            \n            text = _EncodeAmpsAndAngles(text);\n            text = options._DoItalicsAndBold ? options._DoItalicsAndBold(text) : _DoItalicsAndBold(text);\n\n            // Do hard breaks:\n            text = text.replace(/  +\\n/g, \" <br>\\n\");\n            \n            text = pluginHooks.postSpanGamut(text);\n\n            return text;\n        }\n\n        function _EscapeSpecialCharsWithinTagAttributes(text) {\n            //\n            // Within tags -- meaning between < and > -- encode [\\ ` * _] so they\n            // don't conflict with their use in Markdown for code, italics and strong.\n            //\n\n            // Build a regex to find HTML tags and comments.  See Friedl's \n            // \"Mastering Regular Expressions\", 2nd Ed., pp. 200-201.\n\n            // SE: changed the comment part of the regex\n\n            var regex = /(<[a-z\\/!$](\"[^\"]*\"|'[^']*'|[^'\">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;\n\n            text = text.replace(regex, function (wholeMatch) {\n                var tag = wholeMatch.replace(/(.)<\\/?code>(?=.)/g, \"$1`\");\n                tag = escapeCharacters(tag, wholeMatch.charAt(1) == \"!\" ? \"\\\\`*_/\" : \"\\\\`*_\"); // also escape slashes in comments to prevent autolinking there -- http://meta.stackoverflow.com/questions/95987\n                return tag;\n            });\n\n            return text;\n        }\n\n        function _DoAnchors(text) {\n            //\n            // Turn Markdown link shortcuts into XHTML <a> tags.\n            //\n            //\n            // First, handle reference-style links: [link text] [id]\n            //\n\n            /*\n            text = text.replace(/\n                (                           // wrap whole match in $1\n                    \\[\n                    (\n                        (?:\n                            \\[[^\\]]*\\]      // allow brackets nested one level\n                            |\n                            [^\\[]           // or anything else\n                        )*\n                    )\n                    \\]\n\n                    [ ]?                    // one optional space\n                    (?:\\n[ ]*)?             // one optional newline followed by spaces\n\n                    \\[\n                    (.*?)                   // id = $3\n                    \\]\n                )\n                ()()()()                    // pad remaining backreferences\n            /g, writeAnchorTag);\n            */\n            text = text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g, writeAnchorTag);\n\n            //\n            // Next, inline-style links: [link text](url \"optional title\")\n            //\n\n            /*\n            text = text.replace(/\n                (                           // wrap whole match in $1\n                    \\[\n                    (\n                        (?:\n                            \\[[^\\]]*\\]      // allow brackets nested one level\n                            |\n                            [^\\[\\]]         // or anything else\n                        )*\n                    )\n                    \\]\n                    \\(                      // literal paren\n                    [ \\t]*\n                    ()                      // no id, so leave $3 empty\n                    <?(                     // href = $4\n                        (?:\n                            \\([^)]*\\)       // allow one level of (correctly nested) parens (think MSDN)\n                            |\n                            [^()\\s]\n                        )*?\n                    )>?                \n                    [ \\t]*\n                    (                       // $5\n                        (['\"])              // quote char = $6\n                        (.*?)               // Title = $7\n                        \\6                  // matching quote\n                        [ \\t]*              // ignore any spaces/tabs between closing quote and )\n                    )?                      // title is optional\n                    \\)\n                )\n            /g, writeAnchorTag);\n            */\n\n            text = text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\]\\([ \\t]*()<?((?:\\([^)]*\\)|[^()\\s])*?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g, writeAnchorTag);\n\n            //\n            // Last, handle reference-style shortcuts: [link text]\n            // These must come last in case you've also got [link test][1]\n            // or [link test](/foo)\n            //\n\n            /*\n            text = text.replace(/\n                (                   // wrap whole match in $1\n                    \\[\n                    ([^\\[\\]]+)      // link text = $2; can't contain '[' or ']'\n                    \\]\n                )\n                ()()()()()          // pad rest of backreferences\n            /g, writeAnchorTag);\n            */\n            text = text.replace(/(\\[([^\\[\\]]+)\\])()()()()()/g, writeAnchorTag);\n\n            return text;\n        }\n\n        function writeAnchorTag(wholeMatch, m1, m2, m3, m4, m5, m6, m7) {\n            if (m7 == undefined) m7 = \"\";\n            var whole_match = m1;\n            var link_text = m2.replace(/:\\/\\//g, \"~P\"); // to prevent auto-linking withing the link. will be converted back after the auto-linker runs\n            var link_id = m3.toLowerCase();\n            var url = m4;\n            var title = m7;\n\n            if (url == \"\") {\n                if (link_id == \"\") {\n                    // lower-case and turn embedded newlines into spaces\n                    link_id = link_text.toLowerCase().replace(/ ?\\n/g, \" \");\n                }\n                url = \"#\" + link_id;\n\n                if (g_urls.get(link_id) != undefined) {\n                    url = g_urls.get(link_id);\n                    if (g_titles.get(link_id) != undefined) {\n                        title = g_titles.get(link_id);\n                    }\n                }\n                else {\n                    if (whole_match.search(/\\(\\s*\\)$/m) > -1) {\n                        // Special case for explicit empty url\n                        url = \"\";\n                    } else {\n                        return whole_match;\n                    }\n                }\n            }\n            url = encodeProblemUrlChars(url);\n            url = escapeCharacters(url, \"*_\");\n            var result = \"<a href=\\\"\" + url + \"\\\"\";\n\n            if (title != \"\") {\n                title = attributeEncode(title);\n                title = escapeCharacters(title, \"*_\");\n                result += \" title=\\\"\" + title + \"\\\"\";\n            }\n\n            result += \">\" + link_text + \"</a>\";\n\n            return result;\n        }\n\n        function _DoImages(text) {\n            //\n            // Turn Markdown image shortcuts into <img> tags.\n            //\n\n            //\n            // First, handle reference-style labeled images: ![alt text][id]\n            //\n\n            /*\n            text = text.replace(/\n                (                   // wrap whole match in $1\n                    !\\[\n                    (.*?)           // alt text = $2\n                    \\]\n\n                    [ ]?            // one optional space\n                    (?:\\n[ ]*)?     // one optional newline followed by spaces\n\n                    \\[\n                    (.*?)           // id = $3\n                    \\]\n                )\n                ()()()()            // pad rest of backreferences\n            /g, writeImageTag);\n            */\n            text = text.replace(/(!\\[(.*?)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g, writeImageTag);\n\n            //\n            // Next, handle inline images:  ![alt text](url \"optional title\")\n            // Don't forget: encode * and _\n\n            /*\n            text = text.replace(/\n                (                   // wrap whole match in $1\n                    !\\[\n                    (.*?)           // alt text = $2\n                    \\]\n                    \\s?             // One optional whitespace character\n                    \\(              // literal paren\n                    [ \\t]*\n                    ()              // no id, so leave $3 empty\n                    <?(\\S+?)>?      // src url = $4\n                    [ \\t]*\n                    (               // $5\n                        (['\"])      // quote char = $6\n                        (.*?)       // title = $7\n                        \\6          // matching quote\n                        [ \\t]*\n                    )?              // title is optional\n                    \\)\n                )\n            /g, writeImageTag);\n            */\n            text = text.replace(/(!\\[(.*?)\\]\\s?\\([ \\t]*()<?(\\S+?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g, writeImageTag);\n\n            return text;\n        }\n        \n        function attributeEncode(text) {\n            // unconditionally replace angle brackets here -- what ends up in an attribute (e.g. alt or title)\n            // never makes sense to have verbatim HTML in it (and the sanitizer would totally break it)\n            return text.replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\").replace(/\"/g, \"&quot;\");\n        }\n\n        function writeImageTag(wholeMatch, m1, m2, m3, m4, m5, m6, m7) {\n            var whole_match = m1;\n            var alt_text = m2;\n            var link_id = m3.toLowerCase();\n            var url = m4;\n            var title = m7;\n\n            if (!title) title = \"\";\n\n            if (url == \"\") {\n                if (link_id == \"\") {\n                    // lower-case and turn embedded newlines into spaces\n                    link_id = alt_text.toLowerCase().replace(/ ?\\n/g, \" \");\n                }\n                url = \"#\" + link_id;\n\n                if (g_urls.get(link_id) != undefined) {\n                    url = g_urls.get(link_id);\n                    if (g_titles.get(link_id) != undefined) {\n                        title = g_titles.get(link_id);\n                    }\n                }\n                else {\n                    return whole_match;\n                }\n            }\n            \n            alt_text = escapeCharacters(attributeEncode(alt_text), \"*_[]()\");\n            url = escapeCharacters(url, \"*_\");\n            var result = \"<img src=\\\"\" + url + \"\\\" alt=\\\"\" + alt_text + \"\\\"\";\n\n            // attacklab: Markdown.pl adds empty title attributes to images.\n            // Replicate this bug.\n\n            //if (title != \"\") {\n            title = attributeEncode(title);\n            title = escapeCharacters(title, \"*_\");\n            result += \" title=\\\"\" + title + \"\\\"\";\n            //}\n\n            result += \" />\";\n\n            return result;\n        }\n\n        function _DoHeaders(text) {\n\n            // Setext-style headers:\n            //  Header 1\n            //  ========\n            //  \n            //  Header 2\n            //  --------\n            //\n            text = text.replace(/^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,\n                function (wholeMatch, m1) { return \"<h1>\" + _RunSpanGamut(m1) + \"</h1>\\n\\n\"; }\n            );\n\n            text = text.replace(/^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm,\n                function (matchFound, m1) { return \"<h2>\" + _RunSpanGamut(m1) + \"</h2>\\n\\n\"; }\n            );\n\n            // atx-style headers:\n            //  # Header 1\n            //  ## Header 2\n            //  ## Header 2 with closing hashes ##\n            //  ...\n            //  ###### Header 6\n            //\n\n            /*\n            text = text.replace(/\n                ^(\\#{1,6})      // $1 = string of #'s\n                [ \\t]*\n                (.+?)           // $2 = Header text\n                [ \\t]*\n                \\#*             // optional closing #'s (not counted)\n                \\n+\n            /gm, function() {...});\n            */\n\n            text = text.replace(/^(\\#{1,6})[ \\t]*(.+?)[ \\t]*\\#*\\n+/gm,\n                function (wholeMatch, m1, m2) {\n                    var h_level = m1.length;\n                    return \"<h\" + h_level + \">\" + _RunSpanGamut(m2) + \"</h\" + h_level + \">\\n\\n\";\n                }\n            );\n\n            return text;\n        }\n\n        function _DoLists(text, isInsideParagraphlessListItem) {\n            //\n            // Form HTML ordered (numbered) and unordered (bulleted) lists.\n            //\n\n            // attacklab: add sentinel to hack around khtml/safari bug:\n            // http://bugs.webkit.org/show_bug.cgi?id=11231\n            text += \"~0\";\n\n            // Re-usable pattern to match any entirel ul or ol list:\n\n            /*\n            var whole_list = /\n                (                                   // $1 = whole list\n                    (                               // $2\n                        [ ]{0,3}                    // attacklab: g_tab_width - 1\n                        ([*+-]|\\d+[.])              // $3 = first list item marker\n                        [ \\t]+\n                    )\n                    [^\\r]+?\n                    (                               // $4\n                        ~0                          // sentinel for workaround; should be $\n                        |\n                        \\n{2,}\n                        (?=\\S)\n                        (?!                         // Negative lookahead for another list item marker\n                            [ \\t]*\n                            (?:[*+-]|\\d+[.])[ \\t]+\n                        )\n                    )\n                )\n            /g\n            */\n            var whole_list = /^(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;\n\n            if (g_list_level) {\n                text = text.replace(whole_list, function (wholeMatch, m1, m2) {\n                    var list = m1;\n                    var list_type = (m2.search(/[*+-]/g) > -1) ? \"ul\" : \"ol\";\n\n                    var result = _ProcessListItems(list, list_type, isInsideParagraphlessListItem);\n\n                    // Trim any trailing whitespace, to put the closing `</$list_type>`\n                    // up on the preceding line, to get it past the current stupid\n                    // HTML block parser. This is a hack to work around the terrible\n                    // hack that is the HTML block parser.\n                    result = result.replace(/\\s+$/, \"\");\n                    result = \"<\" + list_type + \">\" + result + \"</\" + list_type + \">\\n\";\n                    return result;\n                });\n            } else {\n                whole_list = /(\\n\\n|^\\n?)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/g;\n                text = text.replace(whole_list, function (wholeMatch, m1, m2, m3) {\n                    var runup = m1;\n                    var list = m2;\n\n                    var list_type = (m3.search(/[*+-]/g) > -1) ? \"ul\" : \"ol\";\n                    var result = _ProcessListItems(list, list_type);\n                    result = runup + \"<\" + list_type + \">\\n\" + result + \"</\" + list_type + \">\\n\";\n                    return result;\n                });\n            }\n\n            // attacklab: strip sentinel\n            text = text.replace(/~0/, \"\");\n\n            return text;\n        }\n\n        var _listItemMarkers = { ol: \"\\\\d+[.]\", ul: \"[*+-]\" };\n\n        function _ProcessListItems(list_str, list_type, isInsideParagraphlessListItem) {\n            //\n            //  Process the contents of a single ordered or unordered list, splitting it\n            //  into individual list items.\n            //\n            //  list_type is either \"ul\" or \"ol\".\n\n            // The $g_list_level global keeps track of when we're inside a list.\n            // Each time we enter a list, we increment it; when we leave a list,\n            // we decrement. If it's zero, we're not in a list anymore.\n            //\n            // We do this because when we're not inside a list, we want to treat\n            // something like this:\n            //\n            //    I recommend upgrading to version\n            //    8. Oops, now this line is treated\n            //    as a sub-list.\n            //\n            // As a single paragraph, despite the fact that the second line starts\n            // with a digit-period-space sequence.\n            //\n            // Whereas when we're inside a list (or sub-list), that line will be\n            // treated as the start of a sub-list. What a kludge, huh? This is\n            // an aspect of Markdown's syntax that's hard to parse perfectly\n            // without resorting to mind-reading. Perhaps the solution is to\n            // change the syntax rules such that sub-lists must start with a\n            // starting cardinal number; e.g. \"1.\" or \"a.\".\n\n            g_list_level++;\n\n            // trim trailing blank lines:\n            list_str = list_str.replace(/\\n{2,}$/, \"\\n\");\n\n            // attacklab: add sentinel to emulate \\z\n            list_str += \"~0\";\n\n            // In the original attacklab showdown, list_type was not given to this function, and anything\n            // that matched /[*+-]|\\d+[.]/ would just create the next <li>, causing this mismatch:\n            //\n            //  Markdown          rendered by WMD        rendered by MarkdownSharp\n            //  ------------------------------------------------------------------\n            //  1. first          1. first               1. first\n            //  2. second         2. second              2. second\n            //  - third           3. third                   * third\n            //\n            // We changed this to behave identical to MarkdownSharp. This is the constructed RegEx,\n            // with {MARKER} being one of \\d+[.] or [*+-], depending on list_type:\n        \n            /*\n            list_str = list_str.replace(/\n                (^[ \\t]*)                       // leading whitespace = $1\n                ({MARKER}) [ \\t]+               // list marker = $2\n                ([^\\r]+?                        // list item text   = $3\n                    (\\n+)\n                )\n                (?=\n                    (~0 | \\2 ({MARKER}) [ \\t]+)\n                )\n            /gm, function(){...});\n            */\n\n            var marker = _listItemMarkers[list_type];\n            var re = new RegExp(\"(^[ \\\\t]*)(\" + marker + \")[ \\\\t]+([^\\\\r]+?(\\\\n+))(?=(~0|\\\\1(\" + marker + \")[ \\\\t]+))\", \"gm\");\n            var last_item_had_a_double_newline = false;\n            list_str = list_str.replace(re,\n                function (wholeMatch, m1, m2, m3) {\n                    var item = m3;\n                    var leading_space = m1;\n                    var ends_with_double_newline = /\\n\\n$/.test(item);\n                    var contains_double_newline = ends_with_double_newline || item.search(/\\n{2,}/) > -1;\n\n                    if (contains_double_newline || last_item_had_a_double_newline) {\n                        item = _RunBlockGamut(_Outdent(item), /* doNotUnhash = */true);\n                    }\n                    else {\n                        // Recursion for sub-lists:\n                        item = _DoLists(_Outdent(item), /* isInsideParagraphlessListItem= */ true);\n                        item = item.replace(/\\n$/, \"\"); // chomp(item)\n                        if (!isInsideParagraphlessListItem) // only the outer-most item should run this, otherwise it's run multiple times for the inner ones\n                            item = _RunSpanGamut(item);\n                    }\n                    last_item_had_a_double_newline = ends_with_double_newline;\n                    return \"<li>\" + item + \"</li>\\n\";\n                }\n            );\n\n            // attacklab: strip sentinel\n            list_str = list_str.replace(/~0/g, \"\");\n\n            g_list_level--;\n            return list_str;\n        }\n\n        function _DoCodeBlocks(text) {\n            //\n            //  Process Markdown `<pre><code>` blocks.\n            //  \n\n            /*\n            text = text.replace(/\n                (?:\\n\\n|^)\n                (                               // $1 = the code block -- one or more lines, starting with a space/tab\n                    (?:\n                        (?:[ ]{4}|\\t)           // Lines must start with a tab or a tab-width of spaces - attacklab: g_tab_width\n                        .*\\n+\n                    )+\n                )\n                (\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))    // attacklab: g_tab_width\n            /g ,function(){...});\n            */\n\n            // attacklab: sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\n            text += \"~0\";\n\n            text = text.replace(/(?:\\n\\n|^\\n?)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))/g,\n                function (wholeMatch, m1, m2) {\n                    var codeblock = m1;\n                    var nextChar = m2;\n\n                    codeblock = _EncodeCode(_Outdent(codeblock));\n                    codeblock = _Detab(codeblock);\n                    codeblock = codeblock.replace(/^\\n+/g, \"\"); // trim leading newlines\n                    codeblock = codeblock.replace(/\\n+$/g, \"\"); // trim trailing whitespace\n\n                    codeblock = \"<pre><code>\" + codeblock + \"\\n</code></pre>\";\n\n                    return \"\\n\\n\" + codeblock + \"\\n\\n\" + nextChar;\n                }\n            );\n\n            // attacklab: strip sentinel\n            text = text.replace(/~0/, \"\");\n\n            return text;\n        }\n\n        function hashBlock(text) {\n            text = text.replace(/(^\\n+|\\n+$)/g, \"\");\n            return \"\\n\\n~K\" + (g_html_blocks.push(text) - 1) + \"K\\n\\n\";\n        }\n\n        function _DoCodeSpans(text) {\n            //\n            // * Backtick quotes are used for <code></code> spans.\n            // \n            // * You can use multiple backticks as the delimiters if you want to\n            //   include literal backticks in the code span. So, this input:\n            //     \n            //      Just type ``foo `bar` baz`` at the prompt.\n            //     \n            //   Will translate to:\n            //     \n            //      <p>Just type <code>foo `bar` baz</code> at the prompt.</p>\n            //     \n            //   There's no arbitrary limit to the number of backticks you\n            //   can use as delimters. If you need three consecutive backticks\n            //   in your code, use four for delimiters, etc.\n            //\n            // * You can use spaces to get literal backticks at the edges:\n            //     \n            //      ... type `` `bar` `` ...\n            //     \n            //   Turns to:\n            //     \n            //      ... type <code>`bar`</code> ...\n            //\n\n            /*\n            text = text.replace(/\n                (^|[^\\\\])       // Character before opening ` can't be a backslash\n                (`+)            // $2 = Opening run of `\n                (               // $3 = The code block\n                    [^\\r]*?\n                    [^`]        // attacklab: work around lack of lookbehind\n                )\n                \\2              // Matching closer\n                (?!`)\n            /gm, function(){...});\n            */\n\n            text = text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,\n                function (wholeMatch, m1, m2, m3, m4) {\n                    var c = m3;\n                    c = c.replace(/^([ \\t]*)/g, \"\"); // leading whitespace\n                    c = c.replace(/[ \\t]*$/g, \"\"); // trailing whitespace\n                    c = _EncodeCode(c);\n                    c = c.replace(/:\\/\\//g, \"~P\"); // to prevent auto-linking. Not necessary in code *blocks*, but in code spans. Will be converted back after the auto-linker runs.\n                    return m1 + \"<code>\" + c + \"</code>\";\n                }\n            );\n\n            return text;\n        }\n\n        function _EncodeCode(text) {\n            //\n            // Encode/escape certain characters inside Markdown code runs.\n            // The point is that in code, these characters are literals,\n            // and lose their special Markdown meanings.\n            //\n            // Encode all ampersands; HTML entities are not\n            // entities within a Markdown code span.\n            text = text.replace(/&/g, \"&amp;\");\n\n            // Do the angle bracket song and dance:\n            text = text.replace(/</g, \"&lt;\");\n            text = text.replace(/>/g, \"&gt;\");\n\n            // Now, escape characters that are magic in Markdown:\n            text = escapeCharacters(text, \"\\*_{}[]\\\\\", false);\n\n            // jj the line above breaks this:\n            //---\n\n            //* Item\n\n            //   1. Subitem\n\n            //            special char: *\n            //---\n\n            return text;\n        }\n\n        function _DoItalicsAndBold(text) {\n\n            // <strong> must go first:\n            text = text.replace(/([\\W_]|^)(\\*\\*|__)(?=\\S)([^\\r]*?\\S[\\*_]*)\\2([\\W_]|$)/g,\n            \"$1<strong>$3</strong>$4\");\n\n            text = text.replace(/([\\W_]|^)(\\*|_)(?=\\S)([^\\r\\*_]*?\\S)\\2([\\W_]|$)/g,\n            \"$1<em>$3</em>$4\");\n\n            return text;\n        }\n\n        function _DoBlockQuotes(text) {\n\n            /*\n            text = text.replace(/\n                (                           // Wrap whole match in $1\n                    (\n                        ^[ \\t]*>[ \\t]?      // '>' at the start of a line\n                        .+\\n                // rest of the first line\n                        (.+\\n)*             // subsequent consecutive lines\n                        \\n*                 // blanks\n                    )+\n                )\n            /gm, function(){...});\n            */\n\n            text = text.replace(/((^[ \\t]*>[ \\t]?.+\\n(.+\\n)*\\n*)+)/gm,\n                function (wholeMatch, m1) {\n                    var bq = m1;\n\n                    // attacklab: hack around Konqueror 3.5.4 bug:\n                    // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n\n                    bq = bq.replace(/^[ \\t]*>[ \\t]?/gm, \"~0\"); // trim one level of quoting\n\n                    // attacklab: clean up hack\n                    bq = bq.replace(/~0/g, \"\");\n\n                    bq = bq.replace(/^[ \\t]+$/gm, \"\");     // trim whitespace-only lines\n                    bq = _RunBlockGamut(bq);             // recurse\n\n                    bq = bq.replace(/(^|\\n)/g, \"$1  \");\n                    // These leading spaces screw with <pre> content, so we need to fix that:\n                    bq = bq.replace(\n                            /(\\s*<pre>[^\\r]+?<\\/pre>)/gm,\n                        function (wholeMatch, m1) {\n                            var pre = m1;\n                            // attacklab: hack around Konqueror 3.5.4 bug:\n                            pre = pre.replace(/^  /mg, \"~0\");\n                            pre = pre.replace(/~0/g, \"\");\n                            return pre;\n                        });\n\n                    return hashBlock(\"<blockquote>\\n\" + bq + \"\\n</blockquote>\");\n                }\n            );\n            return text;\n        }\n\n        function _FormParagraphs(text, doNotUnhash) {\n            //\n            //  Params:\n            //    $text - string to process with html <p> tags\n            //\n\n            // Strip leading and trailing lines:\n            text = text.replace(/^\\n+/g, \"\");\n            text = text.replace(/\\n+$/g, \"\");\n\n            var grafs = text.split(/\\n{2,}/g);\n            var grafsOut = [];\n            \n            var markerRe = /~K(\\d+)K/;\n\n            //\n            // Wrap <p> tags.\n            //\n            var end = grafs.length;\n            for (var i = 0; i < end; i++) {\n                var str = grafs[i];\n\n                // if this is an HTML marker, copy it\n                if (markerRe.test(str)) {\n                    grafsOut.push(str);\n                }\n                else if (/\\S/.test(str)) {\n                    str = _RunSpanGamut(str);\n                    str = str.replace(/^([ \\t]*)/g, \"<p>\");\n                    str += \"</p>\"\n                    grafsOut.push(str);\n                }\n\n            }\n            //\n            // Unhashify HTML blocks\n            //\n            if (!doNotUnhash) {\n                end = grafsOut.length;\n                for (var i = 0; i < end; i++) {\n                    var foundAny = true;\n                    while (foundAny) { // we may need several runs, since the data may be nested\n                        foundAny = false;\n                        grafsOut[i] = grafsOut[i].replace(/~K(\\d+)K/g, function (wholeMatch, id) {\n                            foundAny = true;\n                            return g_html_blocks[id];\n                        });\n                    }\n                }\n            }\n            return grafsOut.join(\"\\n\\n\");\n        }\n\n        function _EncodeAmpsAndAngles(text) {\n            // Smart processing for ampersands and angle brackets that need to be encoded.\n\n            // Ampersand-encoding based entirely on Nat Irons's Amputator MT plugin:\n            //   http://bumppo.net/projects/amputator/\n            text = text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g, \"&amp;\");\n\n            // Encode naked <'s\n            text = text.replace(/<(?![a-z\\/?!]|~D)/gi, \"&lt;\");\n\n            return text;\n        }\n\n        function _EncodeBackslashEscapes(text) {\n            //\n            //   Parameter:  String.\n            //   Returns:    The string, with after processing the following backslash\n            //               escape sequences.\n            //\n\n            // attacklab: The polite way to do this is with the new\n            // escapeCharacters() function:\n            //\n            //     text = escapeCharacters(text,\"\\\\\",true);\n            //     text = escapeCharacters(text,\"`*_{}[]()>#+-.!\",true);\n            //\n            // ...but we're sidestepping its use of the (slow) RegExp constructor\n            // as an optimization for Firefox.  This function gets called a LOT.\n\n            text = text.replace(/\\\\(\\\\)/g, escapeCharacters_callback);\n            text = text.replace(/\\\\([`*_{}\\[\\]()>#+-.!])/g, escapeCharacters_callback);\n            return text;\n        }\n\n        var charInsideUrl = \"[-A-Z0-9+&@#/%?=~_|[\\\\]()!:,.;]\",\n            charEndingUrl = \"[-A-Z0-9+&@#/%=~_|[\\\\])]\",\n            autoLinkRegex = new RegExp(\"(=\\\"|<)?\\\\b(https?|ftp)(://\" + charInsideUrl + \"*\" + charEndingUrl + \")(?=$|\\\\W)\", \"gi\"),\n            endCharRegex = new RegExp(charEndingUrl, \"i\");\n\n        function handleTrailingParens(wholeMatch, lookbehind, protocol, link) {\n            if (lookbehind)\n                return wholeMatch;\n            if (link.charAt(link.length - 1) !== \")\")\n                return \"<\" + protocol + link + \">\";\n            var parens = link.match(/[()]/g);\n            var level = 0;\n            for (var i = 0; i < parens.length; i++) {\n                if (parens[i] === \"(\") {\n                    if (level <= 0)\n                        level = 1;\n                    else\n                        level++;\n                }\n                else {\n                    level--;\n                }\n            }\n            var tail = \"\";\n            if (level < 0) {\n                var re = new RegExp(\"\\\\){1,\" + (-level) + \"}$\");\n                link = link.replace(re, function (trailingParens) {\n                    tail = trailingParens;\n                    return \"\";\n                });\n            }\n            if (tail) {\n                var lastChar = link.charAt(link.length - 1);\n                if (!endCharRegex.test(lastChar)) {\n                    tail = lastChar + tail;\n                    link = link.substr(0, link.length - 1);\n                }\n            }\n            return \"<\" + protocol + link + \">\" + tail;\n        }\n        \n        function _DoAutoLinks(text) {\n\n            // note that at this point, all other URL in the text are already hyperlinked as <a href=\"\"></a>\n            // *except* for the <http://www.foo.com> case\n\n            // automatically add < and > around unadorned raw hyperlinks\n            // must be preceded by a non-word character (and not by =\" or <) and followed by non-word/EOF character\n            // simulating the lookbehind in a consuming way is okay here, since a URL can neither and with a \" nor\n            // with a <, so there is no risk of overlapping matches.\n            text = text.replace(autoLinkRegex, handleTrailingParens);\n\n            //  autolink anything like <http://example.com>\n            \n            var replacer = function (wholematch, m1) { return \"<a href=\\\"\" + m1 + \"\\\">\" + pluginHooks.plainLinkText(m1) + \"</a>\"; }\n            text = text.replace(/<((https?|ftp):[^'\">\\s]+)>/gi, replacer);\n\n            // Email addresses: <address@domain.foo>\n            /*\n            text = text.replace(/\n                <\n                (?:mailto:)?\n                (\n                    [-.\\w]+\n                    \\@\n                    [-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+\n                )\n                >\n            /gi, _DoAutoLinks_callback());\n            */\n\n            /* disabling email autolinking, since we don't do that on the server, either\n            text = text.replace(/<(?:mailto:)?([-.\\w]+\\@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi,\n                function(wholeMatch,m1) {\n                    return _EncodeEmailAddress( _UnescapeSpecialChars(m1) );\n                }\n            );\n            */\n            return text;\n        }\n\n        function _UnescapeSpecialChars(text) {\n            //\n            // Swap back in all the special characters we've hidden.\n            //\n            text = text.replace(/~E(\\d+)E/g,\n                function (wholeMatch, m1) {\n                    var charCodeToReplace = parseInt(m1);\n                    return String.fromCharCode(charCodeToReplace);\n                }\n            );\n            return text;\n        }\n\n        function _Outdent(text) {\n            //\n            // Remove one level of line-leading tabs or spaces\n            //\n\n            // attacklab: hack around Konqueror 3.5.4 bug:\n            // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n\n            text = text.replace(/^(\\t|[ ]{1,4})/gm, \"~0\"); // attacklab: g_tab_width\n\n            // attacklab: clean up hack\n            text = text.replace(/~0/g, \"\")\n\n            return text;\n        }\n\n        function _Detab(text) {\n            if (!/\\t/.test(text))\n                return text;\n\n            var spaces = [\"    \", \"   \", \"  \", \" \"],\n            skew = 0,\n            v;\n\n            return text.replace(/[\\n\\t]/g, function (match, offset) {\n                if (match === \"\\n\") {\n                    skew = offset + 1;\n                    return match;\n                }\n                v = (offset - skew) % 4;\n                skew = offset + 1;\n                return spaces[v];\n            });\n        }\n\n        //\n        //  attacklab: Utility functions\n        //\n\n        var _problemUrlChars = /(?:[\"'*()[\\]:]|~D)/g;\n\n        // hex-encodes some unusual \"problem\" chars in URLs to avoid URL detection problems \n        function encodeProblemUrlChars(url) {\n            if (!url)\n                return \"\";\n\n            var len = url.length;\n\n            return url.replace(_problemUrlChars, function (match, offset) {\n                if (match == \"~D\") // escape for dollar\n                    return \"%24\";\n                if (match == \":\") {\n                    //if (offset == len - 1 || /[0-9\\/]/.test(url.charAt(offset + 1)))\n                        return \":\"\n                }\n                return \"%\" + match.charCodeAt(0).toString(16);\n            });\n        }\n\n\n        function escapeCharacters(text, charsToEscape, afterBackslash) {\n            // First we have to escape the escape characters so that\n            // we can build a character class out of them\n            var regexString = \"([\" + charsToEscape.replace(/([\\[\\]\\\\])/g, \"\\\\$1\") + \"])\";\n\n            if (afterBackslash) {\n                regexString = \"\\\\\\\\\" + regexString;\n            }\n\n            var regex = new RegExp(regexString, \"g\");\n            text = text.replace(regex, escapeCharacters_callback);\n\n            return text;\n        }\n\n\n        function escapeCharacters_callback(wholeMatch, m1) {\n            var charCodeToEscape = m1.charCodeAt(0);\n            return \"~E\" + charCodeToEscape + \"E\";\n        }\n\n    }; // end of the Markdown.Converter constructor\n\n})();\n\nexport default Markdown\n","/* eslint-disable */\n\nimport Markdown from './Markdown.Converter'\nimport CodeMirror from 'codemirror'\nimport { baseApiUrl } from '../config/constants'\n\n// needs Markdown.Converter.js at the moment\n;(function() {\n\tvar util = {},\n\t\tposition = {},\n\t\tui = {},\n\t\tdoc = window.document,\n\t\tre = window.RegExp,\n\t\tnav = window.navigator,\n\t\tSETTINGS = { lineLength: 72 },\n\t\t// Used to work around some browser bugs where we can't use feature testing.\n\t\tuaSniffed = {\n\t\t\tisIE: /msie/.test(nav.userAgent.toLowerCase()),\n\t\t\tisIE_5or6: /msie 6/.test(nav.userAgent.toLowerCase()) || /msie 5/.test(nav.userAgent.toLowerCase()),\n\t\t\tisOpera: /opera/.test(nav.userAgent.toLowerCase()),\n\t\t\tisMac: (/AppleWebKit/.test(nav.userAgent) && /Mobile\\/\\w+/.test(nav.userAgent)) || /Mac/.test(nav.platform),\n\t\t}\n\n\tvar defaultsStrings = {\n\t\tbold: 'Strong <strong>',\n\t\tboldexample: 'strong text',\n\n\t\titalic: 'Emphasis <em>',\n\t\titalicexample: 'emphasized text',\n\n\t\tlink: 'Hyperlink <a>',\n\t\tlinkdescription: 'enter link description here',\n\t\tlinkdialog: '<p><b>Insert Hyperlink</b></p>',\n\n\t\tquote: 'Blockquote <blockquote>',\n\t\tquoteexample: 'Blockquote',\n\n\t\tcode: 'Code Sample <pre><code>',\n\t\tcodeexample: 'enter code here',\n\n\t\timage: 'Image <img>',\n\t\timagedescription: 'enter image description here',\n\t\timagedialog: '<p><b>Insert Image</b></p>',\n\n\t\tolist: 'Numbered List <ol>',\n\t\tulist: 'Bulleted List <ul>',\n\t\tlitem: 'List item',\n\n\t\theading: 'Heading <h1>/<h2>',\n\t\theadingexample: 'Heading',\n\n\t\thr: 'Horizontal Rule <hr>',\n\n\t\ttable: 'Table <table>',\n\n\t\tundo: 'Undo -',\n\t\tredo: 'Redo -',\n\n\t\thelp: 'Markdown Editing Help',\n\t}\n\n\tvar keyStrokes = {\n\t\tbold: {\n\t\t\twin: 'Ctrl-B',\n\t\t\tmac: 'Command-B|Ctrl-B',\n\t\t},\n\t\titalic: {\n\t\t\twin: 'Ctrl-I',\n\t\t\tmac: 'Command-I|Ctrl-I',\n\t\t},\n\t\tlink: {\n\t\t\twin: 'Ctrl-L',\n\t\t\tmac: 'Command-L|Ctrl-L',\n\t\t},\n\t\tquote: {\n\t\t\twin: 'Ctrl-Q',\n\t\t\tmac: 'Command-Q|Ctrl-Q',\n\t\t},\n\t\tcode: {\n\t\t\twin: 'Ctrl-K',\n\t\t\tmac: 'Command-K|Ctrl-K',\n\t\t},\n\t\timage: {\n\t\t\twin: 'Ctrl-G',\n\t\t\tmac: 'Command-G|Ctrl-G',\n\t\t},\n\t\tolist: {\n\t\t\twin: 'Ctrl-O',\n\t\t\tmac: 'Command-O|Ctrl-O',\n\t\t},\n\t\tulist: {\n\t\t\twin: 'Ctrl-U',\n\t\t\tmac: 'Command-U|Ctrl-U',\n\t\t},\n\t\theading: {\n\t\t\twin: 'Ctrl-H',\n\t\t\tmac: 'Command-H|Ctrl-H',\n\t\t},\n\t\thr: {\n\t\t\twin: 'Ctrl-R',\n\t\t\tmac: 'Command-R|Ctrl-R',\n\t\t},\n\t\ttable: {\n\t\t\twin: 'Ctrl-T',\n\t\t\tmac: 'Command-T|Ctrl-T',\n\t\t},\n\t\tundo: {\n\t\t\twin: 'Ctrl-Z',\n\t\t\tmac: 'Command-Z',\n\t\t},\n\t\tredo: {\n\t\t\twin: 'Ctrl-Y|Ctrl-Shift-Z',\n\t\t\tmac: 'Command-Y|Command-Shift-Z',\n\t\t},\n\t}\n\n\t// -------------------------------------------------------------------\n\t//  YOUR CHANGES GO HERE\n\t//\n\t// I've tried to localize the things you are likely to change to\n\t// this area.\n\t// -------------------------------------------------------------------\n\n\t// The default text that appears in the dialog input box when entering\n\t// links.\n\tvar imageDefaultText = 'http://'\n\tvar linkDefaultText = 'http://'\n\n\t// -------------------------------------------------------------------\n\t//  END OF YOUR CHANGES\n\t// -------------------------------------------------------------------\n\n\t// options, if given, can have the following properties:\n\t//   options.helpButton = { handler: yourEventHandler }\n\t//   options.strings = { italicexample: \"slanted text\" }\n\t// `yourEventHandler` is the click handler for the help button.\n\t// If `options.helpButton` isn't given, not help button is created.\n\t// `options.strings` can have any or all of the same properties as\n\t// `defaultStrings` above, so you can just override some string displayed\n\t// to the user on a case-by-case basis, or translate all strings to\n\t// a different language.\n\t//\n\t// For backwards compatibility reasons, the `options` argument can also\n\t// be just the `helpButton` object, and `strings.help` can also be set via\n\t// `helpButton.title`. This should be considered legacy.\n\t//\n\t// The constructed editor object has the methods:\n\t// - getConverter() returns the markdown converter object that was passed to the constructor\n\t// - run() actually starts the editor; should be called after all necessary plugins are registered. Calling this more than once is a no-op.\n\t// - refreshPreview() forces the preview to be updated. This method is only available after run() was called.\n\tMarkdown.Editor = function(markdownConverter, idPostfix, options) {\n\t\toptions = options || {}\n\n\t\tif (typeof options.handler === 'function') {\n\t\t\t//backwards compatible behavior\n\t\t\toptions = { helpButton: options }\n\t\t}\n\t\toptions.strings = options.strings || {}\n\t\tif (options.helpButton) {\n\t\t\toptions.strings.help = options.strings.help || options.helpButton.title\n\t\t}\n\t\t// Override default keystrokes\n\t\tif (options.keyStrokes) {\n\t\t\tfor (var key in options.keyStrokes) {\n\t\t\t\tkeyStrokes[key] = options.keyStrokes[key]\n\t\t\t}\n\t\t}\n\t\tvar getString = function(identifier) {\n\t\t\treturn options.strings[identifier] || defaultsStrings[identifier]\n\t\t}\n\n\t\tidPostfix = idPostfix || ''\n\n\t\tvar hooks = (this.hooks = new Markdown.HookCollection())\n\t\thooks.addNoop('onPreviewRefresh') // called with no arguments after the preview has been refreshed\n\t\thooks.addNoop('postBlockquoteCreation') // called with the user's selection *after* the blockquote was created; should return the actual to-be-inserted text\n\t\thooks.addFalse('insertImageDialog')\n\t\t/* called with one parameter: a callback to be called with the URL of the image. If the application creates\n\t\t * its own image insertion dialog, this hook should return true, and the callback should be called with the chosen\n\t\t * image url (or null if the user cancelled). If this hook returns false, the default dialog will be used.\n\t\t */\n\t\thooks.addFalse('insertLinkDialog')\n\n\t\tthis.getConverter = function() {\n\t\t\treturn markdownConverter\n\t\t}\n\n\t\tvar that = this,\n\t\t\tpanels\n\n\t\tvar undoManager\n\t\tthis.run = function(cm, previewWrapper) {\n\t\t\tif (panels) return // already initialized\n\n\t\t\tpanels = new PanelCollection(idPostfix, cm)\n\t\t\tvar commandManager = new CommandManager(hooks, getString)\n\t\t\tvar previewManager = new PreviewManager(\n\t\t\t\tmarkdownConverter,\n\t\t\t\tpanels,\n\t\t\t\tfunction() {\n\t\t\t\t\thooks.onPreviewRefresh()\n\t\t\t\t},\n\t\t\t\tpreviewWrapper\n\t\t\t)\n\t\t\tvar uiManager\n\n\t\t\t/*benweet\n            if (!/\\?noundo/.test(doc.location.href)) {\n                undoManager = new UndoManager(function () {\n                    previewManager.refresh();\n                    if (uiManager) // not available on the first call\n                        uiManager.setUndoRedoButtonStates();\n                }, panels);\n                this.textOperation = function (f) {\n                    undoManager.setCommandMode();\n                    f();\n                    that.refreshPreview();\n                }\n            }\n            */\n\n\t\t\tvar getKey = function(identifier) {\n\t\t\t\treturn keyStrokes[identifier][uaSniffed.isMac ? 'mac' : 'win'].split('|').join(' ')\n\t\t\t}\n\t\t\tuiManager = new UIManager(\n\t\t\t\tidPostfix,\n\t\t\t\tpanels,\n\t\t\t\tundoManager,\n\t\t\t\tpreviewManager,\n\t\t\t\tcommandManager,\n\t\t\t\toptions.helpButton,\n\t\t\t\tgetString,\n\t\t\t\tgetKey\n\t\t\t)\n\t\t\tuiManager.setUndoRedoButtonStates()\n\n\t\t\tvar forceRefresh = (that.refreshPreview = function() {\n\t\t\t\tpreviewManager.refresh(true)\n\t\t\t})\n\n\t\t\tforceRefresh()\n\t\t\tthat.uiManager = uiManager\n\t\t}\n\t}\n\n\t// before: contains all the text in the input box BEFORE the selection.\n\t// after: contains all the text in the input box AFTER the selection.\n\tfunction Chunks() {}\n\n\t// startRegex: a regular expression to find the start tag\n\t// endRegex: a regular expresssion to find the end tag\n\tChunks.prototype.findTags = function(startRegex, endRegex) {\n\t\tvar chunkObj = this\n\t\tvar regex\n\n\t\tif (startRegex) {\n\t\t\tregex = util.extendRegExp(startRegex, '', '$')\n\n\t\t\tthis.before = this.before.replace(regex, function(match) {\n\t\t\t\tchunkObj.startTag = chunkObj.startTag + match\n\t\t\t\treturn ''\n\t\t\t})\n\n\t\t\tregex = util.extendRegExp(startRegex, '^', '')\n\n\t\t\tthis.selection = this.selection.replace(regex, function(match) {\n\t\t\t\tchunkObj.startTag = chunkObj.startTag + match\n\t\t\t\treturn ''\n\t\t\t})\n\t\t}\n\n\t\tif (endRegex) {\n\t\t\tregex = util.extendRegExp(endRegex, '', '$')\n\n\t\t\tthis.selection = this.selection.replace(regex, function(match) {\n\t\t\t\tchunkObj.endTag = match + chunkObj.endTag\n\t\t\t\treturn ''\n\t\t\t})\n\n\t\t\tregex = util.extendRegExp(endRegex, '^', '')\n\n\t\t\tthis.after = this.after.replace(regex, function(match) {\n\t\t\t\tchunkObj.endTag = match + chunkObj.endTag\n\t\t\t\treturn ''\n\t\t\t})\n\t\t}\n\t}\n\n\t// If remove is false, the whitespace is transferred\n\t// to the before/after regions.\n\t//\n\t// If remove is true, the whitespace disappears.\n\tChunks.prototype.trimWhitespace = function(remove) {\n\t\tvar beforeReplacer,\n\t\t\tafterReplacer,\n\t\t\tthat = this\n\t\tif (remove) {\n\t\t\tbeforeReplacer = afterReplacer = ''\n\t\t} else {\n\t\t\tbeforeReplacer = function(s) {\n\t\t\t\tthat.before += s\n\t\t\t\treturn ''\n\t\t\t}\n\t\t\tafterReplacer = function(s) {\n\t\t\t\tthat.after = s + that.after\n\t\t\t\treturn ''\n\t\t\t}\n\t\t}\n\n\t\tthis.selection = this.selection.replace(/^(\\s*)/, beforeReplacer).replace(/(\\s*)$/, afterReplacer)\n\t}\n\n\tChunks.prototype.skipLines = function(nLinesBefore, nLinesAfter, findExtraNewlines) {\n\t\tif (nLinesBefore === undefined) {\n\t\t\tnLinesBefore = 1\n\t\t}\n\n\t\tif (nLinesAfter === undefined) {\n\t\t\tnLinesAfter = 1\n\t\t}\n\n\t\tnLinesBefore++\n\t\tnLinesAfter++\n\n\t\tvar regexText\n\t\tvar replacementText\n\n\t\t// chrome bug ... documented at: http://meta.stackoverflow.com/questions/63307/blockquote-glitch-in-editor-in-chrome-6-and-7/65985#65985\n\t\tif (navigator.userAgent.match(/Chrome/)) {\n\t\t\t'X'.match(/()./)\n\t\t}\n\n\t\tthis.selection = this.selection.replace(/(^\\n*)/, '')\n\n\t\tthis.startTag = this.startTag + re.$1\n\n\t\tthis.selection = this.selection.replace(/(\\n*$)/, '')\n\t\tthis.endTag = this.endTag + re.$1\n\t\tthis.startTag = this.startTag.replace(/(^\\n*)/, '')\n\t\tthis.before = this.before + re.$1\n\t\tthis.endTag = this.endTag.replace(/(\\n*$)/, '')\n\t\tthis.after = this.after + re.$1\n\n\t\tif (this.before) {\n\t\t\tregexText = replacementText = ''\n\n\t\t\twhile (nLinesBefore--) {\n\t\t\t\tregexText += '\\\\n?'\n\t\t\t\treplacementText += '\\n'\n\t\t\t}\n\n\t\t\tif (findExtraNewlines) {\n\t\t\t\tregexText = '\\\\n*'\n\t\t\t}\n\t\t\tthis.before = this.before.replace(new re(regexText + '$', ''), replacementText)\n\t\t}\n\n\t\tif (this.after) {\n\t\t\tregexText = replacementText = ''\n\n\t\t\twhile (nLinesAfter--) {\n\t\t\t\tregexText += '\\\\n?'\n\t\t\t\treplacementText += '\\n'\n\t\t\t}\n\t\t\tif (findExtraNewlines) {\n\t\t\t\tregexText = '\\\\n*'\n\t\t\t}\n\n\t\t\tthis.after = this.after.replace(new re(regexText, ''), replacementText)\n\t\t}\n\t}\n\n\t// end of Chunks\n\n\t// A collection of the important regions on the page.\n\t// Cached so we don't have to keep traversing the DOM.\n\t// Also holds ieCachedRange and ieCachedScrollTop, where necessary; working around\n\t// this issue:\n\t// Internet explorer has problems with CSS sprite buttons that use HTML\n\t// lists.  When you click on the background image \"button\", IE will\n\t// select the non-existent link text and discard the selection in the\n\t// textarea.  The solution to this is to cache the textarea selection\n\t// on the button's mousedown event and set a flag.  In the part of the\n\t// code where we need to grab the selection, we check for the flag\n\t// and, if it's set, use the cached area instead of querying the\n\t// textarea.\n\t//\n\t// This ONLY affects Internet Explorer (tested on versions 6, 7\n\t// and 8) and ONLY on button clicks.  Keyboard shortcuts work\n\t// normally since the focus never leaves the textarea.\n\tfunction PanelCollection(postfix, cm) {\n\t\tthis.buttonBar = doc.getElementById('wmd-button-bar' + postfix)\n\t\tthis.preview = doc.getElementById('wmd-preview' + postfix)\n\t\tthis.input = cm\n\t}\n\n\t// Returns true if the DOM element is visible, false if it's hidden.\n\t// Checks if display is anything other than none.\n\tutil.isVisible = function(elem) {\n\t\tif (window.getComputedStyle) {\n\t\t\t// Most browsers\n\t\t\treturn window.getComputedStyle(elem, null).getPropertyValue('display') !== 'none'\n\t\t} else if (elem.currentStyle) {\n\t\t\t// IE\n\t\t\treturn elem.currentStyle['display'] !== 'none'\n\t\t}\n\t}\n\n\t// Adds a listener callback to a DOM element which is fired on a specified\n\t// event.\n\tutil.addEvent = function(elem, event, listener) {\n\t\tif (elem.attachEvent) {\n\t\t\t// IE only.  The \"on\" is mandatory.\n\t\t\telem.attachEvent('on' + event, listener)\n\t\t} else {\n\t\t\t// Other browsers.\n\t\t\telem.addEventListener(event, listener, false)\n\t\t}\n\t}\n\n\t// Removes a listener callback from a DOM element which is fired on a specified\n\t// event.\n\tutil.removeEvent = function(elem, event, listener) {\n\t\tif (elem.detachEvent) {\n\t\t\t// IE only.  The \"on\" is mandatory.\n\t\t\telem.detachEvent('on' + event, listener)\n\t\t} else {\n\t\t\t// Other browsers.\n\t\t\telem.removeEventListener(event, listener, false)\n\t\t}\n\t}\n\n\t// Converts \\r\\n and \\r to \\n.\n\tutil.fixEolChars = function(text) {\n\t\ttext = text.replace(/\\r\\n/g, '\\n')\n\t\ttext = text.replace(/\\r/g, '\\n')\n\t\treturn text\n\t}\n\n\t// Extends a regular expression.  Returns a new RegExp\n\t// using pre + regex + post as the expression.\n\t// Used in a few functions where we have a base\n\t// expression and we want to pre- or append some\n\t// conditions to it (e.g. adding \"$\" to the end).\n\t// The flags are unchanged.\n\t//\n\t// regex is a RegExp, pre and post are strings.\n\tutil.extendRegExp = function(regex, pre, post) {\n\t\tif (pre === null || pre === undefined) {\n\t\t\tpre = ''\n\t\t}\n\t\tif (post === null || post === undefined) {\n\t\t\tpost = ''\n\t\t}\n\n\t\tvar pattern = regex.toString()\n\t\tvar flags\n\n\t\t// Replace the flags with empty space and store them.\n\t\tpattern = pattern.replace(/\\/([gim]*)$/, function(wholeMatch, flagsPart) {\n\t\t\tflags = flagsPart\n\t\t\treturn ''\n\t\t})\n\n\t\t// Remove the slash delimiters on the regular expression.\n\t\tpattern = pattern.replace(/(^\\/|\\/$)/g, '')\n\t\tpattern = pre + pattern + post\n\n\t\treturn new re(pattern, flags)\n\t}\n\n\t// UNFINISHED\n\t// The assignment in the while loop makes jslint cranky.\n\t// I'll change it to a better loop later.\n\tposition.getTop = function(elem, isInner) {\n\t\tvar result = elem.offsetTop\n\t\tif (!isInner) {\n\t\t\twhile ((elem = elem.offsetParent)) {\n\t\t\t\tresult += elem.offsetTop\n\t\t\t}\n\t\t}\n\t\treturn result\n\t}\n\n\tposition.getHeight = function(elem) {\n\t\treturn elem.offsetHeight || elem.scrollHeight\n\t}\n\n\tposition.getWidth = function(elem) {\n\t\treturn elem.offsetWidth || elem.scrollWidth\n\t}\n\n\tposition.getPageSize = function() {\n\t\tvar scrollWidth, scrollHeight\n\t\tvar innerWidth, innerHeight\n\n\t\t// It's not very clear which blocks work with which browsers.\n\t\tif (this.innerHeight && this.scrollMaxY) {\n\t\t\tscrollWidth = doc.body.scrollWidth\n\t\t\tscrollHeight = this.innerHeight + this.scrollMaxY\n\t\t} else if (doc.body.scrollHeight > doc.body.offsetHeight) {\n\t\t\tscrollWidth = doc.body.scrollWidth\n\t\t\tscrollHeight = doc.body.scrollHeight\n\t\t} else {\n\t\t\tscrollWidth = doc.body.offsetWidth\n\t\t\tscrollHeight = doc.body.offsetHeight\n\t\t}\n\n\t\tif (this.innerHeight) {\n\t\t\t// Non-IE browser\n\t\t\tinnerWidth = this.innerWidth\n\t\t\tinnerHeight = this.innerHeight\n\t\t} else if (doc.documentElement && doc.documentElement.clientHeight) {\n\t\t\t// Some versions of IE (IE 6 w/ a DOCTYPE declaration)\n\t\t\tinnerWidth = doc.documentElement.clientWidth\n\t\t\tinnerHeight = doc.documentElement.clientHeight\n\t\t} else if (doc.body) {\n\t\t\t// Other versions of IE\n\t\t\tinnerWidth = doc.body.clientWidth\n\t\t\tinnerHeight = doc.body.clientHeight\n\t\t}\n\n\t\tvar maxWidth = Math.max(scrollWidth, innerWidth)\n\t\tvar maxHeight = Math.max(scrollHeight, innerHeight)\n\t\treturn [maxWidth, maxHeight, innerWidth, innerHeight]\n\t}\n\n\t/*benweet\n    // Handles pushing and popping TextareaStates for undo/redo commands.\n    // I should rename the stack variables to list.\n    function UndoManager(callback, panels) {\n\n        var undoObj = this;\n        var undoStack = []; // A stack of undo states\n        var stackPtr = 0; // The index of the current state\n        var mode = \"none\";\n        var lastState; // The last state\n        var timer; // The setTimeout handle for cancelling the timer\n        var inputStateObj;\n\n        // Set the mode for later logic steps.\n        var setMode = function (newMode, noSave) {\n            if (mode != newMode) {\n                mode = newMode;\n                if (!noSave) {\n                    saveState();\n                }\n            }\n\n            if (!uaSniffed.isIE || mode != \"moving\") {\n                timer = setTimeout(refreshState, 1);\n            }\n            else {\n                inputStateObj = null;\n            }\n        };\n\n        var refreshState = function (isInitialState) {\n            inputStateObj = new TextareaState(panels, isInitialState);\n            timer = undefined;\n        };\n\n        this.setCommandMode = function () {\n            mode = \"command\";\n            saveState();\n            timer = setTimeout(refreshState, 0);\n        };\n\n        this.canUndo = function () {\n            return stackPtr > 1;\n        };\n\n        this.canRedo = function () {\n            if (undoStack[stackPtr + 1]) {\n                return true;\n            }\n            return false;\n        };\n\n        // Removes the last state and restores it.\n        this.undo = function () {\n\n            if (undoObj.canUndo()) {\n                if (lastState) {\n                    // What about setting state -1 to null or checking for undefined?\n                    lastState.restore();\n                    lastState = null;\n                }\n                else {\n                    undoStack[stackPtr] = new TextareaState(panels);\n                    undoStack[--stackPtr].restore();\n\n                    if (callback) {\n                        callback();\n                    }\n                }\n            }\n\n            mode = \"none\";\n            panels.input.focus();\n            refreshState();\n        };\n\n        // Redo an action.\n        this.redo = function () {\n\n            if (undoObj.canRedo()) {\n\n                undoStack[++stackPtr].restore();\n\n                if (callback) {\n                    callback();\n                }\n            }\n\n            mode = \"none\";\n            panels.input.focus();\n            refreshState();\n        };\n\n        // Push the input area state to the stack.\n        var saveState = function () {\n            var currState = inputStateObj || new TextareaState(panels);\n\n            if (!currState) {\n                return false;\n            }\n            if (mode == \"moving\") {\n                if (!lastState) {\n                    lastState = currState;\n                }\n                return;\n            }\n            if (lastState) {\n                if (undoStack[stackPtr - 1].text != lastState.text) {\n                    undoStack[stackPtr++] = lastState;\n                }\n                lastState = null;\n            }\n            undoStack[stackPtr++] = currState;\n            undoStack[stackPtr + 1] = null;\n            if (callback) {\n                callback();\n            }\n        };\n\n        var handleCtrlYZ = function (event) {\n\n            var handled = false;\n\n            if ((event.ctrlKey || event.metaKey) && !event.altKey) {\n\n                // IE and Opera do not support charCode.\n                var keyCode = event.charCode || event.keyCode;\n                var keyCodeChar = String.fromCharCode(keyCode);\n\n                switch (keyCodeChar.toLowerCase()) {\n\n                    case \"y\":\n                        undoObj.redo();\n                        handled = true;\n                        break;\n\n                    case \"z\":\n                        if (!event.shiftKey) {\n                            undoObj.undo();\n                        }\n                        else {\n                            undoObj.redo();\n                        }\n                        handled = true;\n                        break;\n                }\n            }\n\n            if (handled) {\n                if (event.preventDefault) {\n                    event.preventDefault();\n                }\n                if (window.event) {\n                    window.event.returnValue = false;\n                }\n                return;\n            }\n        };\n\n        // Set the mode depending on what is going on in the input area.\n        var handleModeChange = function (event) {\n\n            if (!event.ctrlKey && !event.metaKey) {\n\n                var keyCode = event.keyCode;\n\n                if ((keyCode >= 33 && keyCode <= 40) || (keyCode >= 63232 && keyCode <= 63235)) {\n                    // 33 - 40: page up/dn and arrow keys\n                    // 63232 - 63235: page up/dn and arrow keys on safari\n                    setMode(\"moving\");\n                }\n                else if (keyCode == 8 || keyCode == 46 || keyCode == 127) {\n                    // 8: backspace\n                    // 46: delete\n                    // 127: delete\n                    setMode(\"deleting\");\n                }\n                else if (keyCode == 13) {\n                    // 13: Enter\n                    setMode(\"newlines\");\n                }\n                else if (keyCode == 27) {\n                    // 27: escape\n                    setMode(\"escape\");\n                }\n                else if ((keyCode < 16 || keyCode > 20) && keyCode != 91) {\n                    // 16-20 are shift, etc.\n                    // 91: left window key\n                    // I think this might be a little messed up since there are\n                    // a lot of nonprinting keys above 20.\n                    setMode(\"typing\");\n                }\n            }\n        };\n\n        var setEventHandlers = function () {\n            util.addEvent(panels.input, \"keypress\", function (event) {\n                // keyCode 89: y\n                // keyCode 90: z\n                if ((event.ctrlKey || event.metaKey) && !event.altKey && (event.keyCode == 89 || event.keyCode == 90)) {\n                    event.preventDefault();\n                }\n            });\n\n            var handlePaste = function () {\n                if (uaSniffed.isIE || (inputStateObj && inputStateObj.text != panels.input.value)) {\n                    if (timer == undefined) {\n                        mode = \"paste\";\n                        saveState();\n                        refreshState();\n                    }\n                }\n            };\n\n            //util.addEvent(panels.input, \"keydown\", handleCtrlYZ);\n            util.addEvent(panels.input, \"keydown\", handleModeChange);\n            util.addEvent(panels.input, \"mousedown\", function () {\n                setMode(\"moving\");\n            });\n\n            panels.input.onpaste = handlePaste;\n            panels.input.ondrop = handlePaste;\n        };\n\n        var init = function () {\n            setEventHandlers();\n            refreshState(true);\n            //Not necessary\n            //saveState();\n        };\n        \n        this.reinit = function(content, start, end, scrollTop) {\n            undoStack = [];\n            stackPtr = 0;\n            mode = \"none\";\n            lastState = undefined;\n            timer = undefined;\n            refreshState();\n            inputStateObj.text = content;\n            inputStateObj.start = start;\n            inputStateObj.end = end;\n            inputStateObj.scrollTop = scrollTop;\n            inputStateObj.setInputAreaSelection();\n            saveState();\n        };\n        this.setMode = setMode;\n\n        init();\n    }\n\n    // end of UndoManager\n    */\n\n\t// The input textarea state/contents.\n\t// This is used to implement undo/redo by the undo manager.\n\tfunction TextareaState(panels, isInitialState) {\n\t\t// Aliases\n\t\tvar stateObj = this\n\t\tvar inputArea = panels.input\n\t\tthis.init = function() {\n\t\t\t/*benweet\n            if (!util.isVisible(inputArea)) {\n                return;\n            }\n            if (!isInitialState && doc.activeElement && doc.activeElement !== inputArea) { // this happens when tabbing out of the input box\n                return;\n            }\n            */\n\n\t\t\t;(function() {\n\t\t\t\tstateObj.before = inputArea.doc.getRange(CodeMirror.Pos(0, 0), inputArea.doc.getCursor('from'))\n\t\t\t\tstateObj.selection = inputArea.doc.getSelection()\n\t\t\t\tstateObj.after = inputArea.doc.getRange(\n\t\t\t\t\tinputArea.doc.getCursor('to'),\n\t\t\t\t\tinputArea.doc.posFromIndex(Number.MAX_VALUE)\n\t\t\t\t)\n\t\t\t})()\n\t\t\tthis.text = [this.before, this.selection, this.after].join('')\n\t\t\tthis.length = this.text.length\n\t\t\tthis.setInputAreaSelectionStartEnd()\n\t\t\tthis.scrollTop = inputArea.doc.scrollTop || 0\n\t\t\t/*benweet\n            if (!this.text && inputArea.selectionStart || inputArea.selectionStart === 0) {\n                this.text = inputArea.value;\n            }\n            */\n\t\t}\n\n\t\t// Sets the selected text in the input box after we've performed an\n\t\t// operation.\n\t\tthis.setInputAreaSelection = function() {\n\t\t\tinputArea.doc.setSelection(\n\t\t\t\tinputArea.doc.posFromIndex(stateObj.start),\n\t\t\t\tinputArea.doc.posFromIndex(stateObj.end),\n\t\t\t\t{ scroll: true }\n\t\t\t)\n\t\t\tinputArea.focus()\n\n\t\t\t/*benweet\n            if (!util.isVisible(inputArea)) {\n                return;\n            }\n\n            if (inputArea.selectionStart !== undefined && !uaSniffed.isOpera) {\n\n                inputArea.focus();\n                inputArea.selectionStart = stateObj.start;\n                inputArea.selectionEnd = stateObj.end;\n                inputArea.scrollTop = stateObj.scrollTop;\n            }\n            else if (doc.selection) {\n\n                if (doc.activeElement && doc.activeElement !== inputArea) {\n                    return;\n                }\n\n                inputArea.focus();\n                var range = inputArea.createTextRange();\n                range.moveStart(\"character\", -inputArea.value.length);\n                range.moveEnd(\"character\", -inputArea.value.length);\n                range.moveEnd(\"character\", stateObj.end);\n                range.moveStart(\"character\", stateObj.start);\n                range.select();\n            }\n            */\n\t\t}\n\n\t\tthis.setInputAreaSelectionStartEnd = function() {\n\t\t\tstateObj.start = stateObj.before.length\n\t\t\tstateObj.end = stateObj.after.length\n\n\t\t\t/*benweet\n            if (!panels.ieCachedRange && (inputArea.selectionStart || inputArea.selectionStart === 0)) {\n\n                stateObj.start = inputArea.selectionStart;\n                stateObj.end = inputArea.selectionEnd;\n            }\n            else if (doc.selection) {\n\n                stateObj.text = util.fixEolChars(inputArea.value);\n\n                // IE loses the selection in the textarea when buttons are\n                // clicked.  On IE we cache the selection. Here, if something is cached,\n                // we take it.\n                var range = panels.ieCachedRange || doc.selection.createRange();\n\n                var fixedRange = util.fixEolChars(range.text);\n                var marker = \"\\x07\";\n                var markedRange = marker + fixedRange + marker;\n                range.text = markedRange;\n                var inputText = util.fixEolChars(inputArea.value);\n\n                range.moveStart(\"character\", -markedRange.length);\n                range.text = fixedRange;\n\n                stateObj.start = inputText.indexOf(marker);\n                stateObj.end = inputText.lastIndexOf(marker) - marker.length;\n\n                var len = stateObj.text.length - util.fixEolChars(inputArea.value).length;\n\n                if (len) {\n                    range.moveStart(\"character\", -fixedRange.length);\n                    while (len--) {\n                        fixedRange += \"\\n\";\n                        stateObj.end += 1;\n                    }\n                    range.text = fixedRange;\n                }\n\n                if (panels.ieCachedRange)\n                    stateObj.scrollTop = panels.ieCachedScrollTop; // this is set alongside with ieCachedRange\n\n                panels.ieCachedRange = null;\n\n                this.setInputAreaSelection();\n            }\n            */\n\t\t}\n\n\t\t// Restore this state into the input area.\n\t\tthis.restore = function() {\n\t\t\t// Here we could do editor.setValue but we want to update the less we can for undo management\n\n\t\t\t// Find the first modified char\n\t\t\tvar startIndex = 0\n\t\t\tvar startIndexMax = stateObj.before.length\n\t\t\twhile (startIndex < startIndexMax) {\n\t\t\t\tif (stateObj.before.charCodeAt(startIndex) !== stateObj.text.charCodeAt(startIndex)) break\n\t\t\t\tstartIndex++\n\t\t\t}\n\t\t\t// Find the last modified char\n\t\t\tvar endIndex = 0\n\t\t\tvar endIndexMax = stateObj.after.length\n\t\t\tvar beforeMaxOffset = stateObj.after.length - 1\n\t\t\tvar afterMaxOffset = stateObj.text.length - 1\n\t\t\twhile (endIndex < endIndexMax) {\n\t\t\t\tif (\n\t\t\t\t\tstateObj.after.charCodeAt(beforeMaxOffset - endIndex) !==\n\t\t\t\t\tstateObj.text.charCodeAt(afterMaxOffset - endIndex)\n\t\t\t\t)\n\t\t\t\t\tbreak\n\t\t\t\tendIndex++\n\t\t\t}\n\n\t\t\tinputArea.doc.replaceRange(\n\t\t\t\tstateObj.text.substring(startIndex, afterMaxOffset - endIndex + 1),\n\t\t\t\tinputArea.doc.posFromIndex(startIndex),\n\t\t\t\tinputArea.doc.posFromIndex(stateObj.length - endIndex)\n\t\t\t)\n\t\t\tthis.setInputAreaSelection()\n\n\t\t\t/*benweet\n            if (stateObj.text != undefined && stateObj.text != inputArea.value) {\n                inputArea.value = stateObj.text;\n            }\n            inputArea.scrollTop = stateObj.scrollTop;\n            */\n\t\t}\n\n\t\t// Gets a collection of HTML chunks from the inptut textarea.\n\t\tthis.getChunks = function() {\n\t\t\tvar chunk = new Chunks()\n\t\t\tchunk.before = stateObj.before\n\t\t\tchunk.startTag = ''\n\t\t\tchunk.selection = stateObj.selection\n\t\t\tchunk.endTag = ''\n\t\t\tchunk.after = stateObj.after\n\t\t\tchunk.scrollTop = stateObj.scrollTop\n\n\t\t\treturn chunk\n\t\t}\n\n\t\t// Sets the TextareaState properties given a chunk of markdown.\n\t\tthis.setChunks = function(chunk) {\n\t\t\tchunk.before = chunk.before + chunk.startTag\n\t\t\tchunk.after = chunk.endTag + chunk.after\n\n\t\t\tthis.start = chunk.before.length\n\t\t\tthis.end = chunk.before.length + chunk.selection.length\n\t\t\tthis.text = chunk.before + chunk.selection + chunk.after\n\t\t\tthis.scrollTop = chunk.scrollTop\n\t\t}\n\t\tthis.init()\n\t}\n\n\tfunction PreviewManager(converter, panels, previewRefreshCallback, previewWrapper) {\n\t\tvar managerObj = this\n\t\tvar timeout\n\t\tvar elapsedTime\n\t\tvar oldInputText\n\t\tvar maxDelay = 3000\n\t\tvar startType = 'delayed' // The other legal value is \"manual\"\n\n\t\t// Adds event listeners to elements\n\t\t/*benweet\n        var setupEvents = function (inputElem, listener) {\n\n            util.addEvent(inputElem, \"input\", listener);\n            inputElem.onpaste = listener;\n            inputElem.ondrop = listener;\n\n            util.addEvent(inputElem, \"keypress\", listener);\n            util.addEvent(inputElem, \"keydown\", listener);\n        };\n        */\n\n\t\tvar getDocScrollTop = function() {\n\t\t\tvar result = 0\n\n\t\t\tif (window.innerHeight) {\n\t\t\t\tresult = window.pageYOffset\n\t\t\t} else if (doc.documentElement && doc.documentElement.scrollTop) {\n\t\t\t\tresult = doc.documentElement.scrollTop\n\t\t\t} else if (doc.body) {\n\t\t\t\tresult = doc.body.scrollTop\n\t\t\t}\n\n\t\t\treturn result\n\t\t}\n\n\t\tvar makePreviewHtml = function() {\n\t\t\t// If there is no registered preview panel\n\t\t\t// there is nothing to do.\n\t\t\tif (!panels.preview) return\n\n\t\t\tvar text = panels.input.doc.getValue()\n\t\t\tif (text && text == oldInputText) {\n\t\t\t\treturn // Input text hasn't changed.\n\t\t\t} else {\n\t\t\t\toldInputText = text\n\t\t\t}\n\n\t\t\tvar prevTime = new Date().getTime()\n\n\t\t\ttext = converter.makeHtml(text)\n\n\t\t\t// Calculate the processing time of the HTML creation.\n\t\t\t// It's used as the delay time in the event listener.\n\t\t\tvar currTime = new Date().getTime()\n\t\t\telapsedTime = currTime - prevTime\n\n\t\t\tpushPreviewHtml(text)\n\t\t}\n\t\tif (previewWrapper !== undefined) {\n\t\t\tmakePreviewHtml = previewWrapper(makePreviewHtml)\n\t\t}\n\n\t\t// setTimeout is already used.  Used as an event listener.\n\t\tvar applyTimeout = function() {\n\t\t\tif (timeout) {\n\t\t\t\tclearTimeout(timeout)\n\t\t\t\ttimeout = undefined\n\t\t\t}\n\n\t\t\tif (startType !== 'manual') {\n\t\t\t\tvar delay = 0\n\n\t\t\t\tif (startType === 'delayed') {\n\t\t\t\t\tdelay = elapsedTime\n\t\t\t\t}\n\n\t\t\t\tif (delay > maxDelay) {\n\t\t\t\t\tdelay = maxDelay\n\t\t\t\t}\n\t\t\t\ttimeout = setTimeout(makePreviewHtml, delay)\n\t\t\t}\n\t\t}\n\n\t\tvar getScaleFactor = function(panel) {\n\t\t\tif (panel.scrollHeight <= panel.clientHeight) {\n\t\t\t\treturn 1\n\t\t\t}\n\t\t\treturn panel.scrollTop / (panel.scrollHeight - panel.clientHeight)\n\t\t}\n\n\t\tvar setPanelScrollTops = function() {\n\t\t\tif (panels.preview) {\n\t\t\t\tpanels.preview.scrollTop =\n\t\t\t\t\t(panels.preview.scrollHeight - panels.preview.clientHeight) * getScaleFactor(panels.preview)\n\t\t\t}\n\t\t}\n\n\t\tthis.refresh = function(requiresRefresh) {\n\t\t\tif (requiresRefresh) {\n\t\t\t\toldInputText = ''\n\t\t\t\tmakePreviewHtml()\n\t\t\t} else {\n\t\t\t\tapplyTimeout()\n\t\t\t}\n\t\t}\n\n\t\tthis.processingTime = function() {\n\t\t\treturn elapsedTime\n\t\t}\n\n\t\tvar isFirstTimeFilled = true\n\n\t\t// IE doesn't let you use innerHTML if the element is contained somewhere in a table\n\t\t// (which is the case for inline editing) -- in that case, detach the element, set the\n\t\t// value, and reattach. Yes, that *is* ridiculous.\n\t\tvar ieSafePreviewSet = function(text) {\n\t\t\tvar preview = panels.preview\n\t\t\tvar parent = preview.parentNode\n\t\t\tvar sibling = preview.nextSibling\n\t\t\tparent.removeChild(preview)\n\t\t\tpreview.innerHTML = text\n\t\t\tif (!sibling) parent.appendChild(preview)\n\t\t\telse parent.insertBefore(preview, sibling)\n\t\t}\n\n\t\tvar nonSuckyBrowserPreviewSet = function(text) {\n\t\t\tpanels.preview.innerHTML = text\n\t\t}\n\n\t\tvar previewSetter\n\n\t\tvar previewSet = function(text) {\n\t\t\tif (previewSetter) return previewSetter(text)\n\n\t\t\ttry {\n\t\t\t\tnonSuckyBrowserPreviewSet(text)\n\t\t\t\tpreviewSetter = nonSuckyBrowserPreviewSet\n\t\t\t} catch (e) {\n\t\t\t\tpreviewSetter = ieSafePreviewSet\n\t\t\t\tpreviewSetter(text)\n\t\t\t}\n\t\t}\n\n\t\tvar pushPreviewHtml = function(text) {\n\t\t\tvar emptyTop = position.getTop(panels.input.doc) - getDocScrollTop()\n\n\t\t\tif (panels.preview) {\n\t\t\t\tpreviewSet(text)\n\t\t\t\tpreviewRefreshCallback()\n\t\t\t}\n\n\t\t\tsetPanelScrollTops()\n\n\t\t\tif (isFirstTimeFilled) {\n\t\t\t\tisFirstTimeFilled = false\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tvar fullTop = position.getTop(panels.input.doc) - getDocScrollTop()\n\n\t\t\tif (uaSniffed.isIE) {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\twindow.scrollBy(0, fullTop - emptyTop)\n\t\t\t\t}, 0)\n\t\t\t} else {\n\t\t\t\twindow.scrollBy(0, fullTop - emptyTop)\n\t\t\t}\n\t\t}\n\n\t\tvar init = function() {\n\t\t\t/*benweet\n            setupEvents(panels.input, applyTimeout);\n            */\n\t\t\tpanels.input.on('change', applyTimeout)\n\t\t\t//Not necessary\n\t\t\t//makePreviewHtml();\n\n\t\t\tif (panels.preview) {\n\t\t\t\tpanels.preview.scrollTop = 0\n\t\t\t}\n\t\t}\n\n\t\tinit()\n\t}\n\n\t// Creates the background behind the hyperlink text entry box.\n\t// And download dialog\n\t// Most of this has been moved to CSS but the div creation and\n\t// browser-specific hacks remain here.\n\tui.createBackground = function() {\n\t\tvar background = doc.createElement('div'),\n\t\t\tstyle = background.style\n\n\t\tbackground.className = 'wmd-prompt-background'\n\n\t\tstyle.position = 'absolute'\n\t\tstyle.top = '0'\n\n\t\tstyle.zIndex = '1000'\n\n\t\tif (uaSniffed.isIE) {\n\t\t\tstyle.filter = 'alpha(opacity=50)'\n\t\t} else {\n\t\t\tstyle.opacity = '0.5'\n\t\t}\n\n\t\tvar pageSize = position.getPageSize()\n\t\tstyle.height = pageSize[1] + 'px'\n\n\t\tif (uaSniffed.isIE) {\n\t\t\tstyle.left = doc.documentElement.scrollLeft\n\t\t\tstyle.width = doc.documentElement.clientWidth\n\t\t} else {\n\t\t\tstyle.left = '0'\n\t\t\tstyle.width = '100%'\n\t\t}\n\n\t\tdoc.body.appendChild(background)\n\t\treturn background\n\t}\n\n\t// This simulates a modal dialog box and asks for the URL when you\n\t// click the hyperlink or image buttons.\n\t//\n\t// text: The html for the input box.\n\t// defaultInputText: The default value that appears in the input box.\n\t// callback: The function which is executed when the prompt is dismissed, either via OK or Cancel.\n\t//      It receives a single argument; either the entered text (if OK was chosen) or null (if Cancel\n\t//      was chosen).\n\t//  fileChangeCallback: If not specified, <input type=\"file\" doesn't get rendered.\n\t//      It is called with a HTMLInputElement.files as an argument\n\t//  fileType: The accepts attribute for input elements\n\tui.prompt = function(text, defaultInputText, callback, fileChangeCallback, fileType) {\n\t\t// These variables need to be declared at this level since they are used\n\t\t// in multiple functions.\n\t\tvar dialog // The dialog box.\n\t\tvar input // The text box where you enter the hyperlink.\n\t\tvar fileInput // The file input element.\n\t\tvar fileInputLabel // The <label> element for a file input\n\n\t\tif (defaultInputText === undefined) {\n\t\t\tdefaultInputText = ''\n\t\t}\n\n\t\t// Used as a keydown event handler. Esc dismisses the prompt.\n\t\t// Key code 27 is ESC.\n\t\tvar checkEscape = function(key) {\n\t\t\tvar code = key.charCode || key.keyCode\n\t\t\tif (code === 27) {\n\t\t\t\tclose(true)\n\t\t\t}\n\t\t}\n\n\t\t// Dismisses the hyperlink input box.\n\t\t// isCancel is true if we don't care about the input text.\n\t\t// isCancel is false if we are going to keep the text.\n\t\tvar close = function(isCancel) {\n\t\t\tutil.removeEvent(doc.body, 'keydown', checkEscape)\n\t\t\tvar text = input.value\n\n\t\t\tif (isCancel) {\n\t\t\t\ttext = null\n\t\t\t} else {\n\t\t\t\t// Fixes common pasting errors.\n\t\t\t\ttext = text.replace(/^http:\\/\\/(https?|ftp):\\/\\//, '$1://')\n\t\t\t\tif (!/^(?:https?|ftp):\\/\\//.test(text)) text = 'http://' + text\n\t\t\t}\n\n\t\t\tdialog.parentNode.removeChild(dialog)\n\n\t\t\tcallback(text)\n\t\t\treturn false\n\t\t}\n\n\t\t// Create the text input box form/window.\n\t\tvar createDialog = function() {\n\t\t\t// The main dialog box.\n\t\t\tdialog = doc.createElement('div')\n\t\t\tdialog.className = 'wmd-prompt-dialog'\n\t\t\tdialog.style.padding = '10px;'\n\t\t\tdialog.style.position = 'fixed'\n\t\t\tdialog.style.maxWidth = 'calc(100% - 70px)'\n\t\t\tdialog.style.zIndex = '1001'\n\n\t\t\t// The dialog text.\n\t\t\tvar question = doc.createElement('div')\n\t\t\tquestion.innerHTML = text\n\t\t\tquestion.style.padding = '5px'\n\t\t\tdialog.appendChild(question)\n\n\t\t\t// The web form container for the text box and buttons.\n\t\t\tvar form = doc.createElement('form'),\n\t\t\t\tstyle = form.style\n\t\t\tform.onsubmit = function() {\n\t\t\t\treturn close(false)\n\t\t\t}\n\t\t\tstyle.padding = '0'\n\t\t\tstyle.margin = '0'\n\t\t\tstyle.cssFloat = 'left'\n\t\t\tstyle.width = '100%'\n\t\t\tstyle.textAlign = 'center'\n\t\t\tstyle.position = 'relative'\n\t\t\tdialog.appendChild(form)\n\n\t\t\t// The input text box\n\t\t\tinput = doc.createElement('input')\n\t\t\tinput.type = 'text'\n\t\t\tinput.value = defaultInputText\n\t\t\tstyle = input.style\n\t\t\tstyle.display = 'block'\n\t\t\tstyle.width = '80%'\n\t\t\tstyle.marginLeft = style.marginRight = 'auto'\n\t\t\tform.appendChild(input)\n\n\t\t\t// The file input\n\t\t\tif (fileChangeCallback) {\n\t\t\t\tfileInput = doc.createElement('input')\n\t\t\t\tfileInput.type = 'file'\n\t\t\t\tfileInput.accept = fileType\n\t\t\t\tfileInput.id = 'file-input'\n\t\t\t\tfileInput.addEventListener('change', e => fileChangeCallback(e.target.files, input))\n\t\t\t\tfileInputLabel = doc.createElement('label')\n\t\t\t\tfileInputLabel.htmlFor = 'file-input'\n\t\t\t\tfileInputLabel.className = 'file-input'\n\t\t\t\tfileInputLabel.innerText = 'Upload image'\n\t\t\t\tform.appendChild(fileInput)\n\t\t\t\tform.appendChild(fileInputLabel)\n\t\t\t}\n\n\t\t\t// The ok button\n\t\t\tvar okButton = doc.createElement('input')\n\t\t\tokButton.type = 'button'\n\t\t\tokButton.onclick = function() {\n\t\t\t\treturn close(false)\n\t\t\t}\n\t\t\tokButton.value = 'OK'\n\t\t\tstyle = okButton.style\n\t\t\tstyle.margin = '10px'\n\t\t\tstyle.display = 'inline'\n\t\t\tstyle.width = '7em'\n\n\t\t\t// The cancel button\n\t\t\tvar cancelButton = doc.createElement('input')\n\t\t\tcancelButton.type = 'button'\n\t\t\tcancelButton.onclick = function() {\n\t\t\t\treturn close(true)\n\t\t\t}\n\t\t\tcancelButton.value = 'Cancel'\n\t\t\tstyle = cancelButton.style\n\t\t\tstyle.margin = '10px'\n\t\t\tstyle.display = 'inline'\n\t\t\tstyle.width = '7em'\n\n\t\t\tform.appendChild(okButton)\n\t\t\tform.appendChild(cancelButton)\n\n\t\t\tutil.addEvent(doc.body, 'keydown', checkEscape)\n\t\t\tdialog.style.display = 'block'\n\t\t\tif (uaSniffed.isIE_5or6) {\n\t\t\t\tdialog.style.position = 'absolute'\n\t\t\t}\n\t\t\tdoc.body.appendChild(dialog)\n\t\t}\n\n\t\t// Why is this in a zero-length timeout?\n\t\t// Is it working around a browser bug?\n\t\tsetTimeout(function() {\n\t\t\tcreateDialog()\n\n\t\t\t/*var defTextLen = defaultInputText.length;\n            if (input.selectionStart !== undefined) {\n                input.selectionStart = 0;\n                input.selectionEnd = defTextLen;\n            }\n            else if (input.createTextRange) {\n                var range = input.createTextRange();\n                range.collapse(false);\n                range.moveStart(\"character\", -defTextLen);\n                range.moveEnd(\"character\", defTextLen);\n                range.select();\n            }*/\n\n\t\t\tinput.focus()\n\t\t}, 0)\n\t}\n\n\tfunction UIManager(postfix, panels, undoManager, previewManager, commandManager, helpOptions, getString, getKey) {\n\t\tvar getStringAndKey = function(identifier) {\n\t\t\treturn getString(identifier) + ' ' + getKey(identifier)\n\t\t}\n\n\t\tvar inputBox = panels.input,\n\t\t\tbuttons = {} // buttons.undo, buttons.link, etc. The actual DOM elements.\n\n\t\tthis.setUndoRedoButtonStates = function() {\n\t\t\tsetTimeout(function() {\n\t\t\t\tsetupButton(buttons.undo, inputBox.doc.history.done.length > 0)\n\t\t\t\tsetupButton(buttons.redo, inputBox.doc.history.undone.length > 0)\n\t\t\t}, 50)\n\t\t}\n\n\t\tvar that = this\n\t\tmakeSpritedButtonRow()\n\n\t\tvar keyEvent = 'keydown'\n\t\tif (uaSniffed.isOpera) {\n\t\t\tkeyEvent = 'keypress'\n\t\t}\n\n\t\tfunction addKeyCmd(identifierList) {\n\t\t\tif (identifierList.length === 0) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tvar eKeys = {}\n\t\t\tfor (var i = identifierList.length - 1; i >= 0; i--) {\n\t\t\t\tvar identifier = identifierList[i]\n\t\t\t\teKeys[getKey(identifier)] = (function(identifier) {\n\t\t\t\t\treturn function(editor) {\n\t\t\t\t\t\tdoClick(buttons[identifier])\n\t\t\t\t\t}\n\t\t\t\t})(identifier)\n\t\t\t}\n\t\t\tinputBox.addKeyMap(eKeys)\n\t\t}\n\t\taddKeyCmd(['bold', 'italic', 'link', 'quote', 'code', 'image', 'olist', 'ulist', 'heading', 'hr', 'table'])\n\n\t\t/*benweet\n        util.addEvent(inputBox, keyEvent, function (key) {\n\n            // Check to see if we have a button key and, if so execute the callback.\n            if ((key.ctrlKey || key.metaKey) && !key.altKey) {\n\n                var keyCode = key.charCode || key.keyCode;\n                var keyCodeStr = String.fromCharCode(keyCode).toLowerCase();\n\n                switch (keyCodeStr) {\n                    case \"b\":\n                        doClick(buttons.bold);\n                        break;\n                    case \"i\":\n                        doClick(buttons.italic);\n                        break;\n                    case \"l\":\n                        doClick(buttons.link);\n                        break;\n                    case \"q\":\n                        doClick(buttons.quote);\n                        break;\n                    case \"k\":\n                        doClick(buttons.code);\n                        break;\n                    case \"g\":\n                        doClick(buttons.image);\n                        break;\n                    case \"o\":\n                        doClick(buttons.olist);\n                        break;\n                    case \"u\":\n                        doClick(buttons.ulist);\n                        break;\n                    case \"h\":\n                        doClick(buttons.heading);\n                        break;\n                    case \"r\":\n                        doClick(buttons.hr);\n                        break;\n                    case \"y\":\n                        doClick(buttons.redo);\n                        break;\n                    case \"z\":\n                        if (key.shiftKey) {\n                            doClick(buttons.redo);\n                        }\n                        else {\n                            doClick(buttons.undo);\n                        }\n                        break;\n                    case \"v\":\n                        undoManager.setMode(\"typing\");\n                        return;\n                    case \"x\":\n                        undoManager.setMode(\"deleting\");\n                        return;\n                    default:\n                        return;\n                }\n\n\n                if (key.preventDefault) {\n                    key.preventDefault();\n                }\n\n                if (window.event) {\n                    window.event.returnValue = false;\n                }\n            }\n        });\n\n        // Auto-indent on shift-enter\n        util.addEvent(inputBox, \"keyup\", function (key) {\n            if (key.shiftKey && !key.ctrlKey && !key.metaKey) {\n                var keyCode = key.charCode || key.keyCode;\n                // Character 13 is Enter\n                if (keyCode === 13) {\n                    var fakeButton = {};\n                    fakeButton.textOp = bindCommand(\"doAutoindent\");\n                    doClick(fakeButton);\n                }\n            }\n        });\n\n        // special handler because IE clears the context of the textbox on ESC\n        if (uaSniffed.isIE) {\n            util.addEvent(inputBox, \"keydown\", function (key) {\n                var code = key.keyCode;\n                if (code === 27) {\n                    return false;\n                }\n            });\n        }\n        */\n\n\t\t// Perform the button's action.\n\t\tfunction doClick(button) {\n\t\t\tinputBox.focus()\n\t\t\tvar linkOrImage = button.id == 'wmd-link-button' || button.id == 'wmd-image-button'\n\n\t\t\tif (button.textOp) {\n\t\t\t\tif (undoManager && !linkOrImage) {\n\t\t\t\t\tundoManager.setCommandMode()\n\t\t\t\t}\n\n\t\t\t\tvar state = new TextareaState(panels)\n\n\t\t\t\tif (!state) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tvar chunks = state.getChunks()\n\n\t\t\t\t// Some commands launch a \"modal\" prompt dialog.  Javascript\n\t\t\t\t// can't really make a modal dialog box and the WMD code\n\t\t\t\t// will continue to execute while the dialog is displayed.\n\t\t\t\t// This prevents the dialog pattern I'm used to and means\n\t\t\t\t// I can't do something like this:\n\t\t\t\t//\n\t\t\t\t// var link = CreateLinkDialog();\n\t\t\t\t// makeMarkdownLink(link);\n\t\t\t\t//\n\t\t\t\t// Instead of this straightforward method of handling a\n\t\t\t\t// dialog I have to pass any code which would execute\n\t\t\t\t// after the dialog is dismissed (e.g. link creation)\n\t\t\t\t// in a function parameter.\n\t\t\t\t//\n\t\t\t\t// Yes this is awkward and I think it sucks, but there's\n\t\t\t\t// no real workaround.  Only the image and link code\n\t\t\t\t// create dialogs and require the function pointers.\n\t\t\t\tvar fixupInputArea = function() {\n\t\t\t\t\tinputBox.focus()\n\n\t\t\t\t\tif (chunks) {\n\t\t\t\t\t\tstate.setChunks(chunks)\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.restore()\n\t\t\t\t\tpreviewManager.refresh()\n\t\t\t\t}\n\n\t\t\t\tvar noCleanup = button.textOp(chunks, fixupInputArea)\n\n\t\t\t\tif (!noCleanup) {\n\t\t\t\t\tfixupInputArea()\n\t\t\t\t\t/*benweet\n                    if(!linkOrImage) {\n                        inputBox.dispatchEvent(new Event('input'));\n                    }\n                    */\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (button.execute) {\n\t\t\t\tbutton.execute(undoManager)\n\t\t\t}\n\t\t}\n\n\t\tfunction setupButton(button, isEnabled) {\n\t\t\tvar normalYShift = '0px'\n\t\t\tvar disabledYShift = '-20px'\n\t\t\tvar highlightYShift = '-40px'\n\t\t\tvar image = button.getElementsByTagName('span')[0]\n\t\t\tbutton.className = button.className.replace(/ disabled/g, '')\n\t\t\tif (isEnabled) {\n\t\t\t\timage.style.backgroundPosition = button.XShift + ' ' + normalYShift\n\t\t\t\tbutton.onmouseover = function() {\n\t\t\t\t\timage.style.backgroundPosition = this.XShift + ' ' + highlightYShift\n\t\t\t\t}\n\n\t\t\t\tbutton.onmouseout = function() {\n\t\t\t\t\timage.style.backgroundPosition = this.XShift + ' ' + normalYShift\n\t\t\t\t}\n\n\t\t\t\t// IE tries to select the background image \"button\" text (it's\n\t\t\t\t// implemented in a list item) so we have to cache the selection\n\t\t\t\t// on mousedown.\n\t\t\t\tif (uaSniffed.isIE) {\n\t\t\t\t\tbutton.onmousedown = function() {\n\t\t\t\t\t\tif (doc.activeElement && doc.activeElement !== panels.input.doc) {\n\t\t\t\t\t\t\t// we're not even in the input box, so there's no selection\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpanels.ieCachedRange = document.selection.createRange()\n\t\t\t\t\t\tpanels.ieCachedScrollTop = panels.input.doc.scrollTop || 0\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!button.isHelp) {\n\t\t\t\t\tbutton.onclick = function() {\n\t\t\t\t\t\tif (this.onmouseout) {\n\t\t\t\t\t\t\tthis.onmouseout()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdoClick(this)\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\timage.style.backgroundPosition = button.XShift + ' ' + disabledYShift\n\t\t\t\tbutton.onmouseover = button.onmouseout = button.onclick = function() {}\n\t\t\t\tbutton.className += ' disabled'\n\t\t\t}\n\t\t}\n\n\t\tfunction bindCommand(method) {\n\t\t\tif (typeof method === 'string') method = commandManager[method]\n\t\t\treturn function() {\n\t\t\t\tmethod.apply(commandManager, arguments)\n\t\t\t}\n\t\t}\n\n\t\tfunction makeSpritedButtonRow() {\n\t\t\tvar buttonBar = panels.buttonBar\n\n\t\t\tvar normalYShift = '0px'\n\t\t\tvar disabledYShift = '-20px'\n\t\t\tvar highlightYShift = '-40px'\n\n\t\t\tvar buttonRow = document.createElement('ul')\n\t\t\tbuttonRow.id = 'wmd-button-row' + postfix\n\t\t\tbuttonRow.className = 'wmd-button-row'\n\t\t\tbuttonRow = buttonBar.appendChild(buttonRow)\n\t\t\tvar xPosition = 0\n\t\t\tvar makeButton = function(id, title, XShift, textOp) {\n\t\t\t\tvar button = document.createElement('li')\n\t\t\t\tbutton.className = 'wmd-button'\n\t\t\t\tbutton.style.left = xPosition + 'px'\n\t\t\t\txPosition += 25\n\t\t\t\tvar buttonImage = document.createElement('span')\n\t\t\t\tbutton.id = id + postfix\n\t\t\t\tbutton.appendChild(buttonImage)\n\t\t\t\tbutton.title = title\n\t\t\t\tbutton.XShift = XShift\n\t\t\t\tif (textOp) button.textOp = textOp\n\t\t\t\tsetupButton(button, true)\n\t\t\t\tbuttonRow.appendChild(button)\n\t\t\t\treturn button\n\t\t\t}\n\t\t\tvar makeSpacer = function(num) {\n\t\t\t\tvar spacer = document.createElement('li')\n\t\t\t\tspacer.className = 'wmd-spacer wmd-spacer' + num\n\t\t\t\tspacer.id = 'wmd-spacer' + num + postfix\n\t\t\t\tbuttonRow.appendChild(spacer)\n\t\t\t\txPosition += 25\n\t\t\t}\n\n\t\t\tbuttons.bold = makeButton('wmd-bold-button', getStringAndKey('bold'), '0px', bindCommand('doBold'))\n\t\t\tbuttons.italic = makeButton(\n\t\t\t\t'wmd-italic-button',\n\t\t\t\tgetStringAndKey('italic'),\n\t\t\t\t'-20px',\n\t\t\t\tbindCommand('doItalic')\n\t\t\t)\n\t\t\tmakeSpacer(1)\n\t\t\tbuttons.link = makeButton(\n\t\t\t\t'wmd-link-button',\n\t\t\t\tgetStringAndKey('link'),\n\t\t\t\t'-40px',\n\t\t\t\tbindCommand(function(chunk, postProcessing) {\n\t\t\t\t\treturn this.doLinkOrImage(chunk, postProcessing, false)\n\t\t\t\t})\n\t\t\t)\n\t\t\tbuttons.quote = makeButton(\n\t\t\t\t'wmd-quote-button',\n\t\t\t\tgetStringAndKey('quote'),\n\t\t\t\t'-60px',\n\t\t\t\tbindCommand('doBlockquote')\n\t\t\t)\n\t\t\tbuttons.code = makeButton('wmd-code-button', getStringAndKey('code'), '-80px', bindCommand('doCode'))\n\t\t\tbuttons.image = makeButton(\n\t\t\t\t'wmd-image-button',\n\t\t\t\tgetStringAndKey('image'),\n\t\t\t\t'-100px',\n\t\t\t\tbindCommand(function(chunk, postProcessing) {\n\t\t\t\t\treturn this.doLinkOrImage(chunk, postProcessing, true)\n\t\t\t\t})\n\t\t\t)\n\t\t\tmakeSpacer(2)\n\t\t\tbuttons.olist = makeButton(\n\t\t\t\t'wmd-olist-button',\n\t\t\t\tgetStringAndKey('olist'),\n\t\t\t\t'-120px',\n\t\t\t\tbindCommand(function(chunk, postProcessing) {\n\t\t\t\t\tthis.doList(chunk, postProcessing, true)\n\t\t\t\t})\n\t\t\t)\n\t\t\tbuttons.ulist = makeButton(\n\t\t\t\t'wmd-ulist-button',\n\t\t\t\tgetStringAndKey('ulist'),\n\t\t\t\t'-140px',\n\t\t\t\tbindCommand(function(chunk, postProcessing) {\n\t\t\t\t\tthis.doList(chunk, postProcessing, false)\n\t\t\t\t})\n\t\t\t)\n\t\t\tbuttons.heading = makeButton(\n\t\t\t\t'wmd-heading-button',\n\t\t\t\tgetStringAndKey('heading'),\n\t\t\t\t'-160px',\n\t\t\t\tbindCommand('doHeading')\n\t\t\t)\n\t\t\tbuttons.hr = makeButton('wmd-hr-button', getStringAndKey('hr'), '-180px', bindCommand('doHorizontalRule'))\n\t\t\tbuttons.table = makeButton('wmd-hr-table', getStringAndKey('table'), '-180px', bindCommand('doTable'))\n\t\t\tmakeSpacer(3)\n\t\t\tbuttons.undo = makeButton('wmd-undo-button', getStringAndKey('undo'), '-200px', null)\n\t\t\tbuttons.undo.execute = function(manager) {\n\t\t\t\tinputBox.doc.undo()\n\t\t\t}\n\n\t\t\tbuttons.redo = makeButton('wmd-redo-button', getStringAndKey('redo'), '-220px', null)\n\t\t\tbuttons.redo.execute = function(manager) {\n\t\t\t\tinputBox.doc.redo()\n\t\t\t}\n\n\t\t\tif (helpOptions) {\n\t\t\t\tvar helpButton = document.createElement('li')\n\t\t\t\tvar helpButtonImage = document.createElement('span')\n\t\t\t\thelpButton.appendChild(helpButtonImage)\n\t\t\t\thelpButton.className = 'wmd-button wmd-help-button'\n\t\t\t\thelpButton.id = 'wmd-help-button' + postfix\n\t\t\t\thelpButton.XShift = '-240px'\n\t\t\t\thelpButton.isHelp = true\n\t\t\t\thelpButton.style.right = '0px'\n\t\t\t\thelpButton.title = getString('help')\n\t\t\t\thelpButton.onclick = helpOptions.handler\n\n\t\t\t\tsetupButton(helpButton, true)\n\t\t\t\tbuttonRow.appendChild(helpButton)\n\t\t\t\tbuttons.help = helpButton\n\t\t\t}\n\n\t\t\tthat.setUndoRedoButtonStates()\n\t\t\tinputBox.on('change', function() {\n\t\t\t\tthat.setUndoRedoButtonStates()\n\t\t\t})\n\t\t}\n\n\t\tthis.buttons = buttons\n\t\tthis.setButtonState = setupButton\n\t}\n\n\tfunction CommandManager(pluginHooks, getString) {\n\t\tthis.hooks = pluginHooks\n\t\tthis.getString = getString\n\t}\n\n\tvar commandProto = CommandManager.prototype\n\n\t// The markdown symbols - 4 spaces = code, > = blockquote, etc.\n\tcommandProto.prefixes = '(?:\\\\s{4,}|\\\\s*>|\\\\s*-\\\\s+|\\\\s*\\\\d+\\\\.|=|\\\\+|-|_|\\\\*|#|\\\\s*\\\\[[^\\n]]+\\\\]:)'\n\n\t// Remove markdown symbols from the chunk selection.\n\tcommandProto.unwrap = function(chunk) {\n\t\tvar txt = new re('([^\\\\n])\\\\n(?!(\\\\n|' + this.prefixes + '))', 'g')\n\t\tchunk.selection = chunk.selection.replace(txt, '$1 $2')\n\t}\n\n\tcommandProto.wrap = function(chunk, len) {\n\t\tthis.unwrap(chunk)\n\t\tvar regex = new re('(.{1,' + len + '})( +|$\\\\n?)', 'gm'),\n\t\t\tthat = this\n\n\t\tchunk.selection = chunk.selection.replace(regex, function(line, marked) {\n\t\t\tif (new re('^' + that.prefixes, '').test(line)) {\n\t\t\t\treturn line\n\t\t\t}\n\t\t\treturn marked + '\\n'\n\t\t})\n\n\t\tchunk.selection = chunk.selection.replace(/\\s+$/, '')\n\t}\n\n\tcommandProto.doBold = function(chunk, postProcessing) {\n\t\treturn this.doBorI(chunk, postProcessing, 2, this.getString('boldexample'))\n\t}\n\n\tcommandProto.doItalic = function(chunk, postProcessing) {\n\t\treturn this.doBorI(chunk, postProcessing, 1, this.getString('italicexample'))\n\t}\n\n\t// chunk: The selected region that will be enclosed with */**\n\t// nStars: 1 for italics, 2 for bold\n\t// insertText: If you just click the button without highlighting text, this gets inserted\n\tcommandProto.doBorI = function(chunk, postProcessing, nStars, insertText) {\n\t\t// Get rid of whitespace and fixup newlines.\n\t\tchunk.trimWhitespace()\n\t\tchunk.selection = chunk.selection.replace(/\\n{2,}/g, '\\n')\n\n\t\t// Look for stars before and after.  Is the chunk already marked up?\n\t\t// note that these regex matches cannot fail\n\t\tvar starsBefore = /(\\**$)/.exec(chunk.before)[0]\n\t\tvar starsAfter = /(^\\**)/.exec(chunk.after)[0]\n\n\t\tvar prevStars = Math.min(starsBefore.length, starsAfter.length)\n\n\t\t// Remove stars if we have to since the button acts as a toggle.\n\t\tif (prevStars >= nStars && (prevStars != 2 || nStars != 1)) {\n\t\t\tchunk.before = chunk.before.replace(re('[*]{' + nStars + '}$', ''), '')\n\t\t\tchunk.after = chunk.after.replace(re('^[*]{' + nStars + '}', ''), '')\n\t\t} else if (!chunk.selection && starsAfter) {\n\t\t\t// It's not really clear why this code is necessary.  It just moves\n\t\t\t// some arbitrary stuff around.\n\t\t\tchunk.after = chunk.after.replace(/^([*_]*)/, '')\n\t\t\tchunk.before = chunk.before.replace(/(\\s?)$/, '')\n\t\t\tvar whitespace = re.$1\n\t\t\tchunk.before = chunk.before + starsAfter + whitespace\n\t\t} else {\n\t\t\t// In most cases, if you don't have any selected text and click the button\n\t\t\t// you'll get a selected, marked up region with the default text inserted.\n\t\t\tif (!chunk.selection && !starsAfter) {\n\t\t\t\tchunk.selection = insertText\n\t\t\t}\n\n\t\t\t// Add the true markup.\n\t\t\tvar markup = nStars <= 1 ? '*' : '**' // shouldn't the test be = ?\n\t\t\tchunk.before = chunk.before + markup\n\t\t\tchunk.after = markup + chunk.after\n\t\t}\n\n\t\treturn\n\t}\n\n\tcommandProto.stripLinkDefs = function(text, defsToAdd) {\n\t\ttext = text.replace(\n\t\t\t/^[ ]{0,3}\\[(\\d+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+|$)/gm,\n\t\t\tfunction(totalMatch, id, link, newlines, title) {\n\t\t\t\tdefsToAdd[id] = totalMatch.replace(/\\s*$/, '')\n\t\t\t\tif (newlines) {\n\t\t\t\t\t// Strip the title and return that separately.\n\t\t\t\t\tdefsToAdd[id] = totalMatch.replace(/[\"(](.+?)[\")]$/, '')\n\t\t\t\t\treturn newlines + title\n\t\t\t\t}\n\t\t\t\treturn ''\n\t\t\t}\n\t\t)\n\n\t\treturn text\n\t}\n\n\tcommandProto.addLinkDef = function(chunk, linkDef) {\n\t\tvar refNumber = 0 // The current reference number\n\t\tvar defsToAdd = {} //\n\t\t// Start with a clean slate by removing all previous link definitions.\n\t\tchunk.before = this.stripLinkDefs(chunk.before, defsToAdd)\n\t\tchunk.selection = this.stripLinkDefs(chunk.selection, defsToAdd)\n\t\tchunk.after = this.stripLinkDefs(chunk.after, defsToAdd)\n\n\t\tvar defs = ''\n\t\tvar regex = /(\\[)((?:\\[[^\\]]*\\]|[^\\[\\]])*)(\\][ ]?(?:\\n[ ]*)?\\[)(\\d+)(\\])/g\n\n\t\tvar addDefNumber = function(def) {\n\t\t\trefNumber++\n\t\t\tdef = def.replace(/^[ ]{0,3}\\[(\\d+)\\]:/, '  [' + refNumber + ']:')\n\t\t\tdefs += '\\n' + def\n\t\t}\n\n\t\t// note that\n\t\t// a) the recursive call to getLink cannot go infinite, because by definition\n\t\t//    of regex, inner is always a proper substring of wholeMatch, and\n\t\t// b) more than one level of nesting is neither supported by the regex\n\t\t//    nor making a lot of sense (the only use case for nesting is a linked image)\n\t\tvar getLink = function(wholeMatch, before, inner, afterInner, id, end) {\n\t\t\tinner = inner.replace(regex, getLink)\n\t\t\tif (defsToAdd[id]) {\n\t\t\t\taddDefNumber(defsToAdd[id])\n\t\t\t\treturn before + inner + afterInner + refNumber + end\n\t\t\t}\n\t\t\treturn wholeMatch\n\t\t}\n\n\t\tchunk.before = chunk.before.replace(regex, getLink)\n\n\t\tif (linkDef) {\n\t\t\taddDefNumber(linkDef)\n\t\t} else {\n\t\t\tchunk.selection = chunk.selection.replace(regex, getLink)\n\t\t}\n\n\t\tvar refOut = refNumber\n\n\t\tchunk.after = chunk.after.replace(regex, getLink)\n\n\t\tif (chunk.after) {\n\t\t\tchunk.after = chunk.after.replace(/\\n*$/, '')\n\t\t}\n\t\tif (!chunk.after) {\n\t\t\tchunk.selection = chunk.selection.replace(/\\n*$/, '')\n\t\t}\n\n\t\tchunk.after += '\\n\\n' + defs\n\n\t\treturn refOut\n\t}\n\n\t// takes the line as entered into the add link/as image dialog and makes\n\t// sure the URL and the optinal title are \"nice\".\n\tfunction properlyEncoded(linkdef) {\n\t\treturn linkdef.replace(/^\\s*(.*?)(?:\\s+\"(.+)\")?\\s*$/, function(wholematch, link, title) {\n\t\t\tlink = link.replace(/\\?.*$/, function(querypart) {\n\t\t\t\treturn querypart.replace(/\\+/g, ' ') // in the query string, a plus and a space are identical\n\t\t\t})\n\t\t\tlink = decodeURIComponent(link) // unencode first, to prevent double encoding\n\t\t\tlink = encodeURI(link)\n\t\t\t\t.replace(/'/g, '%27')\n\t\t\t\t.replace(/\\(/g, '%28')\n\t\t\t\t.replace(/\\)/g, '%29')\n\t\t\tlink = link.replace(/\\?.*$/, function(querypart) {\n\t\t\t\treturn querypart.replace(/\\+/g, '%2b') // since we replaced plus with spaces in the query part, all pluses that now appear where originally encoded\n\t\t\t})\n\t\t\tif (title) {\n\t\t\t\ttitle = title.trim ? title.trim() : title.replace(/^\\s*/, '').replace(/\\s*$/, '')\n\t\t\t\ttitle = title\n\t\t\t\t\t.replace(/\"/g, 'quot;')\n\t\t\t\t\t.replace(/\\(/g, '&#40;')\n\t\t\t\t\t.replace(/\\)/g, '&#41;')\n\t\t\t\t\t.replace(/</g, '&lt;')\n\t\t\t\t\t.replace(/>/g, '&gt;')\n\t\t\t}\n\t\t\treturn title ? link + ' \"' + title + '\"' : link\n\t\t})\n\t}\n\n\tcommandProto.doLinkOrImage = function(chunk, postProcessing, isImage) {\n\t\tchunk.trimWhitespace()\n\t\tchunk.findTags(/\\s*!?\\[/, /\\][ ]?(?:\\n[ ]*)?(\\[.*?\\])?/)\n\t\tvar background\n\n\t\tif (chunk.endTag.length > 1 && chunk.startTag.length > 0) {\n\t\t\tchunk.startTag = chunk.startTag.replace(/!?\\[/, '')\n\t\t\tchunk.endTag = ''\n\t\t\tthis.addLinkDef(chunk, null)\n\t\t} else {\n\t\t\t// We're moving start and end tag back into the selection, since (as we're in the else block) we're not\n\t\t\t// *removing* a link, but *adding* one, so whatever findTags() found is now back to being part of the\n\t\t\t// link text. linkEnteredCallback takes care of escaping any brackets.\n\t\t\tchunk.selection = chunk.startTag + chunk.selection + chunk.endTag\n\t\t\tchunk.startTag = chunk.endTag = ''\n\n\t\t\tif (/\\n\\n/.test(chunk.selection)) {\n\t\t\t\tthis.addLinkDef(chunk, null)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tvar that = this\n\t\t\t// The function to be executed when you enter a link and press OK or Cancel.\n\t\t\t// Marks up the link and adds the ref.\n\t\t\tvar linkEnteredCallback = function(link) {\n\t\t\t\tbackground.parentNode.removeChild(background)\n\n\t\t\t\tif (link !== null) {\n\t\t\t\t\t// (                          $1\n\t\t\t\t\t//     [^\\\\]                  anything that's not a backslash\n\t\t\t\t\t//     (?:\\\\\\\\)*              an even number (this includes zero) of backslashes\n\t\t\t\t\t// )\n\t\t\t\t\t// (?=                        followed by\n\t\t\t\t\t//     [[\\]]                  an opening or closing bracket\n\t\t\t\t\t// )\n\t\t\t\t\t//\n\t\t\t\t\t// In other words, a non-escaped bracket. These have to be escaped now to make sure they\n\t\t\t\t\t// don't count as the end of the link or similar.\n\t\t\t\t\t// Note that the actual bracket has to be a lookahead, because (in case of to subsequent brackets),\n\t\t\t\t\t// the bracket in one match may be the \"not a backslash\" character in the next match, so it\n\t\t\t\t\t// should not be consumed by the first match.\n\t\t\t\t\t// The \"prepend a space and finally remove it\" steps makes sure there is a \"not a backslash\" at the\n\t\t\t\t\t// start of the string, so this also works if the selection begins with a bracket. We cannot solve\n\t\t\t\t\t// this by anchoring with ^, because in the case that the selection starts with two brackets, this\n\t\t\t\t\t// would mean a zero-width match at the start. Since zero-width matches advance the string position,\n\t\t\t\t\t// the first bracket could then not act as the \"not a backslash\" for the second.\n\t\t\t\t\tchunk.selection = (' ' + chunk.selection).replace(/([^\\\\](?:\\\\\\\\)*)(?=[[\\]])/g, '$1\\\\').substr(1)\n\n\t\t\t\t\tvar linkDef = ' [999]: ' + properlyEncoded(link)\n\n\t\t\t\t\tvar num = that.addLinkDef(chunk, linkDef)\n\t\t\t\t\tchunk.startTag = isImage ? '![' : '['\n\t\t\t\t\tchunk.endTag = '][' + num + ']'\n\n\t\t\t\t\tif (!chunk.selection) {\n\t\t\t\t\t\tif (isImage) {\n\t\t\t\t\t\t\tchunk.selection = that.getString('imagedescription')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchunk.selection = that.getString('linkdescription')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpostProcessing()\n\t\t\t}\n\n\t\t\tbackground = ui.createBackground()\n\n\t\t\tif (isImage) {\n\t\t\t\tif (!this.hooks.insertImageDialog(linkEnteredCallback))\n\t\t\t\t\tui.prompt(\n\t\t\t\t\t\tthis.getString('imagedialog'),\n\t\t\t\t\t\timageDefaultText,\n\t\t\t\t\t\tlinkEnteredCallback,\n\t\t\t\t\t\t(files, textInput) => {\n\t\t\t\t\t\t\tif (!files || !files[0]) return\n\n\t\t\t\t\t\t\tconst formData = new FormData()\n\t\t\t\t\t\t\tformData.append('file', files[0])\n\n\t\t\t\t\t\t\ttextInput.value = 'Uploading image...'\n\n\t\t\t\t\t\t\tfetch('/img/', {\n\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\tmode: 'cors',\n\t\t\t\t\t\t\t\tbody: formData,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.then(r => r.text())\n\t\t\t\t\t\t\t\t.then(slug => (textInput.value = `http://${baseApiUrl}/img/${slug}`))\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'image/*'\n\t\t\t\t\t)\n\t\t\t} else {\n\t\t\t\tif (!this.hooks.insertLinkDialog(linkEnteredCallback))\n\t\t\t\t\tui.prompt(this.getString('linkdialog'), linkDefaultText, linkEnteredCallback)\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\t}\n\n\t// When making a list, hitting shift-enter will put your cursor on the next line\n\t// at the current indent level.\n\tcommandProto.doAutoindent = function(chunk, postProcessing) {\n\t\tvar commandMgr = this,\n\t\t\tfakeSelection = false\n\n\t\tchunk.before = chunk.before.replace(/(\\n|^)[ ]{0,3}([*+-]|\\d+[.])[ \\t]*\\n$/, '\\n\\n')\n\t\tchunk.before = chunk.before.replace(/(\\n|^)[ ]{0,3}>[ \\t]*\\n$/, '\\n\\n')\n\t\tchunk.before = chunk.before.replace(/(\\n|^)[ \\t]+\\n$/, '\\n\\n')\n\n\t\t// There's no selection, end the cursor wasn't at the end of the line:\n\t\t// The user wants to split the current list item / code line / blockquote line\n\t\t// (for the latter it doesn't really matter) in two. Temporarily select the\n\t\t// (rest of the) line to achieve this.\n\t\tif (!chunk.selection && !/^[ \\t]*(?:\\n|$)/.test(chunk.after)) {\n\t\t\tchunk.after = chunk.after.replace(/^[^\\n]*/, function(wholeMatch) {\n\t\t\t\tchunk.selection = wholeMatch\n\t\t\t\treturn ''\n\t\t\t})\n\t\t\tfakeSelection = true\n\t\t}\n\n\t\tif (/(\\n|^)[ ]{0,3}([*+-]|\\d+[.])[ \\t]+.*\\n$/.test(chunk.before)) {\n\t\t\tif (commandMgr.doList) {\n\t\t\t\tcommandMgr.doList(chunk)\n\t\t\t}\n\t\t}\n\t\tif (/(\\n|^)[ ]{0,3}>[ \\t]+.*\\n$/.test(chunk.before)) {\n\t\t\tif (commandMgr.doBlockquote) {\n\t\t\t\tcommandMgr.doBlockquote(chunk)\n\t\t\t}\n\t\t}\n\t\tif (/(\\n|^)(\\t|[ ]{4,}).*\\n$/.test(chunk.before)) {\n\t\t\tif (commandMgr.doCode) {\n\t\t\t\tcommandMgr.doCode(chunk)\n\t\t\t}\n\t\t}\n\n\t\tif (fakeSelection) {\n\t\t\tchunk.after = chunk.selection + chunk.after\n\t\t\tchunk.selection = ''\n\t\t}\n\t}\n\n\tcommandProto.doBlockquote = function(chunk, postProcessing) {\n\t\tchunk.selection = chunk.selection.replace(/^(\\n*)([^\\r]+?)(\\n*)$/, function(\n\t\t\ttotalMatch,\n\t\t\tnewlinesBefore,\n\t\t\ttext,\n\t\t\tnewlinesAfter\n\t\t) {\n\t\t\tchunk.before += newlinesBefore\n\t\t\tchunk.after = newlinesAfter + chunk.after\n\t\t\treturn text\n\t\t})\n\n\t\tchunk.before = chunk.before.replace(/(>[ \\t]*)$/, function(totalMatch, blankLine) {\n\t\t\tchunk.selection = blankLine + chunk.selection\n\t\t\treturn ''\n\t\t})\n\n\t\tchunk.selection = chunk.selection.replace(/^(\\s|>)+$/, '')\n\t\tchunk.selection = chunk.selection || this.getString('quoteexample')\n\n\t\t// The original code uses a regular expression to find out how much of the\n\t\t// text *directly before* the selection already was a blockquote:\n\n\t\t/*\n        if (chunk.before) {\n        chunk.before = chunk.before.replace(/\\n?$/, \"\\n\");\n        }\n        chunk.before = chunk.before.replace(/(((\\n|^)(\\n[ \\t]*)*>(.+\\n)*.*)+(\\n[ \\t]*)*$)/,\n        function (totalMatch) {\n        chunk.startTag = totalMatch;\n        return \"\";\n        });\n        */\n\n\t\t// This comes down to:\n\t\t// Go backwards as many lines a possible, such that each line\n\t\t//  a) starts with \">\", or\n\t\t//  b) is almost empty, except for whitespace, or\n\t\t//  c) is preceeded by an unbroken chain of non-empty lines\n\t\t//     leading up to a line that starts with \">\" and at least one more character\n\t\t// and in addition\n\t\t//  d) at least one line fulfills a)\n\t\t//\n\t\t// Since this is essentially a backwards-moving regex, it's susceptible to\n\t\t// catstrophic backtracking and can cause the browser to hang;\n\t\t// see e.g. http://meta.stackoverflow.com/questions/9807.\n\t\t//\n\t\t// Hence we replaced this by a simple state machine that just goes through the\n\t\t// lines and checks for a), b), and c).\n\n\t\tvar match = '',\n\t\t\tleftOver = '',\n\t\t\tline\n\t\tif (chunk.before) {\n\t\t\tvar lines = chunk.before.replace(/\\n$/, '').split('\\n')\n\t\t\tvar inChain = false\n\t\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\t\tvar good = false\n\t\t\t\tline = lines[i]\n\t\t\t\tinChain = inChain && line.length > 0 // c) any non-empty line continues the chain\n\t\t\t\tif (/^>/.test(line)) {\n\t\t\t\t\t// a)\n\t\t\t\t\tgood = true\n\t\t\t\t\tif (!inChain && line.length > 1)\n\t\t\t\t\t\t// c) any line that starts with \">\" and has at least one more character starts the chain\n\t\t\t\t\t\tinChain = true\n\t\t\t\t} else if (/^[ \\t]*$/.test(line)) {\n\t\t\t\t\t// b)\n\t\t\t\t\tgood = true\n\t\t\t\t} else {\n\t\t\t\t\tgood = inChain // c) the line is not empty and does not start with \">\", so it matches if and only if we're in the chain\n\t\t\t\t}\n\t\t\t\tif (good) {\n\t\t\t\t\tmatch += line + '\\n'\n\t\t\t\t} else {\n\t\t\t\t\tleftOver += match + line\n\t\t\t\t\tmatch = '\\n'\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!/(^|\\n)>/.test(match)) {\n\t\t\t\t// d)\n\t\t\t\tleftOver += match\n\t\t\t\tmatch = ''\n\t\t\t}\n\t\t}\n\n\t\tchunk.startTag = match\n\t\tchunk.before = leftOver\n\n\t\t// end of change\n\n\t\t/*benweet Don't really know the purpose of it but it is destructive\n        \n        if (chunk.after) {\n            chunk.after = chunk.after.replace(/^\\n?/, \"\\n\");\n        }\n\n        chunk.after = chunk.after.replace(/^(((\\n|^)(\\n[ \\t]*)*>(.+\\n)*.*)+(\\n[ \\t]*)*)/,\n            function (totalMatch) {\n                chunk.endTag = totalMatch;\n                return \"\";\n            }\n        );\n        */\n\n\t\tvar replaceBlanksInTags = function(useBracket) {\n\t\t\tvar replacement = useBracket ? '> ' : ''\n\n\t\t\tif (chunk.startTag) {\n\t\t\t\tchunk.startTag = chunk.startTag.replace(/\\n((>|\\s)*)\\n$/, function(totalMatch, markdown) {\n\t\t\t\t\treturn '\\n' + markdown.replace(/^[ ]{0,3}>?[ \\t]*$/gm, replacement) + '\\n'\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (chunk.endTag) {\n\t\t\t\tchunk.endTag = chunk.endTag.replace(/^\\n((>|\\s)*)\\n/, function(totalMatch, markdown) {\n\t\t\t\t\treturn '\\n' + markdown.replace(/^[ ]{0,3}>?[ \\t]*$/gm, replacement) + '\\n'\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (/^(?![ ]{0,3}>)/m.test(chunk.selection)) {\n\t\t\tthis.wrap(chunk, SETTINGS.lineLength - 2)\n\t\t\tchunk.selection = chunk.selection.replace(/^/gm, '> ')\n\t\t\treplaceBlanksInTags(true)\n\t\t\tchunk.skipLines()\n\t\t} else {\n\t\t\tchunk.selection = chunk.selection.replace(/^[ ]{0,3}> ?/gm, '')\n\t\t\tthis.unwrap(chunk)\n\t\t\treplaceBlanksInTags(false)\n\n\t\t\tif (!/^(\\n|^)[ ]{0,3}>/.test(chunk.selection) && chunk.startTag) {\n\t\t\t\tchunk.startTag = chunk.startTag.replace(/\\n{0,2}$/, '\\n\\n')\n\t\t\t}\n\n\t\t\tif (!/(\\n|^)[ ]{0,3}>.*$/.test(chunk.selection) && chunk.endTag) {\n\t\t\t\tchunk.endTag = chunk.endTag.replace(/^\\n{0,2}/, '\\n\\n')\n\t\t\t}\n\t\t}\n\n\t\tchunk.selection = this.hooks.postBlockquoteCreation(chunk.selection)\n\n\t\tif (!/\\n/.test(chunk.selection)) {\n\t\t\tchunk.selection = chunk.selection.replace(/^(> *)/, function(wholeMatch, blanks) {\n\t\t\t\tchunk.startTag += blanks\n\t\t\t\treturn ''\n\t\t\t})\n\t\t}\n\t}\n\n\tcommandProto.doCode = function(chunk, postProcessing) {\n\t\tvar hasTextBefore = /\\S[ ]*$/.test(chunk.before)\n\t\tvar hasTextAfter = /^[ ]*\\S/.test(chunk.after)\n\n\t\t// Use 'four space' markdown if the selection is on its own\n\t\t// line or is multiline.\n\t\tif ((!hasTextAfter && !hasTextBefore) || /\\n/.test(chunk.selection)) {\n\t\t\tchunk.before = chunk.before.replace(/[ ]{4}$/, function(totalMatch) {\n\t\t\t\tchunk.selection = totalMatch + chunk.selection\n\t\t\t\treturn ''\n\t\t\t})\n\n\t\t\tvar nLinesBack = 1\n\t\t\tvar nLinesForward = 1\n\n\t\t\tif (/(\\n|^)(\\t|[ ]{4,}).*\\n$/.test(chunk.before)) {\n\t\t\t\tnLinesBack = 0\n\t\t\t}\n\t\t\tif (/^\\n(\\t|[ ]{4,})/.test(chunk.after)) {\n\t\t\t\tnLinesForward = 0\n\t\t\t}\n\n\t\t\tchunk.skipLines(nLinesBack, nLinesForward)\n\n\t\t\tif (!chunk.selection) {\n\t\t\t\tchunk.startTag = '    '\n\t\t\t\tchunk.selection = this.getString('codeexample')\n\t\t\t} else {\n\t\t\t\tif (/^[ ]{0,3}\\S/m.test(chunk.selection)) {\n\t\t\t\t\tif (/\\n/.test(chunk.selection)) chunk.selection = chunk.selection.replace(/^/gm, '    ')\n\t\t\t\t\t// if it's not multiline, do not select the four added spaces; this is more consistent with the doList behavior\n\t\t\t\t\telse chunk.before += '    '\n\t\t\t\t} else {\n\t\t\t\t\tchunk.selection = chunk.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\\t)/gm, '')\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Use backticks (`) to delimit the code block.\n\n\t\t\tchunk.trimWhitespace()\n\t\t\tchunk.findTags(/`/, /`/)\n\n\t\t\tif (!chunk.startTag && !chunk.endTag) {\n\t\t\t\tchunk.startTag = chunk.endTag = '`'\n\t\t\t\tif (!chunk.selection) {\n\t\t\t\t\tchunk.selection = this.getString('codeexample')\n\t\t\t\t}\n\t\t\t} else if (chunk.endTag && !chunk.startTag) {\n\t\t\t\tchunk.before += chunk.endTag\n\t\t\t\tchunk.endTag = ''\n\t\t\t} else {\n\t\t\t\tchunk.startTag = chunk.endTag = ''\n\t\t\t}\n\t\t}\n\t}\n\n\tcommandProto.doList = function(chunk, postProcessing, isNumberedList) {\n\t\t// These are identical except at the very beginning and end.\n\t\t// Should probably use the regex extension function to make this clearer.\n\t\tvar previousItemsRegex = /(\\n|^)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+.*)(\\n.+|\\n{2,}([*+-].*|\\d+[.])[ \\t]+.*|\\n{2,}[ \\t]+\\S.*)*)\\n*$/\n\t\tvar nextItemsRegex = /^\\n*(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+.*)(\\n.+|\\n{2,}([*+-].*|\\d+[.])[ \\t]+.*|\\n{2,}[ \\t]+\\S.*)*)\\n*/\n\n\t\t// The default bullet is a dash but others are possible.\n\t\t// This has nothing to do with the particular HTML bullet,\n\t\t// it's just a markdown bullet.\n\t\tvar bullet = '-'\n\n\t\t// The number in a numbered list.\n\t\tvar num = 1\n\n\t\t// Get the item prefix - e.g. \" 1. \" for a numbered list, \" - \" for a bulleted list.\n\t\tvar getItemPrefix = function() {\n\t\t\tvar prefix\n\t\t\tif (isNumberedList) {\n\t\t\t\tprefix = ' ' + num + '. '\n\t\t\t\tnum++\n\t\t\t} else {\n\t\t\t\tprefix = ' ' + bullet + ' '\n\t\t\t}\n\t\t\treturn prefix\n\t\t}\n\n\t\t// Fixes the prefixes of the other list items.\n\t\tvar getPrefixedItem = function(itemText) {\n\t\t\t// The numbering flag is unset when called by autoindent.\n\t\t\tif (isNumberedList === undefined) {\n\t\t\t\tisNumberedList = /^\\s*\\d/.test(itemText)\n\t\t\t}\n\n\t\t\t// Renumber/bullet the list element.\n\t\t\titemText = itemText.replace(/^[ ]{0,3}([*+-]|\\d+[.])\\s/gm, function(_) {\n\t\t\t\treturn getItemPrefix()\n\t\t\t})\n\n\t\t\treturn itemText\n\t\t}\n\n\t\tchunk.findTags(/(\\n|^)*[ ]{0,3}([*+-]|\\d+[.])\\s+/, null)\n\n\t\tif (chunk.before && !/\\n$/.test(chunk.before) && !/^\\n/.test(chunk.startTag)) {\n\t\t\tchunk.before += chunk.startTag\n\t\t\tchunk.startTag = ''\n\t\t}\n\n\t\tif (chunk.startTag) {\n\t\t\tvar hasDigits = /\\d+[.]/.test(chunk.startTag)\n\t\t\tchunk.startTag = ''\n\t\t\tchunk.selection = chunk.selection.replace(/\\n[ ]{4}/g, '\\n')\n\t\t\tthis.unwrap(chunk)\n\t\t\tchunk.skipLines()\n\n\t\t\tif (hasDigits) {\n\t\t\t\t// Have to renumber the bullet points if this is a numbered list.\n\t\t\t\tchunk.after = chunk.after.replace(nextItemsRegex, getPrefixedItem)\n\t\t\t}\n\t\t\tif (isNumberedList == hasDigits) {\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tvar nLinesUp = 1\n\n\t\tchunk.before = chunk.before.replace(previousItemsRegex, function(itemText) {\n\t\t\tif (/^\\s*([*+-])/.test(itemText)) {\n\t\t\t\tbullet = re.$1\n\t\t\t}\n\t\t\tnLinesUp = /[^\\n]\\n\\n[^\\n]/.test(itemText) ? 1 : 0\n\t\t\treturn getPrefixedItem(itemText)\n\t\t})\n\n\t\tif (!chunk.selection) {\n\t\t\tchunk.selection = this.getString('litem')\n\t\t}\n\n\t\tvar prefix = getItemPrefix()\n\n\t\tvar nLinesDown = 1\n\n\t\tchunk.after = chunk.after.replace(nextItemsRegex, function(itemText) {\n\t\t\tnLinesDown = /[^\\n]\\n\\n[^\\n]/.test(itemText) ? 1 : 0\n\t\t\treturn getPrefixedItem(itemText)\n\t\t})\n\n\t\tchunk.trimWhitespace(true)\n\t\tchunk.skipLines(nLinesUp, nLinesDown, true)\n\t\tchunk.startTag = prefix\n\t\tvar spaces = prefix.replace(/./g, ' ')\n\t\tthis.wrap(chunk, SETTINGS.lineLength - spaces.length)\n\t\tchunk.selection = chunk.selection.replace(/\\n/g, '\\n' + spaces)\n\t}\n\n\tcommandProto.doHeading = function(chunk, postProcessing) {\n\t\t// Remove leading/trailing whitespace and reduce internal spaces to single spaces.\n\t\tchunk.selection = chunk.selection.replace(/\\s+/g, ' ')\n\t\tchunk.selection = chunk.selection.replace(/(^\\s+|\\s+$)/g, '')\n\n\t\t// If we clicked the button with no selected text, we just\n\t\t// make a level 2 hash header around some default text.\n\t\tif (!chunk.selection) {\n\t\t\tchunk.startTag = '## '\n\t\t\tchunk.selection = this.getString('headingexample')\n\t\t\tchunk.endTag = ' ##'\n\t\t\treturn\n\t\t}\n\n\t\tvar headerLevel = 0 // The existing header level of the selected text.\n\n\t\t// Remove any existing hash heading markdown and save the header level.\n\t\tchunk.findTags(/#+[ ]*/, /[ ]*#+/)\n\t\tif (/#+/.test(chunk.startTag)) {\n\t\t\theaderLevel = re.lastMatch.length\n\t\t}\n\t\tchunk.startTag = chunk.endTag = ''\n\n\t\t// Try to get the current header level by looking for - and = in the line\n\t\t// below the selection.\n\t\tchunk.findTags(null, /\\s?(-+|=+)/)\n\t\tif (/=+/.test(chunk.endTag)) {\n\t\t\theaderLevel = 1\n\t\t}\n\t\tif (/-+/.test(chunk.endTag)) {\n\t\t\theaderLevel = 2\n\t\t}\n\n\t\t// Skip to the next line so we can create the header markdown.\n\t\tchunk.startTag = chunk.endTag = ''\n\t\tchunk.skipLines(1, 1)\n\n\t\t// We make a level 2 header if there is no current header.\n\t\t// If there is a header level, we substract one from the header level.\n\t\t// If it's already a level 1 header, it's removed.\n\t\tvar headerLevelToCreate = headerLevel == 0 ? 2 : headerLevel - 1\n\n\t\tif (headerLevelToCreate > 0) {\n\t\t\t// The button only creates level 1 and 2 underline headers.\n\t\t\t// Why not have it iterate over hash header levels?  Wouldn't that be easier and cleaner?\n\t\t\tvar headerChar = headerLevelToCreate >= 2 ? '-' : '='\n\t\t\tvar len = chunk.selection.length\n\t\t\tif (len > SETTINGS.lineLength) {\n\t\t\t\tlen = SETTINGS.lineLength\n\t\t\t}\n\t\t\tchunk.endTag = '\\n'\n\t\t\twhile (len--) {\n\t\t\t\tchunk.endTag += headerChar\n\t\t\t}\n\t\t}\n\t}\n\n\tcommandProto.doHorizontalRule = function(chunk, postProcessing) {\n\t\tchunk.startTag = '----------\\n'\n\t\tchunk.selection = ''\n\t\tchunk.skipLines(2, 1, true)\n\t}\n\n\tcommandProto.doTable = function(chunk, postProcessing) {\n\t\tchunk.startTag = `|  |  |  |\n|--|--|--|\n|  |  |  |`\n\t\tchunk.selection = ''\n\t}\n})()\n\nexport default Markdown\n","import CodeMirror from 'codemirror'\nimport 'codemirror/mode/markdown/markdown'\nimport 'codemirror/addon/mode/overlay'\n\nvar urlRE = /^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\\.beep|\\.lwz|\\.xpc|\\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\\.beeps?|xmpp|xri|ymsgr|z39\\.50[rs]?):(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]|\\([^\\s()<>]*\\))+(?:\\([^\\s()<>]*\\)|[^\\s`*!()\\[\\]{};:'\".,<>?«»“”‘’]))/i\n\nCodeMirror.defineMode(\n\t'gfm',\n\tfunction(config, modeConfig) {\n\t\tvar codeDepth = 0\n\t\tfunction blankLine(state) {\n\t\t\tstate.code = false\n\t\t\treturn null\n\t\t}\n\t\tvar gfmOverlay = {\n\t\t\tstartState: function() {\n\t\t\t\treturn {\n\t\t\t\t\tcode: false,\n\t\t\t\t\tcodeBlock: false,\n\t\t\t\t\tateSpace: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tcopyState: function(s) {\n\t\t\t\treturn {\n\t\t\t\t\tcode: s.code,\n\t\t\t\t\tcodeBlock: s.codeBlock,\n\t\t\t\t\tateSpace: s.ateSpace,\n\t\t\t\t}\n\t\t\t},\n\t\t\ttoken: function(stream, state) {\n\t\t\t\tstate.combineTokens = null\n\n\t\t\t\t// Hack to prevent formatting override inside code blocks (block and inline)\n\t\t\t\tif (state.codeBlock) {\n\t\t\t\t\tif (stream.match(/^````+/) || stream.match(/^\\|.*/)) {\n\t\t\t\t\t\tstate.codeBlock = false\n\t\t\t\t\t\treturn null\n\t\t\t\t\t}\n\t\t\t\t\tstream.skipToEnd()\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tif (stream.sol()) {\n\t\t\t\t\tstate.code = false\n\t\t\t\t}\n                if (stream.sol() && (stream.match(/^````+/) || stream.match(/^\\|.*/))) {\n\t\t\t\t\tstream.skipToEnd()\n\t\t\t\t\tstate.codeBlock = true\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\t// If this block is changed, it may need to be updated in Markdown mode\n\t\t\t\tif (stream.peek() === '`') {\n\t\t\t\t\tstream.next()\n\t\t\t\t\tvar before = stream.pos\n\t\t\t\t\tstream.eatWhile('`')\n\t\t\t\t\tvar difference = 1 + stream.pos - before\n\t\t\t\t\tif (!state.code) {\n\t\t\t\t\t\tcodeDepth = difference\n\t\t\t\t\t\tstate.code = true\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (difference === codeDepth) {\n\t\t\t\t\t\t\t// Must be exact\n\t\t\t\t\t\t\tstate.code = false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null\n\t\t\t\t} else if (state.code) {\n\t\t\t\t\tstream.next()\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\t// Check if space. If so, links can be formatted later on\n\t\t\t\tif (stream.eatSpace()) {\n\t\t\t\t\tstate.ateSpace = true\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tif (stream.sol() || state.ateSpace) {\n\t\t\t\t\tstate.ateSpace = false\n\t\t\t\t\tif (modeConfig.gitHubSpice !== false) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstream.match(/^(?:[a-zA-Z0-9\\-_]+\\/)?(?:[a-zA-Z0-9\\-_]+@)?(?=.{0,6}\\d)(?:[a-f0-9]{7,40}\\b)/)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// User/Project@SHA\n\t\t\t\t\t\t\t// User@SHA\n\t\t\t\t\t\t\t// SHA\n\t\t\t\t\t\t\tstate.combineTokens = true\n\t\t\t\t\t\t\treturn 'link'\n\t\t\t\t\t\t} else if (stream.match(/^(?:[a-zA-Z0-9\\-_]+\\/)?(?:[a-zA-Z0-9\\-_]+)?#[0-9]+\\b/)) {\n\t\t\t\t\t\t\t// User/Project#Num\n\t\t\t\t\t\t\t// User#Num\n\t\t\t\t\t\t\t// #Num\n\t\t\t\t\t\t\tstate.combineTokens = true\n\t\t\t\t\t\t\treturn 'link'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tstream.match(urlRE) &&\n\t\t\t\t\tstream.string.slice(stream.start - 2, stream.start) != '](' &&\n\t\t\t\t\t(stream.start == 0 || /\\W/.test(stream.string.charAt(stream.start - 1)))\n\t\t\t\t) {\n\t\t\t\t\t// URLs\n\t\t\t\t\t// Taken from http://daringfireball.net/2010/07/improved_regex_for_matching_urls\n\t\t\t\t\t// And then (issue #1160) simplified to make it not crash the Chrome Regexp engine\n\t\t\t\t\t// And then limited url schemes to the CommonMark list, so foo:bar isn't matched as a URL\n\t\t\t\t\tstate.combineTokens = true\n\t\t\t\t\treturn 'link'\n\t\t\t\t}\n\t\t\t\tstream.next()\n\t\t\t\treturn null\n\t\t\t},\n\t\t\tblankLine: blankLine,\n\t\t}\n\n\t\tvar markdownConfig = {\n\t\t\ttaskLists: true,\n\t\t\tstrikethrough: true,\n\t\t\temoji: true,\n\t\t}\n\t\tfor (var attr in modeConfig) {\n\t\t\tmarkdownConfig[attr] = modeConfig[attr]\n\t\t}\n\t\tmarkdownConfig.name = 'markdown'\n\t\treturn CodeMirror.overlayMode(CodeMirror.getMode(config, markdownConfig), gfmOverlay)\n\t},\n\t'markdown'\n)\n\nCodeMirror.defineMIME('text/x-gfm', 'gfm')\n","import React, { useLayoutEffect, useRef } from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport styled from 'styled-components'\nimport otText from 'ot-text'\nimport ShareDB from 'sharedb/lib/client'\nimport io from 'socket.io-client'\n\nimport { setCmInstance } from '../../actions/editor'\nimport { baseApiUrl } from '../../config/constants'\n\nimport { default as PagedownConverter } from '../../vendor/Markdown.Converter'\nimport { default as PagedownEditor } from '../../vendor/Markdown.Editor'\n\nimport CodeMirror from 'codemirror'\n//import 'codemirror/mode/gfm/gfm'\nimport '../../vendor/modifiedGfm'\nimport 'codemirror/mode/javascript/javascript'\nimport 'codemirror/mode/css/css'\nimport 'codemirror/mode/clike/clike'\nimport '../../static/css/CodeMirrorStyle.css'\n\nconst FakeButtonsElement = styled.div`\n\tdisplay: none;\n`\n\nconst UserList = styled.ul`\n\tlist-style: none;\n\tmargin: 0;\n\t& li {\n\t\tmargin: 2px;\n\t\tcolor: white;\n\t\tfloat: right;\n\t\ttext-align: center;\n\t\tline-height: 25px;\n\t\timg {\n\t\t\twidth: 25px;\n\t\t\theight: 25px;\n\t\t\tborder-radius: 50%;\n\t\t}\n\t}\n`\n\nconst Editor = ({ user, setCmInstance, match, history }) => {\n\tconst editorRef = useRef()\n\tconst userListRef = useRef()\n\n\tconst currentFile =\n\t\tmatch.params.nameHash === '404'\n\t\t\t? { nameHash: 404, name: '404' }\n\t\t\t: [...user.ownFiles, ...user.secondFiles].find(file => file.nameHash === match.params.nameHash) || {}\n\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (user.ownFiles.length && match.params.nameHash && !currentFile.nameHash) history.push('/404')\n\t\t},\n\t\t[user, match.params.nameHash, currentFile]\n\t)\n\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tconst pagedownConverter = new PagedownConverter.Converter()\n\t\t\tconst pagedownEditor = new PagedownEditor.Editor(pagedownConverter)\n\t\t\tconst codeMirror = CodeMirror.fromTextArea(editorRef.current, {\n\t\t\t\tvalue: '',\n\t\t\t\tmode: {\n\t\t\t\t\tname: 'markdown',\n\t\t\t\t\thighlightFormatting: true,\n\t\t\t\t\tmaxBlockquoteDepth: 3,\n\t\t\t\t\tfencedCodeBlockHighlighting: true,\n\t\t\t\t},\n\t\t\t\tshared: true,\n\t\t\t\tlineWrapping: true,\n\t\t\t})\n\t\t\tpagedownEditor.run(codeMirror)\n\t\t\tconst doClick = name =>\n\t\t\t\tpagedownEditor.uiManager.buttons[name] && pagedownEditor.uiManager.buttons[name].onclick()\n\t\t\tsetCmInstance({ codeMirror, doClick })\n\n\t\t\tif (match.params.nameHash === '404')\n\t\t\t\tcodeMirror.setValue(`Don't panic\n=========\n### Page not found\n\nLooks like you have opened a wrong url or the file no longer exists\n\nIf not, we're probably already working on resolving the issue`)\n\n\t\t\tif (!currentFile.nameHash || match.params.nameHash === '404') return codeMirror.toTextArea\n\n\t\t\tlet stopWatch = false\n\n\t\t\tShareDB.types.register(otText.type)\n\n\t\t\tconst sharews = new WebSocket(`ws://${baseApiUrl}`)\n\t\t\tconst shareconn = new ShareDB.Connection(sharews)\n\t\t\tconst sharedoc = shareconn.get('docs', currentFile.nameHash)\n\t\t\t/*\n            sharedoc.fetch(function(err) {\n                if (err) throw err\n                console.log('asdf', sharedoc.type)\n                if (sharedoc.type === null) {\n                    sharedoc.create('', 'text')\n                }\n            })\n            */\n\t\t\tcodeMirror.on('change', (ed, chg) => {\n\t\t\t\tif (stopWatch) return\n\n\t\t\t\tconst stindex = ed.indexFromPos(chg.from)\n\t\t\t\tconst delta = chg.removed.join('\\n').length\n\t\t\t\tconst addedText = chg.text.join('\\n')\n\n\t\t\t\ttry {\n\t\t\t\t\tif (delta) sharedoc.submitOp([stindex, { d: delta }])\n\t\t\t\t\tif (addedText) sharedoc.submitOp([stindex, addedText])\n\t\t\t\t} catch (err) {\n\t\t\t\t\thistory.push('/404')\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tcodeMirror.on('cursorActivity', () => {\n\t\t\t\tconst stPos = codeMirror.getCursor('start')\n\t\t\t\tconst edPos = codeMirror.getCursor('end')\n\t\t\t\tconst hdPos = codeMirror.getCursor('head')\n\n\t\t\t\tconst stindex = codeMirror.indexFromPos(stPos)\n\t\t\t\tconst edindex = codeMirror.indexFromPos(edPos)\n\t\t\t\tconst hdindex = codeMirror.indexFromPos(hdPos)\n\t\t\t\tconst prefixed = hdindex === stindex && stindex !== edindex\n\n\t\t\t\tsocket.emit('anchor-update', { stindex, edindex, prefixed })\n\t\t\t})\n\n\t\t\tsharedoc.subscribe(() => {\n\t\t\t\tstopWatch = true\n\n\t\t\t\tcodeMirror.setValue(sharedoc.data || '')\n\t\t\t\tcodeMirror.setCursor(0, 0)\n\t\t\t\tcodeMirror.focus()\n\t\t\t\tstopWatch = false\n\t\t\t})\n\n\t\t\tsharedoc.on('op', (op, mine) => {\n\t\t\t\tif (mine) return\n\t\t\t\tconst index = op.length === 2 ? op[0] : 0\n\t\t\t\tconst data = op.length === 2 ? op[1] : op[0]\n\n\t\t\t\tif (typeof data === 'string') {\n\t\t\t\t\tconst pos = codeMirror.posFromIndex(index)\n\n\t\t\t\t\tstopWatch = true\n\t\t\t\t\tcodeMirror.replaceRange(data, pos, pos)\n\t\t\t\t\tstopWatch = false\n\t\t\t\t} else {\n\t\t\t\t\tconst delCt = data.d\n\t\t\t\t\tconst stPos = codeMirror.posFromIndex(index)\n\t\t\t\t\tconst edPos = codeMirror.posFromIndex(index + delCt)\n\t\t\t\t\t// const range = { start: stPos, end: edPos }\n\n\t\t\t\t\tstopWatch = true\n\t\t\t\t\tcodeMirror.replaceRange('', stPos, edPos)\n\t\t\t\t\tstopWatch = false\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tconst addName = (id, photoURL) => {\n\t\t\t\tconst userslist = userListRef.current\n\t\t\t\tconst usericon = document.createElement('li')\n\t\t\t\tusericon.classList.add(`u-${id}`)\n\t\t\t\tusericon.innerHTML = `<img src=\"${photoURL}\" alt=\"\" />`\n\t\t\t\tuserslist.appendChild(usericon)\n\n\t\t\t\tconst color = idToColor(id)\n\t\t\t\tconst styleTag = document.createElement('style')\n\t\t\t\tstyleTag.id = `style-${id}`\n\t\t\t\tstyleTag.innerHTML = `\n                .CodeMirror-line .u-${id}                   { background-color: ${hexToRgbaStyle(color, 0.35)}; }\n                .CodeMirror-line .u-${id}.cursor            { opacity: 1; }\n                .CodeMirror-line .u-${id}.cursor.left       { border-left: 2px solid ${color}; }\n                .CodeMirror-line .u-${id}.cursor.right      { border-right: 2px solid ${color}; }\n                .CodeMirror-line .u-${id}.empty             { background-color: transparent; }\n\n            `\n\t\t\t\tdocument.querySelector('head').appendChild(styleTag)\n\t\t\t}\n\n\t\t\tconst anchorMap = {}\n\t\t\tconst setAnchor = (id, anchor) => {\n\t\t\t\tif (id in anchorMap) {\n\t\t\t\t\tanchorMap[id].forEach(m => m.clear())\n\t\t\t\t\tdelete anchorMap[id]\n\t\t\t\t}\n\n\t\t\t\t// Whether or not the cursor is actually at the beginning\n\t\t\t\t// or end of the selection\n\t\t\t\tlet emptyClass = ''\n\t\t\t\tlet stindex = anchor.stindex\n\t\t\t\tconst edindex = anchor.edindex\n\n\t\t\t\t// Add selection\n\t\t\t\tlet stPos, edPos\n\t\t\t\tanchorMap[id] = []\n\n\t\t\t\tif (stindex !== edindex) {\n\t\t\t\t\tstPos = codeMirror.posFromIndex(stindex)\n\t\t\t\t\tedPos = codeMirror.posFromIndex(edindex)\n\n\t\t\t\t\tanchorMap[id].push(codeMirror.markText(stPos, edPos, { className: `u-${id}` }))\n\t\t\t\t}\n\n\t\t\t\tif (stindex === edindex) {\n\t\t\t\t\tstindex = Math.max(0, stindex - 1)\n\t\t\t\t\temptyClass = 'empty'\n\t\t\t\t}\n\n\t\t\t\t// Add cursor\n\t\t\t\tconst index = anchor.prefixed ? stindex : edindex\n\t\t\t\tstPos = codeMirror.posFromIndex(index + (anchor.prefixed ? 0 : -1))\n\t\t\t\tedPos = codeMirror.posFromIndex(index + (anchor.prefixed ? 1 : 0))\n\n\t\t\t\tanchorMap[id].push(\n\t\t\t\t\tcodeMirror.markText(stPos, edPos, {\n\t\t\t\t\t\tclassName: `u-${id} ${emptyClass} cursor ${anchor.prefixed ? 'left' : 'right'}`,\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tconst removeId = id => {\n\t\t\t\tuserListRef.current.querySelector(`li.u-${id}`).remove()\n\t\t\t\tdocument.querySelector(`#style-${id}`).remove()\n\t\t\t\tif (id in anchorMap) {\n\t\t\t\t\tanchorMap[id].forEach(m => m.clear())\n\t\t\t\t\tdelete anchorMap[id]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst idToColor = id => {\n\t\t\t\tlet total = 0\n\t\t\t\tfor (let c of id) total += c.charCodeAt(0)\n\n\t\t\t\tlet hex = total.toString(16)\n\t\t\t\twhile (hex.length < 3) hex += hex[hex.length - 1]\n\t\t\t\thex = hex.substr(0, 3)\n\n\t\t\t\tlet color = '#'\n\t\t\t\tfor (let c of hex) color += `${c}0`\n\n\t\t\t\treturn color\n\t\t\t}\n\n\t\t\tconst hexToRgbaStyle = (hex, opacity) => {\n\t\t\t\thex = hex.replace('#', '')\n\t\t\t\tlet r, g, b\n\t\t\t\tif (hex.length === 3) {\n\t\t\t\t\tr = hex[0] + hex[0]\n\t\t\t\t\tg = hex[1] + hex[1]\n\t\t\t\t\tb = hex[2] + hex[2]\n\t\t\t\t} else {\n\t\t\t\t\tr = hex.substr(0, 2)\n\t\t\t\t\tg = hex.substr(2, 2)\n\t\t\t\t\tb = hex.substr(4, 2)\n\t\t\t\t}\n\n\t\t\t\tr = parseInt(r, 16)\n\t\t\t\tg = parseInt(g, 16)\n\t\t\t\tb = parseInt(b, 16)\n\n\t\t\t\treturn `rgba(${r},${g},${b},${opacity})`\n\t\t\t}\n\n\t\t\tconst clearAll = () => {\n\t\t\t\tfor (let key in anchorMap) removeId(key)\n\t\t\t}\n\n\t\t\tconst socket = io(`http://${baseApiUrl}`,{transports: ['polling']})\n\t\t\tsocket.on('connect', () => {\n\t\t\t\tsocket.emit('joinRoom', currentFile.nameHash)\n\n\t\t\t\tsocket.on('disconnect', () => clearAll())\n\n\t\t\t\tsocket.once('initialize', e => {\n\t\t\t\t\tfor (let id in e.anchors) socket.id !== id && setAnchor(id, e.anchors[id])\n\t\t\t\t\tfor (let id in e.names) {\n\t\t\t\t\t\tsocket.id !== id && addName(id, e.names[id])\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tsocket.on('anchor-update', e => {\n\t\t\t\t\tif (socket.id === e.id) return\n\n\t\t\t\t\tsetAnchor(e.id, e.anchor)\n\t\t\t\t})\n\t\t\t\tsocket.on('id-join', e => {\n\t\t\t\t\tif (socket.id === e.id) return\n\n\t\t\t\t\taddName(e.id, e.name)\n\t\t\t\t\tsetAnchor(e.id, e.anchor)\n\t\t\t\t})\n\t\t\t\tsocket.on('id-left', e => {\n\t\t\t\t\tif (socket.id === e.id) return\n\n\t\t\t\t\tremoveId(e.id)\n\t\t\t\t})\n\t\t\t})\n\t\t\treturn () => {\n\t\t\t\tsharedoc.destroy()\n\t\t\t\tsocket.disconnect()\n\t\t\t\tcodeMirror.toTextArea()\n\t\t\t}\n\t\t},\n\t\t[currentFile.nameHash]\n\t)\n\n\treturn (\n\t\t<>\n\t\t\t<UserList ref={userListRef} />\n\t\t\t<textarea ref={editorRef} />\n\t\t\t<FakeButtonsElement id=\"wmd-button-bar\" />\n\t\t</>\n\t)\n}\n\nconst mapStateToProps = ({ editor: { codeMirror }, user }) => ({ codeMirror, user })\n\nconst mapDispatchToProps = { setCmInstance }\n\nexport default withRouter(\n\tconnect(\n\t\tmapStateToProps,\n\t\tmapDispatchToProps\n\t)(Editor)\n)\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\"\n});\n\nvar SvgVisibilityOn = function SvgVisibilityOn(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgVisibilityOn, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/visibility-on.9440d095.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z\"\n});\n\nvar SvgVisibilityOff = function SvgVisibilityOff(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgVisibilityOff, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/visibility-off.4a19fae5.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport Editor from '../Editor/Editor'\nimport ReactMarkdown from 'react-markdown'\n\nimport { toggleRenderMarkdown } from '../../actions/renderMarkdown'\n\nimport { ReactComponent as VisibilityOn } from '../../icons/visibility-on.svg'\nimport { ReactComponent as VisibilityOff } from '../../icons/visibility-off.svg'\n\nconst Wrapper = styled.div`\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n`\n\nconst StyledPaper = styled.div`\n\tmargin-top: 40px;\n\twidth: calc(var(--container-width) - 60px);\n\tpadding: 30px;\n\tbackground-color: white;\n\tbox-shadow: 10px 20px 20px rgba(0, 0, 0, 0.25);\n\t@media (max-width: 1160px) {\n\t\ttransform: translateX(${({ mobileSidebarOpen }) => (mobileSidebarOpen ? 100 : 0)}%);\n\t\ttransition: transform 0.5s;\n\t}\n`\n\nconst VisibilityWrapper = styled.div`\n\tdisplay: ${props => (props.visible ? 'block' : 'none')};\n`\n\nconst MarkdownRenderWrapper = styled.div`\n\tmin-height: calc(100vh - 188px);\n\tpadding: 14px;\n\toverflow-wrap: break-word;\n`\n\nconst RenderButton = styled.div`\n\tposition: fixed;\n\twidth: 0;\n\theight: 0;\n\ttop: 60px;\n\tright: 0;\n\tborder: 40px solid rgba(0, 0, 0, 0.1);\n\tborder-bottom-color: transparent;\n\tborder-left-color: transparent;\n\tcursor: pointer;\n\tz-index: 2;\n\t&::after {\n\t\tcontent: '';\n\t\tclear: both;\n\t}\n\tsvg {\n\t\tposition: absolute;\n\t\tmargin-left: 5px;\n\t\tmargin-top: -30px;\n\t\tcolor: var(--c-darkgrey-bg);\n\t}\n`\n\nconst Paper = ({ renderMarkdown, toggleRenderMarkdown, mobileSidebarOpen, codeMirror }) => (\n\t<Wrapper>\n\t\t<RenderButton onClick={toggleRenderMarkdown}>\n\t\t\t{renderMarkdown ? <VisibilityOff /> : <VisibilityOn />}\n\t\t</RenderButton>\n\t\t<StyledPaper mobileSidebarOpen={mobileSidebarOpen}>\n\t\t\t<VisibilityWrapper visible={!renderMarkdown}>\n\t\t\t\t<Editor />\n\t\t\t</VisibilityWrapper>\n\t\t\t<VisibilityWrapper visible={renderMarkdown}>\n\t\t\t\t<MarkdownRenderWrapper>\n\t\t\t\t\t<ReactMarkdown source={codeMirror.doc && codeMirror.doc.getValue()} />\n\t\t\t\t</MarkdownRenderWrapper>\n\t\t\t</VisibilityWrapper>\n\t\t</StyledPaper>\n\t</Wrapper>\n)\n\nconst mapStateToProps = ({ renderMarkdown, editor: { codeMirror } }) => ({ renderMarkdown, codeMirror })\n\nconst mapDispatchToProps = { toggleRenderMarkdown }\n\nexport default withRouter(\n\tconnect(\n\t\tmapStateToProps,\n\t\tmapDispatchToProps\n\t)(Paper)\n)\n","import React, { createContext, useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { createGlobalStyle } from 'styled-components'\n\nimport Toolbar from '../Toolbar/Toolbar'\nimport Sidebar from '../Sidebar/Sidebar'\nimport Paper from '../Paper/Paper'\nimport { mobileMediaQuery } from '../../config/constants'\n\nimport { requestUserData } from '../../actions/user'\n\nconst GlobalStyle = createGlobalStyle`\n\t* {\n        margin: 0;\n        padding: 0;\n\t}\n    body {\n        font-family: Roboto;\n\t\tbackground-color: var(--c-lightgrey-bg);\n\t\tpadding-top: 60px;\n        @media (max-width: 1160px) {\n            padding-bottom: 100px;\n        }\n    }\n\n    body, html{\n        overflow-x: hidden;\n    }\n\n    :root {\n        font-size: 18px;\n\n        --container-width: 1200px;\n        --max-width: 1700px;\n\t\n        --c-lightgrey-bg: #eee;\n\t\t--c-darkgrey-bg: #3E3E3E;\n\t\t--c-white-hl: rgba(255, 255, 255, 0.65);\n\t\t--c-blue-hl: #00B2FF;\n        --c-red-hl: rgba(255, 0, 0, 0.46);\n        --c-lightgrey-text: #eee;\n\t\t--c-grey-text: #B9B9B9;\n        --c-darkgrey-text: #555;\n\n\t\t@media (max-width: 1920px) {\n\t\t\t--container-width: 60%;\n\t\t\t--max-width: calc(60% + 500px);\n\t\t}\n\t\t@media (max-width: 1680px) {\n\t\t\t--container-width: 70%;\n\t\t\t--max-width: 100%;\n\t\t}\n        @media (max-width: 1160px) {\n            --container-width: calc(100% - 40px);\n            --max-width: 100%;\n        }\n    }\n`\n\nexport const IsMobileContext = createContext()\n\nconst App = ({ requestUserData }) => {\n\tconst mobileState = useState(matchMedia(mobileMediaQuery).matches)\n\tconst [mobileSidebarOpen, toggleMobileSidebar] = useState(false)\n\n\tuseEffect(() => {\n\t\trequestUserData()\n\t}, [])\n\n\treturn (\n\t\t<IsMobileContext.Provider value={mobileState}>\n\t\t\t<Toolbar toggleMobileSidebar={toggleMobileSidebar} />\n\t\t\t<Sidebar mobileSidebarOpen={mobileSidebarOpen} />\n\t\t\t<Paper mobileSidebarOpen={mobileSidebarOpen} />\n\t\t\t<GlobalStyle />\n\t\t</IsMobileContext.Provider>\n\t)\n}\n\nconst mapDispatchToProps = { requestUserData }\n\nexport default connect(\n\tnull,\n\tmapDispatchToProps\n)(App)\n","import React from 'react'\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport App from '../App/App'\n\nconst RootRouter = ({ user }) => (\n\t<Router>\n\t\t<Switch>\n\t\t\t<Route path=\"/:nameHash\" component={App} />\n\t\t\t{user.ownFiles.length ? <Redirect to={`/${user.ownFiles[0].nameHash}`} /> : <Route component={App} />}\n\t\t</Switch>\n\t</Router>\n)\n\nconst mapStateToProps = ({ user }) => ({ user })\n\nexport default connect(mapStateToProps)(RootRouter)\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { createStore, applyMiddleware, compose } from 'redux'\nimport { Provider } from 'react-redux'\nimport thunkMiddleware from 'redux-thunk'\nimport registerServiceWorker from './registerServiceWorker'\nimport rootReducer from './reducers'\n\nimport RootRouter from './components/RootRouter/RootRouter'\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\nconst store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunkMiddleware)))\n\nrender(\n\t<Provider store={store}>\n\t\t<RootRouter />\n\t</Provider>,\n\tdocument.getElementById('root')\n)\n\nregisterServiceWorker()\n"],"sourceRoot":""}